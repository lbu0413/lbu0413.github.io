<!doctype html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="/images/favicon.png" />

<title>[THM] OWASP Juice Shop&nbsp;|&nbsp;Wook&#39;s blog</title>
<meta
  name="title"
  content="[THM] OWASP Juice Shop"
/>
<meta
  name="description"
  content="We will look at OWASP&rsquo;s TOP 10 vulnerabilities in web applications. But for this, we will be looking at OWASP&rsquo;s own creation, Juice Shop.
Question #1: What&rsquo;s the Administrator&rsquo;s email address? admin@juice-sh.op Question #2: What parameter is used for searching? q When I typed asdfsdf on the search bar, I noticed that the URL changed to http://10.10.113.37/#/search?q=asdfsdf. we can see that the parameter is q.
Question #3: What show does Jim reference in his review?"
/>
<meta
  name="keywords"
  content="TryHackMe,"
/>

  <meta name="author" content="Wook Lee" />




<meta property="og:url" content="http://localhost:1313/thm-owasp-juice-shop/">
  <meta property="og:site_name" content="Wook&#39;s blog">
  <meta property="og:title" content="[THM] OWASP Juice Shop">
  <meta property="og:description" content="We will look at OWASP’s TOP 10 vulnerabilities in web applications. But for this, we will be looking at OWASP’s own creation, Juice Shop.
Question #1: What’s the Administrator’s email address? admin@juice-sh.op Question #2: What parameter is used for searching? q When I typed asdfsdf on the search bar, I noticed that the URL changed to http://10.10.113.37/#/search?q=asdfsdf. we can see that the parameter is q.
Question #3: What show does Jim reference in his review?">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-07-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-07-03T00:00:00+00:00">
    <meta property="article:tag" content="TryHackMe">





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[THM] OWASP Juice Shop">
  <meta name="twitter:description" content="We will look at OWASP’s TOP 10 vulnerabilities in web applications. But for this, we will be looking at OWASP’s own creation, Juice Shop.
Question #1: What’s the Administrator’s email address? admin@juice-sh.op Question #2: What parameter is used for searching? q When I typed asdfsdf on the search bar, I noticed that the URL changed to http://10.10.113.37/#/search?q=asdfsdf. we can see that the parameter is q.
Question #3: What show does Jim reference in his review?">





  <meta itemprop="name" content="[THM] OWASP Juice Shop">
  <meta itemprop="description" content="We will look at OWASP’s TOP 10 vulnerabilities in web applications. But for this, we will be looking at OWASP’s own creation, Juice Shop.
Question #1: What’s the Administrator’s email address? admin@juice-sh.op Question #2: What parameter is used for searching? q When I typed asdfsdf on the search bar, I noticed that the URL changed to http://10.10.113.37/#/search?q=asdfsdf. we can see that the parameter is q.
Question #3: What show does Jim reference in his review?">
  <meta itemprop="datePublished" content="2024-07-03T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-07-03T00:00:00+00:00">
  <meta itemprop="wordCount" content="488">
  <meta itemprop="keywords" content="TryHackMe">
<meta name="referrer" content="no-referrer-when-downgrade" />

    
    <link href="/simple.min.css" rel="stylesheet" />

    
    <link href="/style.min.css" rel="stylesheet" />

    

    
</head>

  <body>
    <header>
      <nav>
  <a
    href="/"
    
    >Home</a
  >

  <a
    href="/blog/"
    
    >Blog</a
  >

  <a
    href="/photos/"
    
    >Photos</a
  >


  <a href="/index.xml">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 448 512">
      
      <path
        d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"
      />
    </svg>
    RSS
  </a>

</nav>

<h1>[THM] OWASP Juice Shop</h1>


    </header>
    <main>
      
  
    
      
      <p>
        <i>
          <time datetime="2024-07-03" pubdate>
            2024-07-03
          </time>
        </i>
      </p>
    
  
  
  <content>
    <p>We will look at OWASP&rsquo;s TOP 10 vulnerabilities in web applications. But for this, we will be looking at OWASP&rsquo;s own creation, Juice Shop.</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="question-1-whats-the-administrators-email-address">Question #1: What&rsquo;s the Administrator&rsquo;s email address?</h4>






<pre tabindex="0"><code>admin@juice-sh.op</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="question-2-what-parameter-is-used-for-searching">Question #2: What parameter is used for searching?</h4>






<pre tabindex="0"><code>q</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<p>When I typed <code>asdfsdf</code> on the search bar, I noticed that the URL changed to <code>http://10.10.113.37/#/search?q=asdfsdf</code>. we can see that the parameter is <code>q</code>.</p>
<br>
<h4 id="question-3-what-show-does-jim-reference-in-his-review">Question #3: What show does Jim reference in his review?</h4>






<pre tabindex="0"><code>Star Trek</code></pre>
<p><img src="image-3.png#center" alt="alt text"></p>
<p>Jim did a review on the Green Smoothie product. We can see that he mentions a replicator. Replicator is a reference to a TV show called Star Trek.</p>
<br>
<h4 id="question-4-log-into-the-administrator-account">Question #4 Log into the administrator account!</h4>
<p><img src="image-4.png#center" alt="alt text">
On the login page, just type any credentials for Burpsuite to capture the request</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>POST /rest/user/login HTTP/1.1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Host: 10.10.113.37
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>User-Agent: Mozilla/5.0 <span style="color:#89dceb;font-weight:bold">(</span>X11; Linux aarch64; rv:109.0<span style="color:#89dceb;font-weight:bold">)</span> Gecko/20100101 Firefox/115.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Accept: application/json, text/plain, */*
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Accept-Language: en-US,en;<span style="color:#f5e0dc">q</span><span style="color:#89dceb;font-weight:bold">=</span>0.5
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Accept-Encoding: gzip, deflate, br
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Content-Type: application/json
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>Content-Length: <span style="color:#fab387">44</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Origin: http://10.10.113.37
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Connection: keep-alive
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Referer: http://10.10.113.37/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Cookie: <span style="color:#f5e0dc">io</span><span style="color:#89dceb;font-weight:bold">=</span>QdUYP1oidC2VzPTOAAAA; <span style="color:#f5e0dc">language</span><span style="color:#89dceb;font-weight:bold">=</span>en; <span style="color:#f5e0dc">cookieconsent_status</span><span style="color:#89dceb;font-weight:bold">=</span>dismiss
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">{</span><span style="color:#a6e3a1">&#34;email&#34;</span>:<span style="color:#a6e3a1">&#34;test@gmail.com&#34;</span>,<span style="color:#a6e3a1">&#34;password&#34;</span>:<span style="color:#a6e3a1">&#34;test&#34;</span><span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p>As you could see our request has been captured. Next, we are going to change the email value, <code>test@gmail.com</code> to <code>' or 1=1</code>. <code>{&quot;email&quot;:&quot;' or 1=1&quot;,&quot;password&quot;:&quot;test&quot;}</code></p>
<p>Here&rsquo;s how this works:</p>
<ol>
<li>The character <code>'</code> will close the brackets in the SQL query</li>
<li><code>OR</code> in a SQL statement will return true if either side of it is true. As 1=1 is always true, the whole statement becomes true. Thus it will tell the server that the email is valid, and log us into user id 0, which happens to be the administrator account.</li>
<li>The <code>--</code> character is used in SQL to comment out data, any restrictions on the login will no longer work as they are interpreted as a comment.</li>
</ol>
<p><img src="image-5.png#center" alt="alt text">
Send a request with the SQL injection code then you will be logged in as admin</p>
<br>
<h4 id="question-5-log-into-the-bender-account">Question 5: Log into the Bender account!</h4>






<pre tabindex="0"><code>fb364762a3c102b2db932069c0e6b78e738d4066</code></pre>
<p><img src="image-6.png#center" alt="alt text">
<img src="image-7.png#center" alt="alt text"></p>
<br>
<h4 id="question-6-bruteforce-the-administrator-accounts-password">Question 6: Bruteforce the Administrator account&rsquo;s password</h4>
<p>We have used SQL injection to log into the Administrator account but still do not know the password.
Once again capture a login request but this time send it to Intruder on Burpsuite.</p>
<p>Go to Positions and then select the <code>Clear § </code>. In the password field, place two <code>§</code> inside the quotes.
The <code>§§</code> is not two separate inputs but Burp&rsquo;s implementation of quotations.
<img src="image-8.png#center" alt="alt text">
<br></p>
<p>For the payload, we will be using the <code>best1050.txt from Seclists</code> for Bruteforce attack.
Seclists can be downloaded via <code>sudo apt-get install seclists</code>. Also, the list is located in <code>/usr/share/wordlists/SecLists/Passwords/Common-Credentials/best1050.txt</code>
<br></p>
<p><img src="image-9.png#center" alt="alt text"></p>
<p><img src="image-10.png#center" alt="alt text">
As we can see the status code is 200 for the payload, <code>admin123</code>
<br></p>
<p><img src="image-11.png#center" alt="alt text"></p>
<br>
<h4 id="question-7-reset-jims-password">Question 7: Reset Jim&rsquo;s Password</h4>
<p>When typed into the email field in the Forgot Password page, Jim&rsquo;s security question is set to <code>Your eldest siblings middle name?</code>
However, we already saw that Jim used a Star Trek reference with his review on a juice.</p>
<p><img src="image-12.png#center" alt="alt text"></p>
<br>
<p><img src="image-13.png#center#center" alt="alt text"></p>
<p>when googled &ldquo;Jim Star Trek&rdquo;, the fictional character&rsquo;s name is actually <code>James T. Kirk</code> and its eldest siblings middle name is <code>Samuel</code>
<img src="image-14.png#center#center" alt="alt text">
<img src="image-15.png#center" alt="alt text"></p>

  </content>
  
  <p>
    
    <a href="/blog/tryhackme/">#TryHackMe</a>&nbsp;&nbsp;
    
  </p>

    </main>
    <footer>
      

  <span>
    
    Made with
    <a href="https://github.com/maolonglong/hugo-simple/">Hugo ʕ•ᴥ•ʔ Simple</a>
  </span>


    </footer>

    
</body>
</html>
